find files that need black-squaring

```{r blacksquare-1}
library(tidyverse)
```

```{r blacksquare-2}
q_prop <- function(fname) {
  file <- readLines(fname)
  file %>% enframe() %>% 
    mutate(sol = str_detect(value, "Solution")) %>% 
    mutate(end_sol = str_detect(value, "blacksquare")) -> d
  list(sol = any(d$sol), end_sol = any(d$end_sol))
}
```

make list of all rmd for editing and select some

```{r blacksquare-3}
list.files(pattern = "*.Rmd") %>% enframe(name = NULL) %>% 
  rowwise() %>% 
  mutate(stat = list(q_prop(value))) %>% 
  unnest_wider(stat) %>% 
  filter(sol, !end_sol) %>% 
  slice_sample(n = 1000)
```


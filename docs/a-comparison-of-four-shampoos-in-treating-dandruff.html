<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 A comparison of four shampoos in treating dandruff | Problems and Solutions in Applied Statistics</title>
  <meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 A comparison of four shampoos in treating dandruff | Problems and Solutions in Applied Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://ritsokiguess.site/pasias" />
  
  <meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="github-repo" content="nxskok/pasias" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 A comparison of four shampoos in treating dandruff | Problems and Solutions in Applied Statistics" />
  
  <meta name="twitter:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  

<meta name="author" content="Ken Butler" />


<meta name="date" content="2021-05-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="learning-to-code.html"/>
<link rel="next" href="tidying-data.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Problems and Solutions in Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages-used-somewhere-in-this-book"><i class="fa fa-check"></i>Packages used somewhere in this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>1</b> Getting used to R and R Studio</a></li>
<li class="chapter" data-level="2" data-path="reading-in-data.html"><a href="reading-in-data.html"><i class="fa fa-check"></i><b>2</b> Reading in data</a></li>
<li class="chapter" data-level="3" data-path="drawing-graphs.html"><a href="drawing-graphs.html"><i class="fa fa-check"></i><b>3</b> Drawing graphs</a></li>
<li class="chapter" data-level="4" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>4</b> Data exploration</a></li>
<li class="chapter" data-level="5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>5</b> Working with dataframes</a></li>
<li class="chapter" data-level="6" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>6</b> One-sample inference</a></li>
<li class="chapter" data-level="7" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>7</b> Two-sample inference</a></li>
<li class="chapter" data-level="8" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>8</b> Power and sample size</a></li>
<li class="chapter" data-level="9" data-path="the-sign-test.html"><a href="the-sign-test.html"><i class="fa fa-check"></i><b>9</b> The sign test</a></li>
<li class="chapter" data-level="10" data-path="mood-median-test.html"><a href="mood-median-test.html"><i class="fa fa-check"></i><b>10</b> Mood median test</a></li>
<li class="chapter" data-level="11" data-path="matched-pairs-t-and-sign-test.html"><a href="matched-pairs-t-and-sign-test.html"><i class="fa fa-check"></i><b>11</b> Matched pairs t and sign test</a></li>
<li class="chapter" data-level="12" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html"><i class="fa fa-check"></i><b>12</b> Normal quantile plots</a>
<ul>
<li class="chapter" data-level="12.1" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><i class="fa fa-check"></i><b>12.1</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.2" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality"><i class="fa fa-check"></i><b>12.2</b> Ferritin and normality</a></li>
<li class="chapter" data-level="12.3" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers-1"><i class="fa fa-check"></i><b>12.3</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.4" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality-1"><i class="fa fa-check"></i><b>12.4</b> Ferritin and normality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>13</b> Analysis of variance</a></li>
<li class="chapter" data-level="14" data-path="writing-reports.html"><a href="writing-reports.html"><i class="fa fa-check"></i><b>14</b> Writing reports</a></li>
<li class="chapter" data-level="15" data-path="learning-to-code.html"><a href="learning-to-code.html"><i class="fa fa-check"></i><b>15</b> Learning to code</a>
<ul>
<li class="chapter" data-level="15.1" data-path="learning-to-code.html"><a href="learning-to-code.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="learning-to-code.html"><a href="learning-to-code.html#data-and-pre-processing"><i class="fa fa-check"></i><b>15.2</b> Data and pre-processing</a></li>
<li class="chapter" data-level="15.3" data-path="learning-to-code.html"><a href="learning-to-code.html#analysis"><i class="fa fa-check"></i><b>15.3</b> Analysis</a></li>
<li class="chapter" data-level="15.4" data-path="learning-to-code.html"><a href="learning-to-code.html#conclusions-see-note-9"><i class="fa fa-check"></i><b>15.4</b> Conclusions (see note 9)</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-comparison-of-four-shampoos-in-treating-dandruff.html"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html"><i class="fa fa-check"></i><b>16</b> A comparison of four shampoos in treating dandruff</a>
<ul>
<li class="chapter" data-level="16.1" data-path="a-comparison-of-four-shampoos-in-treating-dandruff.html"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#introduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="a-comparison-of-four-shampoos-in-treating-dandruff.html"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#exploratory-analysis"><i class="fa fa-check"></i><b>16.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="16.3" data-path="a-comparison-of-four-shampoos-in-treating-dandruff.html"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#analysis-of-variance-1"><i class="fa fa-check"></i><b>16.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="16.4" data-path="a-comparison-of-four-shampoos-in-treating-dandruff.html"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#assessment-of-assumptions"><i class="fa fa-check"></i><b>16.4</b> Assessment of Assumptions</a></li>
<li class="chapter" data-level="16.5" data-path="a-comparison-of-four-shampoos-in-treating-dandruff.html"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#conclusions"><i class="fa fa-check"></i><b>16.5</b> Conclusions</a></li>
<li class="chapter" data-level="16.6" data-path="a-comparison-of-four-shampoos-in-treating-dandruff.html"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#end"><i class="fa fa-check"></i><b>16.6</b> End</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>17</b> Tidying data</a></li>
<li class="chapter" data-level="18" data-path="simple-regression.html"><a href="simple-regression.html"><i class="fa fa-check"></i><b>18</b> Simple regression</a></li>
<li class="chapter" data-level="19" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>19</b> Multiple regression</a></li>
<li class="chapter" data-level="20" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html"><i class="fa fa-check"></i><b>20</b> Regression with categorical variables</a>
<ul>
<li class="chapter" data-level="20.1" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited"><i class="fa fa-check"></i><b>20.1</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.2" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching"><i class="fa fa-check"></i><b>20.2</b> Pulse rates and marching</a></li>
<li class="chapter" data-level="20.3" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited-1"><i class="fa fa-check"></i><b>20.3</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.4" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching-1"><i class="fa fa-check"></i><b>20.4</b> Pulse rates and marching</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>21</b> Dates and times</a></li>
<li class="chapter" data-level="22" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>22</b> Functions</a></li>
<li class="chapter" data-level="23" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html"><i class="fa fa-check"></i><b>23</b> Vector and matrix algebra</a>
<ul>
<li class="chapter" data-level="23.1" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again"><i class="fa fa-check"></i><b>23.1</b> Heights and foot lengths again</a></li>
<li class="chapter" data-level="23.2" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again-1"><i class="fa fa-check"></i><b>23.2</b> Heights and foot lengths again</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>24</b> The Bootstrap</a></li>
<li class="chapter" data-level="25" data-path="bayesian-statistics-with-stan.html"><a href="bayesian-statistics-with-stan.html"><i class="fa fa-check"></i><b>25</b> Bayesian Statistics with Stan</a></li>
<li class="chapter" data-level="26" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>26</b> Logistic regression</a></li>
<li class="chapter" data-level="27" data-path="logistic-regression-with-ordinal-response.html"><a href="logistic-regression-with-ordinal-response.html"><i class="fa fa-check"></i><b>27</b> Logistic regression with ordinal response</a></li>
<li class="chapter" data-level="28" data-path="logistic-regression-with-nominal-response.html"><a href="logistic-regression-with-nominal-response.html"><i class="fa fa-check"></i><b>28</b> Logistic regression with nominal response</a></li>
<li class="chapter" data-level="29" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>29</b> Survival analysis</a></li>
<li class="chapter" data-level="30" data-path="analysis-of-variance-revisited.html"><a href="analysis-of-variance-revisited.html"><i class="fa fa-check"></i><b>30</b> Analysis of variance revisited</a></li>
<li class="chapter" data-level="31" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>31</b> Analysis of covariance</a></li>
<li class="chapter" data-level="32" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>32</b> Multivariate analysis of variance</a></li>
<li class="chapter" data-level="33" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i><b>33</b> Repeated measures</a></li>
<li class="chapter" data-level="34" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>34</b> Discriminant analysis</a></li>
<li class="chapter" data-level="35" data-path="hierarchical-cluster-analysis.html"><a href="hierarchical-cluster-analysis.html"><i class="fa fa-check"></i><b>35</b> Hierarchical cluster analysis</a></li>
<li class="chapter" data-level="36" data-path="k-means-cluster-analysis.html"><a href="k-means-cluster-analysis.html"><i class="fa fa-check"></i><b>36</b> K-means cluster analysis</a></li>
<li class="chapter" data-level="37" data-path="drawing-maps-with-leaflet.html"><a href="drawing-maps-with-leaflet.html"><i class="fa fa-check"></i><b>37</b> Drawing maps with Leaflet</a></li>
<li class="chapter" data-level="38" data-path="multidimensional-scaling.html"><a href="multidimensional-scaling.html"><i class="fa fa-check"></i><b>38</b> Multidimensional Scaling</a></li>
<li class="chapter" data-level="39" data-path="principal-components.html"><a href="principal-components.html"><i class="fa fa-check"></i><b>39</b> Principal Components</a>
<ul>
<li class="chapter" data-level="39.1" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere"><i class="fa fa-check"></i><b>39.1</b> The weather, somewhere</a></li>
<li class="chapter" data-level="39.2" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere-1"><i class="fa fa-check"></i><b>39.2</b> The weather, somewhere</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>40</b> Factor Analysis</a></li>
<li class="chapter" data-level="41" data-path="frequency-table-analysis.html"><a href="frequency-table-analysis.html"><i class="fa fa-check"></i><b>41</b> Frequency table analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Problems and Solutions in Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-comparison-of-four-shampoos-in-treating-dandruff" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> A comparison of four shampoos in treating dandruff</h1>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb39-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div id="introduction-2" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Introduction</h2>
<p>Shampoos are often claimed to be effective at treating dandruff. In a study, the dandruff-treating properties of four shampoos were compared. These four shampoos were, as referred to in the dataset:</p>
<ul>
<li><code>PyrI</code>: 1% pyrithione zinc shampoo</li>
<li><code>PyrII</code>: as <code>PyrI</code> but with instructions to shampoo two times at each wash.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></li>
<li><code>Keto</code>: 2% ketoconazole shampoo</li>
<li><code>Placebo</code>: a placebo shampoo</li>
</ul>
<p>Each of the experimental subjects was randomly given one of the shampoos. After using their shampoo for six weeks, eight sections of the subject’s scalp were examined for each subject. Each section of the scalp was given a score that measured the amount of flaking on a scale of 0-10. The response variable, called <code>Flaking</code>, was the sum of these eight scores, and is a whole number for each subject. A smaller value of <code>Flaking</code> indicates less dandruff.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p>Our aim is to see which shampoo or shampoos are most effective at treating dandruff, that is, have the smallest value of <code>Flaking</code> on average.</p>
</div>
<div id="exploratory-analysis" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Exploratory analysis</h2>
<p>We begin by reading in the data:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb40-1"></a>my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/dandruff.txt&quot;</span></span>
<span id="cb40-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb40-2"></a>dandruff &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(my_url)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   OBS = col_double(),
##   Treatment = col_character(),
##   GroupNum = col_double(),
##   Flaking = col_double()
## )</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb42-1"></a>dandruff</span></code></pre></div>
<p>355 subjects took part in the study altogether. The shampoo used is indicated in the <code>Treatment</code> column. The remaining columns <code>OBS</code> and <code>GroupNum</code> will not be used in this analysis.</p>
<p>Numerical summaries of the data are as shown:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb43-1"></a>dandruff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Treatment) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb43-2"></a><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">fl_mean=</span><span class="kw">mean</span>(Flaking), <span class="dt">fl_sd=</span><span class="kw">sd</span>(Flaking))</span></code></pre></div>
<p>There are approximately 100 observations in each group, apart from the Placebo group, which had only 28. The mean number of flakes is much higher for the Placebo group than for the others, which seem similar. The group standard deviations are fairly similar.</p>
<p>With a categorical <code>Treatment</code> and a quantitative <code>Flakes</code>, a suitable graph is a side-by-side boxplot:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb44-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() </span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-48-1.png" width="672" />
Once again, we see that the flaking for the Placebo shampoo is much higher than for the others. There are outliers in the <code>PyrI</code> group, but given that the data values are all whole numbers, they are not far different from the rest of the data. Considering these outliers, the spreads of the groups all look fairly similar and the distributions appear more or less symmetric.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
</div>
<div id="analysis-of-variance-1" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Analysis of Variance</h2>
<p>For comparing four groups, we need some kind of analysis of variance. Having seen that the <code>Flaking</code> values within the four groups are more or less normal with more or less equal spreads, we run a standard ANOVA:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb45-1"></a>dandruff<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">aov</span>(Flaking<span class="op">~</span>Treatment, <span class="dt">data=</span>dandruff)</span>
<span id="cb45-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb45-2"></a><span class="kw">summary</span>(dandruff<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Treatment     3   4151  1383.8   967.8 &lt;2e-16 ***
## Residuals   351    502     1.4                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>With an extremely small P-value, we conclude that the four shampoos do not all have the same mean value of <code>Flaking</code>.</p>
<p>To find out which ones are different from which, we use Tukey’s method:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb47-1"></a><span class="kw">TukeyHSD</span>(dandruff<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Flaking ~ Treatment, data = dandruff)
## 
## $Treatment
##                      diff         lwr         upr     p adj
## Placebo-Keto   13.3645553  12.7086918  14.0204187 0.0000000
## PyrI-Keto       1.3645553   0.9462828   1.7828278 0.0000000
## PyrII-Keto      1.1735330   0.7524710   1.5945950 0.0000000
## PyrI-Placebo  -12.0000000 -12.6521823 -11.3478177 0.0000000
## PyrII-Placebo -12.1910223 -12.8449971 -11.5370475 0.0000000
## PyrII-PyrI     -0.1910223  -0.6063270   0.2242825 0.6352706</code></pre>
<p>All of the shampoo treatments are significantly different from each other except for the two pyrithione ones. To see which shampoos are best and worst, we remind ourselves of the treatment means:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb49-1"></a>dandruff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Treatment) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb49-2"></a><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">fl_mean=</span><span class="kw">mean</span>(Flaking), <span class="dt">fl_sd=</span><span class="kw">sd</span>(Flaking))</span></code></pre></div>
<p>The placebo shampoo has significantly more flaking than all the others, and the ketoconazole<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> shampoo has significantly less flaking than all the others. From this analysis, therefore, we would recommend the ketoconazole shampoo over all the others.</p>
</div>
<div id="assessment-of-assumptions" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Assessment of Assumptions</h2>
<p>The analysis of variance done above requires that the observations within each treatment group (shampoo) be approximately normally distributed, given the sample sizes, with approximately equal spreads. To assess this, we look at normal quantile plots<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> for each shampoo:<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb50-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">sample=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></span>
<span id="cb50-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb50-2"></a><span class="kw">facet_wrap</span>(<span class="op">~</span>Treatment, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>Given that the data are whole numbers, the distributions each appear close to the lines, indicating that the distributions are close to normal in shape.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> The distribution of the <code>PyrI</code> values is slightly long-tailed, but with over 100 observations in that group, this shape is not enough to invalidate the normality assumption.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<p>Having concluded that the normality is sufficient, we need to assess the equality of spreads. Referring back to our summary table:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb51-1"></a>dandruff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Treatment) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb51-2"></a><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">fl_mean=</span><span class="kw">mean</span>(Flaking), <span class="dt">fl_sd=</span><span class="kw">sd</span>(Flaking))</span></code></pre></div>
<p>we note that the spreads are not greatly different, and so the equal-spread assumption appears to be satisfied.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
<p>In summary, the assumptions for the analysis of variance we did seem to be reasonably well satisfied, and we can have some confidence in our conclusions.</p>
</div>
<div id="conclusions" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Conclusions</h2>
<p>We found that the ketoconazole shampoo produced the smallest mean flaking, and its mean was significantly smaller than that of all the other shampoos. This shampoo can be recommended over the others. There was no significant difference between the two pyrithione treatments; shampooing twice had no benefit over shampooing once.</p>
<p>The difference in means between the ketoconazole and the two pyrithione shampoos was only about 1.2. This difference was significant because of the large sample sizes, but it is a separate question as to whether a difference of this size is of practical importance. If it is not, any of the shampoos except for the placebo can be recommended.</p>
</div>
<div id="end" class="section level2" number="16.6">
<h2><span class="header-section-number">16.6</span> End</h2>
<p>That is the end of my report. You, of course, don’t need the word “end” or any of the footnotes I had. These were to draw your attention to other things that don’t necessarily belong in the report, but I would like you to be aware of them. When you reach the end of your report, you can just stop.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
<p>Some extra, bigger, thoughts (there are quite a few of these. I hope I don’t repeat things I also say in the “sidenotes”):</p>
<p>Extra 1: The placebo group is much smaller than the others, but all the groups are pretty big by ANOVA standards. Apparently what happened is that originally the three “real” treatments had 112 subjects each, but the placebo had 28 (ie., a quarter of the subjects that the other groups had), and a few subjects dropped out. There’s no problem, in one-way ANOVAs of this kind, with having groups of unequal sizes; the <span class="math inline">\(F\)</span>-test is fine, and as long as you use a suitable extension of Tukey that deals with unequal sample sizes, you are OK there too. <code>TukeyHSD</code>, according to the help file, “incorporates an adjustment for sample size that produces sensible intervals for mildly unbalanced designs”. In this case, we might be holding our breath a bit, depending on what “mildly unbalanced” actually means. Usually in this kind of study, you have the groups about the same size, because proving that the smallest group differs from any of the others is more difficult. I guess these researchers were pretty confident that the placebo shampoo would be clearly worse than the others! (Additional: <code>TukeyHSD</code> uses the so-called Tukey-Kramer test when sample sizes within groups are unequal. My understanding is that this is good no matter what the sample sizes are.)</p>
<p>Extra 2: The mean for <code>Placebo</code> is quite a lot bigger than for the other groups, so a plot with different scales for each facet is best.
Otherwise you get this kind of thing, which is much harder to read:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb52-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">sample=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></span>
<span id="cb52-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb52-2"></a><span class="kw">facet_wrap</span>(<span class="op">~</span>Treatment)</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>The points fill less than half their facets, which makes the plots harder to understand. This also makes it look as if the distributions are more normal, because the vertical scale has been compressed. Having a better basis for assessing the normality is a good idea, given that the purpose of the plot <em>is</em> assessing the normality! Hence, using <code>scales = "free"</code> is best.</p>
<p>Extra 3: You might have been wondering why the boxplots, which are the usual thing in these circumstances, look worse than the normal quantile plots.</p>
<p>Let’s revisit them and see what happened:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb53-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() </span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>The <code>Placebo</code> group has the largest IQR, and the <code>PyrI</code> group appears to have two outliers. We need to bear in mind, though, that the data values are whole numbers and there might be repeats; also, what looks like an outlier here might not look quite so much like one when we see all the data.</p>
<p>What you can do is to add a <code>geom_point</code> on to the plot to plot the observations as points:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb54-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>Flaking)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb54-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb54-2"></a><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>But there are a lot more data points than this! What happened is that a point at, say, 20 is <em>all</em> the observations in that group that were 20, of which there might be a lot,
but we cannot see how many, because they are printed on top of each other. To see all the observations, we can <strong>jitter</strong> them: that is, plot them all <em>not</em> in the same place. In this case, we have the whole width of the boxplot boxes to use; we could also jitter vertically, but I decided not to do that here. There is a <code>geom_jitter</code> that does exactly this:<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb55-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb55-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb55-2"></a><span class="kw">geom_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>The plot is rather messy,<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> but now you see everything. The <code>height=0</code> means not to do any vertical jittering: just spread the points left and right.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> Where the points are exactly on the <span class="math inline">\(x\)</span>-scale is now irrelevant; this is just a device to spread the points out so that you can see them all.</p>
<p>I left the vertical alone so that you can still see the actual data values. Even though the highest and lowest values in <code>PyrI</code> were shown as outliers on the original boxplot, you can see that they are really not. When the data values are discrete (separated) like this, an apparent outlier may be only one bigger or smaller than the next value, and thus not really an outlier at all.</p>
<p>To try the vertical jittering too, use the defaults on <code>geom_jitter</code>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb56-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">x=</span>Treatment, <span class="dt">y=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>()</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>This maybe spreads the points out better, so you can be more certain that you’re seeing them all, but you lose the clear picture of the data values being whole numbers.</p>
<p>When Tukey popularized the boxplot, his idea was that it would be drawn by hand with relatively small samples, and when you draw boxplots for large samples, you can get an apparently large number of outliers, that are not in retrospect quite as extreme as they may look at first. This may also have happened here. Tukey, however, did not invent the boxplot; credit for that goes to <a href="https://en.wikipedia.org/wiki/Mary_Eleanor_Spear">Mary Eleanor Spear</a> with her “range plot.”<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a></p>
<p>Extra 4: More discussion of normality. The assumptions for a standard ANOVA (that is to say, not a Welch ANOVA) are normally-distributed data within each treatment group, with equal spreads. What that means in practice is that you want normal <em>enough</em> data given the sample sizes, and approximately equal spreads. My normal quantile plots are a long way back, so let’s get them again:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb57-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">sample=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></span>
<span id="cb57-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb57-2"></a><span class="kw">facet_wrap</span>(<span class="op">~</span>Treatment, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>The data values are all whole numbers, so we get those horizontal stripes of <code>Flaking</code> values that are all the same. As long as these more or less hug the line, we are all right. The <code>PyrII</code> values certainly do. In my top row, <code>Keto</code> and <code>Placebo</code> are not quite so good, but they have <em>short</em> tails compared to the normal, so there will be no problem using the means for these groups, as ANOVA does. The only one that is problematic at all is <code>PyrI</code>. That has slightly long tails compared to a normal. (You could, I suppose, call those highest and lowest values “outliers”, but I don’t think they are far enough away from the rest of the data to justify that.) Are these long tails a problem? That depends on how many observations we have:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb58-1"></a>dandruff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Treatment) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb58-2"></a><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">mean_flaking=</span><span class="kw">mean</span>(Flaking), <span class="dt">sd_flaking=</span><span class="kw">sd</span>(Flaking))</span></code></pre></div>
<p>There are 112 of them. Easily enough to overcome those long tails. So, to my mind, normality is no problem.</p>
<p>Aside: you might be wondering whether you can make nicer-looking tables in your reports. There are several ways. The <code>gt</code> package is the <a href="https://gt.rstudio.com/">most comprehensive</a> one I know, and has links to a large number of others (at the bottom of its webpage). The simplest one I know of is <code>kable</code> in the <code>knitr</code> package. You may well have that package already installed, but you’ll need to load it, preferably at the beginning of your report:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb59-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb59-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb59-2"></a>dandruff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Treatment) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb59-3"></a><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">mean_flaking=</span><span class="kw">mean</span>(Flaking), <span class="dt">sd_flaking=</span><span class="kw">sd</span>(Flaking)) -&gt;<span class="st"> </span>summary</span>
<span id="cb59-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb59-4"></a><span class="kw">kable</span>(summary)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Treatment</th>
<th align="right">n</th>
<th align="right">mean_flaking</th>
<th align="right">sd_flaking</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Keto</td>
<td align="right">106</td>
<td align="right">16.02830</td>
<td align="right">0.9305149</td>
</tr>
<tr class="even">
<td align="left">Placebo</td>
<td align="right">28</td>
<td align="right">29.39286</td>
<td align="right">1.5948827</td>
</tr>
<tr class="odd">
<td align="left">PyrI</td>
<td align="right">112</td>
<td align="right">17.39286</td>
<td align="right">1.1418110</td>
</tr>
<tr class="even">
<td align="left">PyrII</td>
<td align="right">109</td>
<td align="right">17.20183</td>
<td align="right">1.3524999</td>
</tr>
</tbody>
</table>
<p>End of aside.</p>
<p>Before I got distracted, we were talking about whether the distribution of PyrI was normal enough, given the sample size.
Another way of thinking about this is to look at the bootstrapped sampling distribution of the sample mean for this group. I set the random number seed so that the results will be the same even if I run this again:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb60-1"></a><span class="kw">set.seed</span>(<span class="dv">457299</span>)</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb61-1"></a>dandruff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Treatment <span class="op">==</span><span class="st"> &quot;PyrI&quot;</span>) -&gt;<span class="st"> </span>pyri</span>
<span id="cb61-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb61-2"></a><span class="kw">tibble</span>(<span class="dt">sim =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb61-3"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb61-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_sample =</span> <span class="kw">list</span>(<span class="kw">sample</span>(pyri<span class="op">$</span>Flaking, <span class="dt">replace =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb61-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_mean =</span> <span class="kw">mean</span>(my_sample)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb61-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> my_mean)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>()</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>Oh yes, no problem with the normality there. (The discreteness of the population implies that each sample mean is some number of one-hundred-and-twelfths, so that the sampling distribution is also discrete, just less discrete than the data distribution. This is the reason for the little stair-steps in the plot.) In addition, the fact that the least normal distribution is normal enough means that the other distributions must also be OK. If you wanted to be careful, you would assess the smallest Placebo group as well, though that if anything is short-tailed and so would not be a problem anyway.</p>
<p>The other question is whether those spreads are equal enough. The easiest way is to look back at your summary table (that I reproduced above), cast your eye down the SD column, and make a call about whether they are equal enough. The large sample sizes <em>don’t</em> help here, although see the end of the question for more discussion. I would call these “not grossly unequal” and call standard ANOVA good, but you are also entitled to call them different enough, and then you need to say that in your opinion we should have done a Welch ANOVA. Or, if you got your normal quantile plots before you did your ANOVA, you could actually <em>do</em> a Welch ANOVA.</p>
<p>I am not a fan of doing one test to see whether you can do another test,<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> but if you really want to, you can use something like Levene’s test to test the null hypothesis that all the groups have the same variance.<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> Levene’s test lives in the package <code>car</code> that you might have to install first:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb62-1"></a><span class="kw">library</span>(car)</span>
<span id="cb62-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb62-2"></a><span class="kw">leveneTest</span>(Flaking<span class="op">~</span>Treatment, <span class="dt">data =</span> dandruff)</span></code></pre></div>
<pre><code>## Warning in leveneTest.default(y = y, group = group, ...): group coerced to factor.</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value    Pr(&gt;F)    
## group   3  6.2001 0.0004096 ***
##       351                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Equal variances are resoundingly <em>rejected</em> here; the samples here have variances that are less equal than they would be if the populations all had the same variances. But that is really asking the wrong question: the one that matters is “does the inequality of variances that we saw here <em>matter</em> when it comes to doing the ANOVA?”. With samples as big as we had, the variances could be declared unequal even if they were actually quite similar. This is another (different) angle on statistical significance (rather similar variances can be significantly different with large samples) vs. practical importance (does the fact that our sample variances are as different as they are matter to the ANOVA?). I do the Welch ANOVA in Extra 6, and you will see there whether it comes out much different than the regular ANOVA. See also Extra 7.</p>
<p>If your normal quantile plots looked like this:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb65-1"></a><span class="kw">ggplot</span>(dandruff, <span class="kw">aes</span>(<span class="dt">sample=</span>Flaking)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></span>
<span id="cb65-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb65-2"></a><span class="kw">facet_wrap</span>(<span class="op">~</span>Treatment)</span></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>with the <em>same</em> scales, you can use the slopes of the lines to judge equal spreads: either equal enough, or the <code>Placebo</code> line is a bit steeper than the others. If you did <code>scales = "free"</code>, you <em>cannot</em> do this, because you have essentially standardized your data before making the normal quantile plots.</p>
<p>It is <em>hugely</em> important to distinguish the null hypothesis (all the means are the same) from the assumptions behind the test (how you know that the P-value obtained from testing your null hypothesis can be trusted). These are separate things, and getting them straight is a vital part of being a good statistician. You might say that this is part of somebody else knowing how they, as someone hiring a statistician, can trust <em>you</em>.</p>
<p>Extra 5: Several ways to say what you conclude from the ANOVA:</p>
<ul>
<li>The null hypothesis, which says that all the shampoos have the same mean amount of flaking, is rejected. (Or say it in two sentences: what the null hypothesis is, and then what you’re doing with it.)</li>
<li>Not all the shampoos have the same mean amount of flaking.</li>
<li>There are shampoos that differ in mean amount of flaking.</li>
</ul>
<p>Some wrong or incomplete ways to say it:</p>
<ul>
<li>We reject the null hypothesis. (Meaning what, about the data?)</li>
<li>we reject the null hypothesis that the means are different. (You have confused the null with the conclusion, and come out with something that is backwards.)</li>
<li>the mean flaking for the treatments is different (this says that they are <em>all</em> different, but you don’t know that yet.)</li>
</ul>
<p>Extra 6: You might have been wondering how Welch’s ANOVA would have played out, given that the placebo group measurements looked more variable than the others. Wonder no more:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb66-1"></a><span class="kw">oneway.test</span>(Flaking<span class="op">~</span>Treatment, <span class="dt">data=</span>dandruff)</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means (not assuming equal variances)
## 
## data:  Flaking and Treatment
## F = 595.03, num df = 3.00, denom df = 105.91, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb68-1"></a><span class="kw">gamesHowellTest</span>(Flaking<span class="op">~</span><span class="kw">factor</span>(Treatment), <span class="dt">data=</span>dandruff)</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using Games-Howell test</code></pre>
<pre><code>## data: Flaking by factor(Treatment)</code></pre>
<pre><code>##         Keto    Placebo PyrI
## Placebo 9.2e-14 -       -   
## PyrI    8.7e-14 &lt; 2e-16 -   
## PyrII   2.1e-11 &lt; 2e-16 0.67</code></pre>
<pre><code>## 
## P value adjustment method: none</code></pre>
<pre><code>## alternative hypothesis: two.sided</code></pre>
<p>The results are almost exactly the same: the conclusions are identical, and the P-values are even pretty much the same. The place where it would make a difference is when you are close to the boundary between rejecting and not. Here, our Tukey and Games-Howell P-values were all either close to 0 or about 0.6, whichever way we did it. So it didn’t matter which one we did; you could justify using either. The regular ANOVA might have been a better choice for your report, though, because this is something your audience could reasonably be expected to have heard of. The Welch ANOVA deserves to be as well-used as the Welch two-sample <span class="math inline">\(t\)</span>-test, but it doesn’t often appear in Statistics courses. (This course is an exception, of course!)</p>
<p>Extra 7: the general principle when you are not sure of the choice between two tests is to run them both. If the conclusions agree, as they do here, then it doesn’t matter which one you run. If they disagree, then it matters, and you need to think more carefully about which test is the more appropriate one. (Usually, this is the test with the fewer assumptions, but not always.)</p>
<p>Another way to go is to do a simulation (of the ordinary ANOVA). Generate some data that are like what you actually have, and then in your simulation see whether your <span class="math inline">\(\alpha\)</span> is near to 0.05. Since we are talking about <span class="math inline">\(\alpha\)</span> here, the simulated data needs to have the same <em>mean</em> in every group, so that the null hypothesis is true, but SDs and sample sizes like the ones in the data (and of a normal shape). Let me build up the process. Let’s start by making a dataframe that contains the sample sizes, means and SDs for the data we want to generate. The treatment names don’t matter:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-1"></a>sim_from &lt;-<span class="st"> </span><span class="kw">tribble</span>(</span>
<span id="cb74-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-2"></a><span class="op">~</span>trt, <span class="op">~</span>n, <span class="op">~</span>mean, <span class="op">~</span>sd,</span>
<span id="cb74-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-3"></a><span class="st">&quot;A&quot;</span>, <span class="dv">106</span>, <span class="dv">0</span>, <span class="fl">0.93</span>,</span>
<span id="cb74-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-4"></a><span class="st">&quot;B&quot;</span>, <span class="dv">28</span>, <span class="dv">0</span>, <span class="fl">1.59</span>,</span>
<span id="cb74-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-5"></a><span class="st">&quot;C&quot;</span>, <span class="dv">112</span>, <span class="dv">0</span>, <span class="fl">1.14</span>,</span>
<span id="cb74-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-6"></a><span class="st">&quot;D&quot;</span>, <span class="dv">109</span>, <span class="dv">0</span>, <span class="fl">1.35</span></span>
<span id="cb74-7"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-7"></a>)</span>
<span id="cb74-8"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb74-8"></a>sim_from</span></code></pre></div>
<p>Starting from here, we want to set up drawing a lot of random samples from a normal distribution with the mean and SD shown, and the sample size shown. The way I like to do it<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> is to set up a list-column called <code>sim</code> that will index the simulations. I’m going to pretend I’m doing just three simulations, while I get my head around this, and then up it later after I have things working:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb75-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb75-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</span></code></pre></div>
<p>Then I <code>unnest</code> <code>sim</code> so that I have a place to draw each sample:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb76-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb76-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb76-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim)</span></code></pre></div>
<p>Now, working rowwise, I can draw a random sample from each normal distribution. The inputs to <code>rnorm</code> are the sample size, the mean, and the SD, in that order.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb77-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb77-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb77-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb77-4"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb77-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">list</span>(<span class="kw">rnorm</span>(n, mean, sd)))</span></code></pre></div>
<p>This is looking similar in procedure to a bootstrap sampling distribution. If we were doing <em>that</em>, we would now make a new column containing something like the mean of each of those samples (and then make a picture of what we had). But this is different: we want to combine all of the random samples for each of the four treatments for one of the simulations, run an ANOVA on it, and get hold of the P-value. So we need to <code>unnest</code> those samples, and then combine them together properly. That goes something like this:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb78-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb78-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb78-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb78-4"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb78-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">list</span>(<span class="kw">rnorm</span>(n, mean, sd))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb78-6"></a><span class="st">  </span><span class="kw">unnest</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-7"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb78-7"></a><span class="st">  </span><span class="kw">nest_by</span>(sim)</span></code></pre></div>
<p>What this has done is to create three mini-dataframes in the list-column <code>data</code> that have our generated random <code>y</code> and a column called <code>treatment</code>. What we want to do is to run the ordinary ANOVA on each of those dataframes in <code>data</code>, and, in a minute, get hold of the P-value. I think I need another <code>rowwise</code> first, because I want to work with the rows of the <em>new</em> dataframe:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-4"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">list</span>(<span class="kw">rnorm</span>(n, mean, sd))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-6"></a><span class="st">  </span><span class="kw">unnest</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-7"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-7"></a><span class="st">  </span><span class="kw">nest_by</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-8"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-8"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-9"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb79-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_anova =</span> <span class="kw">list</span>(<span class="kw">aov</span>(y <span class="op">~</span><span class="st"> </span>trt, <span class="dt">data =</span> data)))</span></code></pre></div>
<p>I know the P-value is in there somewhere, but I can’t remember how to get hold of it. The easiest way is to load <code>broom</code> and pass the models into <code>tidy</code>, then take a look at that:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb80-1"></a><span class="kw">library</span>(broom)</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-4"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">list</span>(<span class="kw">rnorm</span>(n, mean, sd))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-6"></a><span class="st">  </span><span class="kw">unnest</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-7"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-7"></a><span class="st">  </span><span class="kw">nest_by</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-8"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-8"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-9"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_anova =</span> <span class="kw">list</span>(<span class="kw">aov</span>(y <span class="op">~</span><span class="st"> </span>trt, <span class="dt">data =</span> data))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-10"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_tidy =</span> <span class="kw">list</span>(<span class="kw">tidy</span>(my_anova))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-11"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb81-11"></a><span class="st">  </span><span class="kw">unnest</span>(my_tidy)</span></code></pre></div>
<p>Almost there. The rows that have P-values in them are the ones that have <code>trt</code> (the explanatory variable) in the <code>term</code>, so:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-4"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">list</span>(<span class="kw">rnorm</span>(n, mean, sd))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-6"></a><span class="st">  </span><span class="kw">unnest</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-7"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-7"></a><span class="st">  </span><span class="kw">nest_by</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-8"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-8"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-9"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_anova =</span> <span class="kw">list</span>(<span class="kw">aov</span>(y <span class="op">~</span><span class="st"> </span>trt, <span class="dt">data =</span> data))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-10"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_tidy =</span> <span class="kw">list</span>(<span class="kw">tidy</span>(my_anova))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-11"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-11"></a><span class="st">  </span><span class="kw">unnest</span>(my_tidy) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-12"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-12"></a><span class="st">  </span><span class="kw">filter</span>(term <span class="op">==</span><span class="st"> &quot;trt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-13"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb82-13"></a><span class="st">  </span><span class="kw">select</span>(sim, p.value)</span></code></pre></div>
<p>Three simulated samples, each time one from each of the four treatments, and three P-values. So this works, and the remaining thing is to change the number of simulations from 3 to 1000 and run it again, saving the result:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-4"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">list</span>(<span class="kw">rnorm</span>(n, mean, sd))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-6"></a><span class="st">  </span><span class="kw">unnest</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-7"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-7"></a><span class="st">  </span><span class="kw">nest_by</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-8"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-8"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-9"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_anova =</span> <span class="kw">list</span>(<span class="kw">aov</span>(y <span class="op">~</span><span class="st"> </span>trt, <span class="dt">data =</span> data))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-10"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_tidy =</span> <span class="kw">list</span>(<span class="kw">tidy</span>(my_anova))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-11"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-11"></a><span class="st">  </span><span class="kw">unnest</span>(my_tidy) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-12"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-12"></a><span class="st">  </span><span class="kw">filter</span>(term <span class="op">==</span><span class="st"> &quot;trt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-13"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-13"></a><span class="st">  </span><span class="kw">select</span>(sim, p.value) -&gt;<span class="st"> </span>sim_pval</span>
<span id="cb83-14"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb83-14"></a>sim_pval</span></code></pre></div>
<p>Now, the reason we were doing this was to see whether regular ANOVA worked properly on data from populations with different SDs. We know that the null hypothesis is true here (because all the true treatment means were equal to 0), so the probability of making a type I error by rejecting the null (that all the means are the same) should be 0.05. How close is it?</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb84-1"></a>sim_pval <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb84-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb84-2"></a><span class="st">  </span><span class="kw">count</span>(p.value <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>)</span></code></pre></div>
<p><span class="math inline">\(91/1000 = 0.091\)</span>. We are <em>too likely</em> to falsely reject the null. The regular ANOVA does not behave properly for data like ours.</p>
<p>That looks rather high. Is the proportion of times I am rejecting significantly different from 0.05? Testing null hypotheses about (single) proportions is done using <code>prop.test</code>. This uses the normal approximation to the binomial, with continuity correction:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb85-1"></a><span class="kw">prop.test</span>(<span class="dv">91</span>, <span class="dv">1000</span>, <span class="dt">p =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  91 out of 1000, null probability 0.05
## X-squared = 34.532, df = 1, p-value = 4.194e-09
## alternative hypothesis: true p is not equal to 0.05
## 95 percent confidence interval:
##  0.07425035 0.11096724
## sample estimates:
##     p 
## 0.091</code></pre>
<p>Ah, now, that’s interesting. A supposed <span class="math inline">\(\alpha = 0.05\)</span> test is actually rejecting around 9% of the time, which is significantly different from 0.05. This surprises me. So the ANOVA is actually <em>not</em> all that accurate.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a></p>
<p>So now let’s do the same simulation for the Welch ANOVA to see whether it’s better:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-1"></a>sim_from <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-3"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-3"></a><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-4"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-4"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-5"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">list</span>(<span class="kw">rnorm</span>(n, mean, sd))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-6"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-6"></a><span class="st">  </span><span class="kw">unnest</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-7"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-7"></a><span class="st">  </span><span class="kw">nest_by</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-8"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-8"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-9"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_anova =</span> <span class="kw">list</span>(<span class="kw">oneway.test</span>(y <span class="op">~</span><span class="st"> </span>trt, <span class="dt">data =</span> data))) <span class="op">%&gt;%</span></span>
<span id="cb87-10"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pval =</span> my_anova<span class="op">$</span>p.value) -&gt;<span class="st"> </span>sim_pval2</span>
<span id="cb87-11"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb87-11"></a>sim_pval2</span></code></pre></div>
<p>This one is a bit easier because <code>oneway.test</code> has a thing called <code>p.value</code> that you can just pull out. No need to use <code>tidy</code> here.</p>
<p>How many of <em>those</em> P-values are less than 0.05?</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb88-1"></a>sim_pval2 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-2"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb88-2"></a><span class="st">  </span><span class="kw">count</span>(pval <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>)</span></code></pre></div>
<p>That couldn’t be much closer to the mark:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#cb89-1"></a><span class="kw">prop.test</span>(<span class="dv">49</span>, <span class="dv">1000</span>, <span class="dt">p =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  49 out of 1000, null probability 0.05
## X-squared = 0.0052632, df = 1, p-value = 0.9422
## alternative hypothesis: true p is not equal to 0.05
## 95 percent confidence interval:
##  0.03682698 0.06475244
## sample estimates:
##     p 
## 0.049</code></pre>
<p>This one is on the money.<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a> The proportion of times our simulation falsely rejects is not significantly different from 0.05. So this investigation says that the Welch ANOVA is much more trustworthy for data resembling what we observed.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>The piece in the problem statement about why these two labels were used is clarification for you and doesn’t belong in the report. If you leave it in, you need to at least paraphrase it; simply copying it without having a reason to do so shows that you are not thinking.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>I’m using a fair few of my own words from the question. This is OK if you think they are clear, but the aim is to write a report that sounds like you rather than me.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Offer supported opinions of your own here, which don’t need to be the same as mine. Alternatively, you can get the graph and numerical summaries first and comment on them both at once.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Use the full name of the shampoo if you are making a conclusion about it.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>I’ve used <code>scales = "free"</code> to get the plots to fill their boxes, for the best assessment of normality. The downside of doing it this way is that you cannot use the slopes of the lines to compare spreads. I think this way is still better, though, because the mean for placebo is so much bigger than the others that if you use the same scale for each plot, you’ll be wasting a lot of plot real estate that you could use to get a better picture of the normality.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>It’s also good, arguably clearer, to use this as your exploratory plot. This enables you to get to a discussion about normality earlier and you might decide in that case that you don’t even need this discussion. You can do the assessment of assumptions first, and then do the corresponding analysis, or you can pick an apparently reasonable analysis and then critique it afterwards. Either way is logical here. In other cases it might be different; for example, in a regression, you might need to fit a model first and improve it after, since it may not be so clear what a good model might be off the top.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>This is a way to write it if you suspect your reader won’t remember what a normal quantile plot is, and by writing it this way you won’t insult their intelligence if they  remember after all. The other side benefit of writing it this way is that it shows  understanding as well.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>If you have any doubts about sufficient normality, you need to make sure you have also considered the relevant sample size, but if you are already happy with the normality, there is no need. The placebo group, for example, is the smallest, but its shape is if anything short-tailed, so its non-normality will be no problem no matter how small the sample is.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>I’d rather assess equality of spreads by eyeballing them than by doing a test, but if you really want to, you could use Levene’s test, illustrated elsewhere in PASIAS and in Extra 4 for these data. It works for any number of groups, not just two.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>I wanted to make it clear where my report ended and where the additional chat began.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>I explain the  below the plot.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>It looks to me as if the boxplot has been attacked by mosquitoes.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>The default jittering is up to a maximum of not quite halfway to the next value. Here that means that each observation is nearest to the box it belongs with.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>I learned this today.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Because the true alpha for the combined procedure in which the test you do second depends on the result of the first test is no longer 0.05; you need to think about what that true alpha is. It might not be too bad here, because regular ANOVA and Welch ANOVA tend to come out similar unless the sample variances are very different, in the same way that the Welch and pooled two-sample tests do. But it is not something to take for granted.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>There are other tests you could use here. I like Levene’s test because it works best when the samples are not normal, but the normality is OK here, so this is not so much of an issue. Of course, the time you want to be assessing equality of variances is when you have already seen sufficient normality, but that might have been because the samples were large rather than that they were especially normal in shape themselves.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>At this moment, subject to change, etc etc.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Or you can remember or look up the names to the inputs, and then you can have them in any order you like. But I know which order they come, which is good enough for me.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>When you get a simulation result that is not what you were expecting, there are two options to explore: either it really is different from your expectation, or there is something wrong with your code. I think my code is OK here, but do let me know if you see a problem with it.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>You could redo this with 10,000 simulations to convince yourself further.<a href="a-comparison-of-four-shampoos-in-treating-dandruff.html#fnref21" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="learning-to-code.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidying-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["pasias.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

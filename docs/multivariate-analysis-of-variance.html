<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 32 Multivariate analysis of variance | Problems and Solutions in Applied Statistics</title>
  <meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 32 Multivariate analysis of variance | Problems and Solutions in Applied Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://ritsokiguess.site/pasias" />
  
  <meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="github-repo" content="nxskok/pasias" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 32 Multivariate analysis of variance | Problems and Solutions in Applied Statistics" />
  
  <meta name="twitter:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  

<meta name="author" content="Ken Butler" />


<meta name="date" content="2021-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysis-of-covariance.html"/>
<link rel="next" href="repeated-measures.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Problems and Solutions in Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages-used-somewhere-in-this-book"><i class="fa fa-check"></i>Packages used somewhere in this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>1</b> Getting used to R and R Studio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#running-r-studio-on-jupyterhub"><i class="fa fa-check"></i><b>1.1</b> Running R Studio on Jupyterhub</a></li>
<li class="chapter" data-level="1.2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><i class="fa fa-check"></i><b>1.2</b> Getting an R Studio Cloud account</a></li>
<li class="chapter" data-level="1.3" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a></li>
<li class="chapter" data-level="1.4" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><i class="fa fa-check"></i><b>1.4</b> Reading data from a file</a></li>
<li class="chapter" data-level="1.5" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-files-different-ways"><i class="fa fa-check"></i><b>1.5</b> Reading files different ways</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-in-data.html"><a href="reading-in-data.html"><i class="fa fa-check"></i><b>2</b> Reading in data</a></li>
<li class="chapter" data-level="3" data-path="drawing-graphs.html"><a href="drawing-graphs.html"><i class="fa fa-check"></i><b>3</b> Drawing graphs</a></li>
<li class="chapter" data-level="4" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>4</b> Data exploration</a></li>
<li class="chapter" data-level="5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>5</b> Working with dataframes</a></li>
<li class="chapter" data-level="6" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>6</b> One-sample inference</a></li>
<li class="chapter" data-level="7" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>7</b> Two-sample inference</a></li>
<li class="chapter" data-level="8" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>8</b> Power and sample size</a></li>
<li class="chapter" data-level="9" data-path="the-sign-test.html"><a href="the-sign-test.html"><i class="fa fa-check"></i><b>9</b> The sign test</a></li>
<li class="chapter" data-level="10" data-path="mood-median-test.html"><a href="mood-median-test.html"><i class="fa fa-check"></i><b>10</b> Mood median test</a></li>
<li class="chapter" data-level="11" data-path="matched-pairs-t-and-sign-test.html"><a href="matched-pairs-t-and-sign-test.html"><i class="fa fa-check"></i><b>11</b> Matched pairs t and sign test</a></li>
<li class="chapter" data-level="12" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html"><i class="fa fa-check"></i><b>12</b> Normal quantile plots</a><ul>
<li class="chapter" data-level="12.1" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><i class="fa fa-check"></i><b>12.1</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.2" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality"><i class="fa fa-check"></i><b>12.2</b> Ferritin and normality</a></li>
<li class="chapter" data-level="12.3" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers-1"><i class="fa fa-check"></i><b>12.3</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.4" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality-1"><i class="fa fa-check"></i><b>12.4</b> Ferritin and normality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>13</b> Analysis of variance</a></li>
<li class="chapter" data-level="14" data-path="writing-reports.html"><a href="writing-reports.html"><i class="fa fa-check"></i><b>14</b> Writing reports</a></li>
<li class="chapter" data-level="15" data-path="learning-to-code.html"><a href="learning-to-code.html"><i class="fa fa-check"></i><b>15</b> Learning to code</a><ul>
<li class="chapter" data-level="15.1" data-path="learning-to-code.html"><a href="learning-to-code.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="learning-to-code.html"><a href="learning-to-code.html#data-and-pre-processing"><i class="fa fa-check"></i><b>15.2</b> Data and pre-processing</a></li>
<li class="chapter" data-level="15.3" data-path="learning-to-code.html"><a href="learning-to-code.html#analysis"><i class="fa fa-check"></i><b>15.3</b> Analysis</a></li>
<li class="chapter" data-level="15.4" data-path="learning-to-code.html"><a href="learning-to-code.html#conclusions-see-note-9"><i class="fa fa-check"></i><b>15.4</b> Conclusions (see note 9)</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="treating-dandruff.html"><a href="treating-dandruff.html"><i class="fa fa-check"></i><b>16</b> Treating dandruff</a><ul>
<li class="chapter" data-level="16.1" data-path="treating-dandruff.html"><a href="treating-dandruff.html#introduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="treating-dandruff.html"><a href="treating-dandruff.html#exploratory-analysis"><i class="fa fa-check"></i><b>16.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="16.3" data-path="treating-dandruff.html"><a href="treating-dandruff.html#analysis-of-variance-1"><i class="fa fa-check"></i><b>16.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="16.4" data-path="treating-dandruff.html"><a href="treating-dandruff.html#assessment-of-assumptions"><i class="fa fa-check"></i><b>16.4</b> Assessment of Assumptions</a></li>
<li class="chapter" data-level="16.5" data-path="treating-dandruff.html"><a href="treating-dandruff.html#conclusions"><i class="fa fa-check"></i><b>16.5</b> Conclusions</a></li>
<li class="chapter" data-level="16.6" data-path="treating-dandruff.html"><a href="treating-dandruff.html#end"><i class="fa fa-check"></i><b>16.6</b> End</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>17</b> Tidying data</a></li>
<li class="chapter" data-level="18" data-path="simple-regression.html"><a href="simple-regression.html"><i class="fa fa-check"></i><b>18</b> Simple regression</a></li>
<li class="chapter" data-level="19" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>19</b> Multiple regression</a></li>
<li class="chapter" data-level="20" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html"><i class="fa fa-check"></i><b>20</b> Regression with categorical variables</a><ul>
<li class="chapter" data-level="20.1" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited"><i class="fa fa-check"></i><b>20.1</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.2" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching"><i class="fa fa-check"></i><b>20.2</b> Pulse rates and marching</a></li>
<li class="chapter" data-level="20.3" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited-1"><i class="fa fa-check"></i><b>20.3</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.4" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching-1"><i class="fa fa-check"></i><b>20.4</b> Pulse rates and marching</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>21</b> Dates and times</a></li>
<li class="chapter" data-level="22" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>22</b> Functions</a></li>
<li class="chapter" data-level="23" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html"><i class="fa fa-check"></i><b>23</b> Vector and matrix algebra</a><ul>
<li class="chapter" data-level="23.1" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again"><i class="fa fa-check"></i><b>23.1</b> Heights and foot lengths again</a></li>
<li class="chapter" data-level="23.2" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again-1"><i class="fa fa-check"></i><b>23.2</b> Heights and foot lengths again</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>24</b> The Bootstrap</a></li>
<li class="chapter" data-level="25" data-path="bayesian-statistics-with-stan.html"><a href="bayesian-statistics-with-stan.html"><i class="fa fa-check"></i><b>25</b> Bayesian Statistics with Stan</a></li>
<li class="chapter" data-level="26" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>26</b> Logistic regression</a></li>
<li class="chapter" data-level="27" data-path="logistic-regression-with-ordinal-response.html"><a href="logistic-regression-with-ordinal-response.html"><i class="fa fa-check"></i><b>27</b> Logistic regression with ordinal response</a></li>
<li class="chapter" data-level="28" data-path="logistic-regression-with-nominal-response.html"><a href="logistic-regression-with-nominal-response.html"><i class="fa fa-check"></i><b>28</b> Logistic regression with nominal response</a></li>
<li class="chapter" data-level="29" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>29</b> Survival analysis</a></li>
<li class="chapter" data-level="30" data-path="analysis-of-variance-revisited.html"><a href="analysis-of-variance-revisited.html"><i class="fa fa-check"></i><b>30</b> Analysis of variance revisited</a></li>
<li class="chapter" data-level="31" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>31</b> Analysis of covariance</a></li>
<li class="chapter" data-level="32" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>32</b> Multivariate analysis of variance</a><ul>
<li class="chapter" data-level="32.1" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html#fabricated-data"><i class="fa fa-check"></i><b>32.1</b> Fabricated data</a></li>
<li class="chapter" data-level="32.2" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html#do-characteristics-of-urine-depend-on-obesity"><i class="fa fa-check"></i><b>32.2</b> Do characteristics of urine depend on obesity?</a></li>
<li class="chapter" data-level="32.3" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html#how-do-height-and-weight-depend-on-sport-played-by-elite-athletes"><i class="fa fa-check"></i><b>32.3</b> How do height and weight depend on sport played by elite athletes?</a></li>
<li class="chapter" data-level="32.4" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html#fabricated-data-1"><i class="fa fa-check"></i><b>32.4</b> Fabricated data</a></li>
<li class="chapter" data-level="32.5" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html#do-characteristics-of-urine-depend-on-obesity-1"><i class="fa fa-check"></i><b>32.5</b> Do characteristics of urine depend on obesity?</a></li>
<li class="chapter" data-level="32.6" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html#how-do-height-and-weight-depend-on-sport-played-by-elite-athletes-1"><i class="fa fa-check"></i><b>32.6</b> How do height and weight depend on sport played by elite athletes?</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i><b>33</b> Repeated measures</a></li>
<li class="chapter" data-level="34" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>34</b> Discriminant analysis</a></li>
<li class="chapter" data-level="35" data-path="hierarchical-cluster-analysis.html"><a href="hierarchical-cluster-analysis.html"><i class="fa fa-check"></i><b>35</b> Hierarchical cluster analysis</a></li>
<li class="chapter" data-level="36" data-path="k-means-cluster-analysis.html"><a href="k-means-cluster-analysis.html"><i class="fa fa-check"></i><b>36</b> K-means cluster analysis</a></li>
<li class="chapter" data-level="37" data-path="drawing-maps-with-leaflet.html"><a href="drawing-maps-with-leaflet.html"><i class="fa fa-check"></i><b>37</b> Drawing maps with Leaflet</a></li>
<li class="chapter" data-level="38" data-path="multidimensional-scaling.html"><a href="multidimensional-scaling.html"><i class="fa fa-check"></i><b>38</b> Multidimensional Scaling</a></li>
<li class="chapter" data-level="39" data-path="principal-components.html"><a href="principal-components.html"><i class="fa fa-check"></i><b>39</b> Principal Components</a><ul>
<li class="chapter" data-level="39.1" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere"><i class="fa fa-check"></i><b>39.1</b> The weather, somewhere</a></li>
<li class="chapter" data-level="39.2" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere-1"><i class="fa fa-check"></i><b>39.2</b> The weather, somewhere</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>40</b> Factor Analysis</a></li>
<li class="chapter" data-level="41" data-path="frequency-table-analysis.html"><a href="frequency-table-analysis.html"><i class="fa fa-check"></i><b>41</b> Frequency table analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Problems and Solutions in Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-analysis-of-variance" class="section level1">
<h1><span class="header-section-number">Chapter 32</span> Multivariate analysis of variance</h1>
<p>Packages for this chapter:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb250-2" title="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="fabricated-data" class="section level2">
<h2><span class="header-section-number">32.1</span> Fabricated data</h2>
<p>The data in
<a href="http://ritsokiguess.site/datafiles/simple-manova.txt">link</a>
(probably made up) are measurements of two
variables <code>y1</code> and <code>y2</code> on three groups, labelled
<code>a</code>, <code>b</code> and <code>c</code>. We want to see whether
<code>y1</code> or <code>y2</code> or some combination of them differ among
the groups.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data and check that you have 12 observations on
2 numeric variables from 3 different groups.</p></li>
<li><p>Run a one-way ANOVA predicting <code>y1</code> from
<code>group</code>. Are there any significant differences in <code>y1</code>
among the groups? If necessary, run Tukey. What do you conclude?</p></li>
<li><p>Repeat all the previous part for <code>y2</code>.</p></li>
<li><p>Make a plot of <code>y1</code> against <code>y2</code>, with the
points distinguished by which group they are from.</p></li>
<li><p>How is it that group <code>b</code> is not distinguishable on
either <code>y1</code> or <code>y2</code> individually (from the ANOVAs),
but <em>is</em> distinguishable on your graph? Explain briefly.</p></li>
<li><p>Run a one-way multivariate analysis of variance, obtaining
a P-value. Note the very small P-value.</p></li>
</ol>
</div>
<div id="do-characteristics-of-urine-depend-on-obesity" class="section level2">
<h2><span class="header-section-number">32.2</span> Do characteristics of urine depend on obesity?</h2>
<p>A study was made of the characteristics of urine of young
men. The men were classified into four groups based on their degree of
obesity. (The groups are labelled <code>a, b, c, d</code>.) Four variables
were measured, <code>x</code> (which you can ignore), pigment creatinine,
chloride and chlorine. The data are in
<a href="http://ritsokiguess.site/datafiles/urine.csv">link</a> as a
<code>.csv</code> file. There are 45 men altogether.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data and check that you have the right number
of observations and the right variables.</p></li>
<li><p>Make boxplots of each of the three variables of interest
against obesity group.</p></li>
<li><p>How, if at all, do the groups differ on the variables of interest?</p></li>
<li><p>Run a multivariate analysis of variance, using the three
variables of interest as response variables, and the obesity group
as explanatory. (This is a so-called one-way MANOVA.)</p></li>
<li><p>What do you conclude? Is this in line with what your
boxplots said? Explain briefly.</p></li>
</ol>
</div>
<div id="how-do-height-and-weight-depend-on-sport-played-by-elite-athletes" class="section level2">
<h2><span class="header-section-number">32.3</span> How do height and weight depend on sport played by elite athletes?</h2>
<p>This question uses the data on Australian elite athletes,
which can be found at
<a href="http://ritsokiguess.site/datafiles/ais.txt">link</a>. 202 elite
athletes had various physical and physiological measurements taken,
and for each athlete, their gender (in the column <code>Sex</code>) and
the sport they play (<code>Sport</code>) was also noted. The data values
are separated by <em>tabs</em>, meaning that <code>read_tsv</code> will
read them in.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data and verify that you have 202 rows and 13
columns.</p></li>
<li><p>We are going to see whether the height-weight combination
of an athlete depends significantly on which sport they play and which gender
they are. Explain (very) briefly why a multivariate analysis of
variance will be necessary to do this.</p></li>
<li><p>Create a response variable for a MANOVA. (You don’t need to
show what you got, since it is rather big.) The columns you want are
called <code>Ht</code> and <code>Wt</code>.</p></li>
<li><p>Run a multivariate analysis of variance to see whether the
height-weight combination depends significantly on gender, sport or the
combination of both. Display the results. Use the small-m
<code>manova</code> way to do this one.</p></li>
<li><p>Briefly justify removing the interaction term from your
previous model, and fit a model without it. You can use either
<code>manova</code> or <code>Manova</code> for this; they should both
work. (You only need to use one of them.) Display your results.</p></li>
<li><p>See if you can make a graph that shows what’s going on
here. Bear in mind that you have two quantitative variables and
<em>two</em> categorical ones, so you will need to find a way to
display everything. Hint: what would you do with two quantitative
variables and <em>one</em> categorical one? Can you find a way to
generalize that idea by displaying the other categorical variable
differently? I think we have seen a couple of ideas that will work,
somewhere in the lecture notes (but in a different context). Or you
can search for ideas, of course.
For full marks, obtain a plot which does not give you any
warnings. (The grader will know which of the possible plots give
warnings, and will deduct extra marks if you assert that a plot
gives no warnings when in fact it does. That is to say, if you get
any warnings, <em>you need to include those in what you hand in</em>).</p></li>
</ol>
<p>My solutions follow:</p>
</div>
<div id="fabricated-data-1" class="section level2">
<h2><span class="header-section-number">32.4</span> Fabricated data</h2>
<p>The data in
<a href="http://ritsokiguess.site/datafiles/simple-manova.txt">link</a>
(probably made up) are measurements of two
variables <code>y1</code> and <code>y2</code> on three groups, labelled
<code>a</code>, <code>b</code> and <code>c</code>. We want to see whether
<code>y1</code> or <code>y2</code> or some combination of them differ among
the groups.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and check that you have 12 observations on
2 numeric variables from 3 different groups.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/simple-manova.txt&quot;</span></a>
<a class="sourceLine" id="cb251-2" title="2">simple &lt;-<span class="st"> </span><span class="kw">read_delim</span>(my_url, <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   group = col_character(),
##   y1 = col_double(),
##   y2 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1">simple</a></code></pre></div>
<pre><code>## # A tibble: 12 x 3
##    group    y1    y2
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 a         2     3
##  2 a         3     4
##  3 a         5     4
##  4 a         2     5
##  5 b         4     8
##  6 b         5     6
##  7 b         5     7
##  8 c         7     6
##  9 c         8     7
## 10 c        10     8
## 11 c         9     5
## 12 c         7     6</code></pre>
<p>As promised: 12 observations, 2 numeric variables <code>y1</code> and
<code>y2</code>, and one categorical variable (as text) containing three
groups <code>a,b,c</code>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Run a one-way ANOVA predicting <code>y1</code> from
<code>group</code>. Are there any significant differences in <code>y1</code>
among the groups? If necessary, run Tukey. What do you conclude?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1">simple<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">aov</span>(y1 <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> simple)</a>
<a class="sourceLine" id="cb255-2" title="2"><span class="kw">summary</span>(simple<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## group        2  63.45   31.72    21.2 0.000393 ***
## Residuals    9  13.47    1.50                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1"><span class="kw">TukeyHSD</span>(simple<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = y1 ~ group, data = simple)
## 
## $group
##         diff        lwr      upr     p adj
## b-a 1.666667 -0.9417891 4.275122 0.2289181
## c-a 5.200000  2.9089670 7.491033 0.0003548
## c-b 3.533333  1.0391725 6.027494 0.0083999</code></pre>
<p>The <span class="math inline">\(F\)</span>-test said that there were differences among the groups, so I
ran Tukey and found that group <code>c</code> is significantly bigger on
<code>y1</code> than the other two groups.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Repeat all the previous part for <code>y2</code>.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1">simple<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">aov</span>(y2 <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> simple)</a>
<a class="sourceLine" id="cb259-2" title="2"><span class="kw">summary</span>(simple<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## group        2  19.05   9.525   9.318 0.00642 **
## Residuals    9   9.20   1.022                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1"><span class="kw">TukeyHSD</span>(simple<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = y2 ~ group, data = simple)
## 
## $group
##     diff        lwr      upr     p adj
## b-a  3.0  0.8440070 5.155993 0.0093251
## c-a  2.4  0.5063697 4.293630 0.0157279
## c-b -0.6 -2.6615236 1.461524 0.7050026</code></pre>
<p>Same idea: there is a difference, and Tukey reveals that this time
group <code>a</code> is significantly <em>smaller</em> than the other groups
on <code>y2</code>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Make a plot of <code>y1</code> against <code>y2</code>, with the
points distinguished by which group they are from.</li>
</ol>
<p>Solution</p>
<p><code>y1</code> and <code>y2</code> can be either way around, since
they are both response variables (!):</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1"><span class="kw">ggplot</span>(simple, <span class="kw">aes</span>(<span class="dt">x =</span> y1, <span class="dt">y =</span> y2, <span class="dt">colour =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/manova1-4-1.png" width="672" /></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>How is it that group <code>b</code> is not distinguishable on
either <code>y1</code> or <code>y2</code> individually (from the ANOVAs),
but <em>is</em> distinguishable on your graph? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>Group <code>b</code> has the same kind of <code>y1</code> values as group
<code>a</code> and the same kind of <code>y2</code> values as group
<code>c</code>. This means looking at either variable singly is not
enough to distinguish group <code>b</code>. But group <code>b</code>
stands out on the graph as being “top left” of the picture. That
means that <code>y1</code> has to be low <em>and</em> <code>y2</code> has to
be high, both together, to pick out group <code>b</code>.
That seems like a lot of work, but the important point
that I want you to raise is that the points in group <code>b</code>
are distinguished by a particular <em>combination</em> of values of
<code>y1</code> and <code>y2</code>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Run a one-way multivariate analysis of variance, obtaining
a P-value. Note the very small P-value.</li>
</ol>
<p>Solution</p>
<p>This is just like the seed weight and yield example in class
(deliberately so):</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1">response &lt;-<span class="st"> </span><span class="kw">with</span>(simple, <span class="kw">cbind</span>(y1, y2))</a>
<a class="sourceLine" id="cb264-2" title="2">simple<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">manova</span>(response <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> simple)</a>
<a class="sourceLine" id="cb264-3" title="3"><span class="kw">summary</span>(simple<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##           Df Pillai approx F num Df den Df    Pr(&gt;F)    
## group      2 1.3534   9.4196      4     18 0.0002735 ***
## Residuals  9                                            
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The P-value here, 0.00027, is smaller than either of the P-values for
the one-variable ANOVAs. This expresses the idea that the group
difference is essentially multivariate (it depends on the
<em>combination</em> of <code>y1</code> and <code>y2</code> values). I only
wanted you to note that it is smaller than either of the other
ANOVAs; you don’t need to say anything about why.</p>
<p>We were in the fortunate position of being able to draw a picture,
because we had only two response variables, and we could plot them
against each other with the groups labelled. (If we had three response
variables, like the peanuts example, we wouldn’t be able to do this,
barring some kind of 3D-plotting procedure.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="do-characteristics-of-urine-depend-on-obesity-1" class="section level2">
<h2><span class="header-section-number">32.5</span> Do characteristics of urine depend on obesity?</h2>
<p>A study was made of the characteristics of urine of young
men. The men were classified into four groups based on their degree of
obesity. (The groups are labelled <code>a, b, c, d</code>.) Four variables
were measured, <code>x</code> (which you can ignore), pigment creatinine,
chloride and chlorine. The data are in
<a href="http://ritsokiguess.site/datafiles/urine.csv">link</a> as a
<code>.csv</code> file. There are 45 men altogether.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and check that you have the right number
of observations and the right variables.</li>
</ol>
<p>Solution</p>
<p><code>read_csv</code>:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/urine.csv&quot;</span></a>
<a class="sourceLine" id="cb266-2" title="2">urine &lt;-<span class="st"> </span><span class="kw">read_csv</span>(my_url)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   obesity = col_character(),
##   x = col_double(),
##   creatinine = col_double(),
##   chloride = col_double(),
##   chlorine = col_double()
## )</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1">urine</a></code></pre></div>
<pre><code>## # A tibble: 45 x 5
##    obesity     x creatinine chloride chlorine
##    &lt;chr&gt;   &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 a          24       17.6     5.15      7.5
##  2 a          32       13.4     5.75      7.1
##  3 a          17       20.3     4.35      2.3
##  4 a          30       22.3     7.55      4  
##  5 a          30       20.5     8.5       2  
##  6 a          27       18.5    10.2       2  
##  7 a          25       12.1     5.95     16.8
##  8 a          30       12       6.3      14.5
##  9 a          28       10.1     5.45      0.9
## 10 a          24       14.7     3.75      2  
## # … with 35 more rows</code></pre>
<p>The variables are as promised, and we do indeed have 45 rows.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Make boxplots of each of the three variables of interest
against obesity group.</li>
</ol>
<p>Solution</p>
<p>Just churn through it:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1"><span class="kw">ggplot</span>(urine, <span class="kw">aes</span>(<span class="dt">x =</span> obesity, <span class="dt">y =</span> creatinine)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/peppercorn-1.png" width="672" /></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1"><span class="kw">ggplot</span>(urine, <span class="kw">aes</span>(<span class="dt">x =</span> obesity, <span class="dt">y =</span> chlorine)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/peppercorn-2.png" width="672" /></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1"><span class="kw">ggplot</span>(urine, <span class="kw">aes</span>(<span class="dt">x =</span> obesity, <span class="dt">y =</span> chloride)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/peppercorn-3.png" width="672" /></p>
<p>This also works with facets, though it is different from the other
ones we’ve done, in that we have to collect together the <span class="math inline">\(y\)</span>-variables
first rather than the <span class="math inline">\(x\)</span>s:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1">urine <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb273-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(creatinine<span class="op">:</span>chlorine, <span class="dt">names_to=</span><span class="st">&quot;yname&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;y&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb273-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> obesity, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb273-4" title="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>yname, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/urine-2-1.png" width="672" /></p>
<p>I decided to throw a couple of things in here: first, the
<code>scales="free"</code> thing since the <span class="math inline">\(y\)</span>-variables (this time) are
on different scales, and second, the <code>ncol=2</code> to arrange the
facets in (3 cells of) a <span class="math inline">\(2\times 2\)</span> grid, rather than having them
come out tall and skinny.<a href="#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a> It’s unusual to have faceted boxplots, but this is one
of those cases where it makes sense. (The key is different <span class="math inline">\(y\)</span>’s but
the same <span class="math inline">\(x\)</span>, I think.)</p>
<p>The conclusions about the boxplots are, of course, the same. I think
it makes it easier to have the three boxplots side by side, but it’s
up to you whether you think that gain is worth the extra coding.</p>
<p>Extra: let’s take another look at that longer data frame:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1">urine <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb274-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(creatinine<span class="op">:</span>chlorine, <span class="dt">names_to=</span><span class="st">&quot;yname&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;y&quot;</span>) </a></code></pre></div>
<pre><code>## # A tibble: 135 x 4
##    obesity     x yname          y
##    &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
##  1 a          24 creatinine 17.6 
##  2 a          24 chloride    5.15
##  3 a          24 chlorine    7.5 
##  4 a          32 creatinine 13.4 
##  5 a          32 chloride    5.75
##  6 a          32 chlorine    7.1 
##  7 a          17 creatinine 20.3 
##  8 a          17 chloride    4.35
##  9 a          17 chlorine    2.3 
## 10 a          30 creatinine 22.3 
## # … with 125 more rows</code></pre>
<p>You might say that there is one quantitative variable now, the thing we called <code>y</code>, and <em>two</em> categorical variables, <code>obesity</code> and <code>yname</code>. So why not make a grouped boxplot? All right:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1">urine <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(creatinine<span class="op">:</span>chlorine, <span class="dt">names_to=</span><span class="st">&quot;yname&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;y&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yname, <span class="dt">y=</span>y, <span class="dt">colour=</span>obesity)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/urine-4-1.png" width="672" /></p>
<p>This actually looks a lot like the facetted boxplots (if you imagine drawing a box around each group of four boxplots and removing the <code>scales="free"</code> before). There is, as the saying goes, more than one way to skin a cat.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>How, if at all, do the groups differ on the variables of interest?</li>
</ol>
<p>Solution</p>
<p>Any sensible comment here is good. You can take the approach that
group D is lowest on creatinine and chloride, but there is not
much to choose (given the amount of variability) on chlorine. Or
you can say that groups B and C are generally highest, except for
chloride where A is higher. Anything of this general kind is fine.
The point here is that some of the groups appear to be different
on some of the variables, which would make a multivariate analysis
of variance (in a moment) come out significant.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Run a multivariate analysis of variance, using the three
variables of interest as response variables, and the obesity group
as explanatory. (This is a so-called one-way MANOVA.)</li>
</ol>
<p>Solution</p>
<p>Create the response variable and run <code>manova</code>:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1">response &lt;-<span class="st"> </span><span class="kw">with</span>(urine, <span class="kw">cbind</span>(creatinine, chlorine, chloride))</a>
<a class="sourceLine" id="cb277-2" title="2">urine<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">manova</span>(response <span class="op">~</span><span class="st"> </span>obesity, <span class="dt">data =</span> urine)</a>
<a class="sourceLine" id="cb277-3" title="3"><span class="kw">summary</span>(urine<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##           Df  Pillai approx F num Df den Df  Pr(&gt;F)  
## obesity    3 0.43144   2.2956      9    123 0.02034 *
## Residuals 41                                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>What do you conclude? Is this in line with what your
boxplots said? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The null hypothesis (that each of the variables have the same mean
for each of the groups) is rejected: that is, not all of the
groups have the same mean on all of the variables.
Based on the idea that there seemed to be differences between the
groups in the boxplots, this makes sense. (That’s what I saw,
anyway. There was a lot of variability within the groups, which is
why the P-value didn’t come out smaller.)
The other way of doing this is the following, using
<code>Manova</code> from <code>car</code>:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1">response<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(response <span class="op">~</span><span class="st"> </span>obesity, <span class="dt">data =</span> urine)</a>
<a class="sourceLine" id="cb279-2" title="2"><span class="kw">Manova</span>(response<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## 
## Type II MANOVA Tests: Pillai test statistic
##         Df test stat approx F num Df den Df  Pr(&gt;F)  
## obesity  3   0.43144   2.2956      9    123 0.02034 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The result is the same. You don’t need do this one here (though you
can as an alternative), but when you come to repeated measures you
<em>will</em> need to be able to use <code>Manova</code>.</p>
<p>To understand the differences in the variables due to the groups, we
need to run a discriminant analysis (coming up later).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="how-do-height-and-weight-depend-on-sport-played-by-elite-athletes-1" class="section level2">
<h2><span class="header-section-number">32.6</span> How do height and weight depend on sport played by elite athletes?</h2>
<p>This question uses the data on Australian elite athletes,
which can be found at
<a href="http://ritsokiguess.site/datafiles/ais.txt">link</a>. 202 elite
athletes had various physical and physiological measurements taken,
and for each athlete, their gender (in the column <code>Sex</code>) and
the sport they play (<code>Sport</code>) was also noted. The data values
are separated by <em>tabs</em>, meaning that <code>read_tsv</code> will
read them in.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and verify that you have 202 rows and 13
columns.</li>
</ol>
<p>Solution</p>
<p>As in the hint:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/ais.txt&quot;</span></a>
<a class="sourceLine" id="cb281-2" title="2">athletes &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(my_url)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   Sex = col_character(),
##   Sport = col_character(),
##   RCC = col_double(),
##   WCC = col_double(),
##   Hc = col_double(),
##   Hg = col_double(),
##   Ferr = col_double(),
##   BMI = col_double(),
##   SSF = col_double(),
##   `%Bfat` = col_double(),
##   LBM = col_double(),
##   Ht = col_double(),
##   Wt = col_double()
## )</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1">athletes</a></code></pre></div>
<pre><code>## # A tibble: 202 x 13
##    Sex    Sport     RCC   WCC    Hc    Hg  Ferr   BMI   SSF `%Bfat`   LBM    Ht    Wt
##    &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 female Netball  4.56  13.3  42.2  13.6    20  19.2  49      11.3  53.1  177.  59.9
##  2 female Netball  4.15   6    38    12.7    59  21.2 110.     25.3  47.1  173.  63  
##  3 female Netball  4.16   7.6  37.5  12.3    22  21.4  89      19.4  53.4  176   66.3
##  4 female Netball  4.32   6.4  37.7  12.3    30  21.0  98.3    19.6  48.8  170.  60.7
##  5 female Netball  4.06   5.8  38.7  12.8    78  21.8 122.     23.1  56.0  183   72.9
##  6 female Netball  4.12   6.1  36.6  11.8    21  21.4  90.4    16.9  56.4  178.  67.9
##  7 female Netball  4.17   5    37.4  12.7   109  21.5 107.     21.3  53.1  177.  67.5
##  8 female Netball  3.8    6.6  36.5  12.4   102  24.4 157.     26.6  54.4  174.  74.1
##  9 female Netball  3.96   5.5  36.3  12.4    71  22.6 101.     17.9  56.0  174.  68.2
## 10 female Netball  4.44   9.7  41.4  14.1    64  22.8 126.     25.0  51.6  174.  68.8
## # … with 192 more rows</code></pre>
<p>202 rows and 13 columns indeed.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>We are going to see whether the height-weight combination
of an athlete depends significantly on which sport they play and which gender
they are. Explain (very) briefly why a multivariate analysis of
variance will be necessary to do this.</li>
</ol>
<p>Solution</p>
<p>We now have <em>two</em> response variables, height and weight,
rather than just one. In order to do a test with more than one
response variable, we need to use multivariate ANOVA rather than
regular ANOVA. (The first sentence is enough.)</p>
<p>Extra: the explanatory variables, sport and gender, are both
categorical here, which makes a MANOVA work. If either of them had
been quantitative, we would have needed to do a multivariate
regression, which is beyond the scope of what we do in this course.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Create a response variable for a MANOVA. (You don’t need to
show what you got, since it is rather big.) The columns you want are
called <code>Ht</code> and <code>Wt</code>.</li>
</ol>
<p>Solution</p>
<p>Use <code>cbind</code> to glue the two columns together:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1">response &lt;-<span class="st"> </span><span class="kw">with</span>(athletes, <span class="kw">cbind</span>(Ht, Wt))</a></code></pre></div>
<p>Either way around, height or weight first, is good. Also good is the
dollar sign, which you’ll need to do twice (and thus the <code>with</code>
way is more elegant):</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1">response_a &lt;-<span class="st"> </span><span class="kw">cbind</span>(athletes<span class="op">$</span>Ht, athletes<span class="op">$</span>Wt)</a></code></pre></div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Run a multivariate analysis of variance to see whether the
height-weight combination depends significantly on gender, sport or the
combination of both. Display the results. Use the small-m
<code>manova</code> way to do this one.</li>
</ol>
<p>Solution</p>
<p>The straightforward way is small-m <code>manova</code>. I don’t know
what I should be calling my fitted model object, so I’m making
something up. Don’t forget to use the right names for the
variables, and to include an interaction:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1">htwt<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">manova</span>(response <span class="op">~</span><span class="st"> </span>Sex <span class="op">*</span><span class="st"> </span>Sport, <span class="dt">data =</span> athletes)</a>
<a class="sourceLine" id="cb287-2" title="2"><span class="kw">summary</span>(htwt<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##            Df  Pillai approx F num Df den Df Pr(&gt;F)    
## Sex         1 0.52412  101.325      2    184 &lt;2e-16 ***
## Sport       9 0.87914   16.123     18    370 &lt;2e-16 ***
## Sex:Sport   6 0.04105    0.646     12    370 0.8023    
## Residuals 185                                          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The other way is apparently to use large-M <code>Manova</code> from package
<code>car</code>. This goes as a two-stage process: fit an <code>lm</code>
first with the same model formula as above, and then pass <em>that</em>
into <code>Manova</code>. This way, you just display the final result,
rather than passing it into <code>summary</code>:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">htwt<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(response <span class="op">~</span><span class="st"> </span>Sex <span class="op">*</span><span class="st"> </span>Sport, <span class="dt">data =</span> athletes)</a>
<a class="sourceLine" id="cb289-2" title="2">htwt<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">Manova</span>(htwt<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>## Error in solve.default(wcrossprod(model.matrix(mod), w = wts)): Lapack routine dgesv: system is exactly singular: U[13,13] = 0</code></pre>
<p>Except that this doesn’t work, for reasons that I don’t
understand. <code>htwt.2</code> is fine; it’s the <code>Manova</code> that is
not working.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Briefly justify removing the interaction term from your
previous model, and fit a model without it. You can use either
<code>manova</code> or <code>Manova</code> for this; they should both
work. (You only need to use one of them.) Display your results.</li>
</ol>
<p>Solution</p>
<p>The interaction should come out, since it is not
significant. (This is what I meant by “briefly.”)
To do that, in each case, replace the <code>*</code> with a <code>+</code>, or use
<code>update</code>. Most of those work:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1">htwt<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">manova</span>(response <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Sport, <span class="dt">data =</span> athletes)</a>
<a class="sourceLine" id="cb291-2" title="2"><span class="kw">summary</span>(htwt<span class="fl">.4</span>)</a></code></pre></div>
<pre><code>##            Df  Pillai approx F num Df den Df    Pr(&gt;F)    
## Sex         1 0.51888  102.454      2    190 &lt; 2.2e-16 ***
## Sport       9 0.86923   16.314     18    382 &lt; 2.2e-16 ***
## Residuals 191                                             
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>or</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">htwt<span class="fl">.5</span> &lt;-<span class="st"> </span><span class="kw">update</span>(htwt<span class="fl">.1</span>, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>Sex<span class="op">:</span>Sport)</a></code></pre></div>
<pre><code>## Warning in if (projections) qr &lt;- lmcall$qr &lt;- TRUE: the condition has length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## Error in if (projections) qr &lt;- lmcall$qr &lt;- TRUE: argument is not interpretable as logical</code></pre>
<p>It seems that <code>manova</code> things don’t like <code>update</code>. If
that happened to you, try it another way.</p>
<p>or, with <code>Manova</code>, the same two ways:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1">htwt<span class="fl">.6</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(response <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Sport, <span class="dt">data =</span> athletes)</a>
<a class="sourceLine" id="cb296-2" title="2">htwt<span class="fl">.7</span> &lt;-<span class="st"> </span><span class="kw">Manova</span>(htwt<span class="fl">.6</span>)</a>
<a class="sourceLine" id="cb296-3" title="3">htwt<span class="fl">.7</span></a></code></pre></div>
<pre><code>## 
## Type II MANOVA Tests: Pillai test statistic
##       Df test stat approx F num Df den Df    Pr(&gt;F)    
## Sex    1   0.44278   75.489      2    190 &lt; 2.2e-16 ***
## Sport  9   0.86923   16.314     18    382 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>or</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1">htwt<span class="fl">.8</span> &lt;-<span class="st"> </span><span class="kw">update</span>(htwt<span class="fl">.2</span>, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>Sex<span class="op">:</span>Sport)</a>
<a class="sourceLine" id="cb298-2" title="2">htwt<span class="fl">.9</span> &lt;-<span class="st"> </span><span class="kw">Manova</span>(htwt<span class="fl">.8</span>)</a>
<a class="sourceLine" id="cb298-3" title="3">htwt<span class="fl">.9</span></a></code></pre></div>
<pre><code>## 
## Type II MANOVA Tests: Pillai test statistic
##       Df test stat approx F num Df den Df    Pr(&gt;F)    
## Sex    1   0.44278   75.489      2    190 &lt; 2.2e-16 ***
## Sport  9   0.86923   16.314     18    382 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>These both work, and give the same answer. I think this is because the
thing being <code>update</code>d is a regular <code>lm</code>; the
<code>Manova</code> bit comes after, and is calculated from the
<code>lm</code> fit.</p>
<p>Any of these is good, and gets you the same answer.</p>
<p>Extra: it you run <code>summary</code> on the output from <code>Manova</code>,
you get more detail:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="kw">summary</span>(htwt<span class="fl">.9</span>)</a></code></pre></div>
<pre><code>## 
## Type II MANOVA Tests:
## 
## Sum of squares and products for error:
##          Ht        Wt
## Ht 6871.978  5842.771
## Wt 5842.771 13613.021
## 
## ------------------------------------------
##  
## Term: Sex 
## 
## Sum of squares and products for the hypothesis:
##          Ht       Wt
## Ht 4582.744 6146.078
## Wt 6146.078 8242.718
## 
## Multivariate Tests: Sex
##                  Df test stat approx F num Df den Df     Pr(&gt;F)    
## Pillai            1 0.4427781 75.48862      2    190 &lt; 2.22e-16 ***
## Wilks             1 0.5572219 75.48862      2    190 &lt; 2.22e-16 ***
## Hotelling-Lawley  1 0.7946171 75.48862      2    190 &lt; 2.22e-16 ***
## Roy               1 0.7946171 75.48862      2    190 &lt; 2.22e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ------------------------------------------
##  
## Term: Sport 
## 
## Sum of squares and products for the hypothesis:
##          Ht        Wt
## Ht 6162.455  7070.085
## Wt 7070.085 13727.950
## 
## Multivariate Tests: Sport
##                  Df test stat approx F num Df den Df     Pr(&gt;F)    
## Pillai            9 0.8692278 16.31358     18    382 &lt; 2.22e-16 ***
## Wilks             9 0.3132928 16.60578     18    380 &lt; 2.22e-16 ***
## Hotelling-Lawley  9 1.6093145 16.89780     18    378 &lt; 2.22e-16 ***
## Roy               9 1.0593835 22.48247      9    191 &lt; 2.22e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>There are actually <em>four</em> competing tests that generalize the
one-response-variable <span class="math inline">\(F\)</span> statistic in different ways. The one we’ve
been using is called Pillai’s Trace, but if you go looking in a text
on multivariate analysis, you’ll also see the others, especially
Wilks’s <span class="math inline">\(\Lambda\)</span> (that’s a capital lambda). They will generally agree
in terms of conclusion, so you can look at them all if you like, but
it doesn’t hurt much to look at only one.</p>
<p>I am in danger of running out of numbers for my fitted models (and am
definitely in danger of forgetting which one is which)!</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>See if you can make a graph that shows what’s going on
here. Bear in mind that you have two quantitative variables and
<em>two</em> categorical ones, so you will need to find a way to
display everything. Hint: what would you do with two quantitative
variables and <em>one</em> categorical one? Can you find a way to
generalize that idea by displaying the other categorical variable
differently? I think we have seen a couple of ideas that will work,
somewhere in the lecture notes (but in a different context). Or you
can search for ideas, of course.
For full marks, obtain a plot which does not give you any
warnings. (The grader will know which of the possible plots give
warnings, and will deduct extra marks if you assert that a plot
gives no warnings when in fact it does. That is to say, if you get
any warnings, <em>you need to include those in what you hand in</em>).</li>
</ol>
<p>Solution</p>
<p>This will probably involve a bit of digging.
The starting point would be a scatterplot (the two quantitative
variables) with the points distinguished by colour (one of the
categorical variables). What other options do we have?
If you look eg. at the navigation on the left of
<a href="http://sape.inf.usi.ch/quick-reference/ggplot2/size">link</a>, you’ll
see that there are two likely possibilities: <code>shape</code> and
<code>size</code>. <code>shape</code> uses a different plotting symbol for
each value of a categorical variable; <code>size</code> draws the
plotting symbol bigger or smaller according to the value of a
categorical variable.
The remaining question is the one of which aesthetic to “map” to
which variable? To guide you in this, note that we have ten
different sports and two different genders. In my opinion, colours
are the easiest to distinguish a lot of, though even then 10 is
pushing it, then plotting symbols. Symbol sizes are hard to
distinguish a lot of, so it’s best to limit this (if you use it at
all) to gender.
With that in mind, I would go for this one:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1"><span class="kw">ggplot</span>(athletes, <span class="kw">aes</span>(<span class="dt">x =</span> Ht, <span class="dt">y =</span> Wt, <span class="dt">colour =</span> Sport, <span class="dt">shape =</span> Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/hatzer-1.png" width="672" /></p>
<p>If you investigate, you’ll find that <code>ggplot</code> can handle about
six different shapes (and we have ten sports), and it doesn’t care for
using <code>size</code> to distinguish values of a categorical
variable. It will try to draw the graph, but will give you a warning,
such as these:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" title="1"><span class="kw">ggplot</span>(athletes, <span class="kw">aes</span>(<span class="dt">x =</span> Ht, <span class="dt">y =</span> Wt, <span class="dt">colour =</span> Sport, <span class="dt">size =</span> Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Using size for a discrete variable is not advised.</code></pre>
<p><img src="pasias_files/figure-html/delkofer-1.png" width="672" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1"><span class="kw">ggplot</span>(athletes, <span class="kw">aes</span>(<span class="dt">x =</span> Ht, <span class="dt">y =</span> Wt, <span class="dt">shape =</span> Sport, <span class="dt">size =</span> Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Using size for a discrete variable is not advised.</code></pre>
<pre><code>## Warning: The shape palette can deal with a maximum of 6 discrete values because more than 6 becomes difficult to discriminate; you have 10. Consider specifying
## shapes manually if you must have them.</code></pre>
<pre><code>## Warning: Removed 72 rows containing missing values (geom_point).</code></pre>
<p><img src="pasias_files/figure-html/vonhoedorff-1.png" width="672" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1"><span class="kw">ggplot</span>(athletes, <span class="kw">aes</span>(<span class="dt">x =</span> Ht, <span class="dt">y =</span> Wt, <span class="dt">shape =</span> Sport, <span class="dt">colour =</span> Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: The shape palette can deal with a maximum of 6 discrete values because more than 6 becomes difficult to discriminate; you have 10. Consider specifying
## shapes manually if you must have them.</code></pre>
<pre><code>## Warning: Removed 72 rows containing missing values (geom_point).</code></pre>
<p><img src="pasias_files/figure-html/schmit-1.png" width="672" /></p>
<p>Whatever plot you come up with, you can put height and weight on the
other axes, since neither one of them is uniquely a response variable.</p>
<p>Any of these graphs with warnings do the job, kind of, so they get 2 points.</p>
<p>One of the many well-thought-out things about <code>ggplot2</code> is that
making this graph was actually not difficult once you had figured out
that you also had <code>shape</code> and <code>size</code> at your
disposal. (In addition, <code>ggplot2</code> will help you make some
aesthetic decisions about which variable is distinguished by what kind
of thing. This will help you work towards a plot that doesn’t have any
warnings. These warnings are pretty clear about what not to do, and by
implication what you need to do instead. Colour, for example, is
always safe warning-wise.)</p>
<p>The model for this kind of graph that we saw is the plot of
probability (of preferring different brands of a product) as it depended
on age (two quantitative variables) for each brand and gender (two
categorical variables). I had three brands and two genders there, so I
used colour for brand and shape for gender, but it would have worked
about as well if I’d used shape for brand and colour for gender.</p>
<p>The warning message for <code>shape</code> contains the words ``specify
shapes manually if you must have them’’. I was wondering how you can
avoid that. Here’s how:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="kw">ggplot</span>(athletes, <span class="kw">aes</span>(<span class="dt">x =</span> Ht, <span class="dt">y =</span> Wt, <span class="dt">shape =</span> Sport, <span class="dt">colour =</span> Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb312-2" title="2"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/marklin-1.png" width="672" /></p>
<p>I agree with <code>ggplot2</code> that this many shapes are hard to tell
apart,<a href="#fn37" class="footnote-ref" id="fnref37"><sup>37</sup></a> but if you can figure this out,
you achieve the goal of producing a plot with no warnings, so you get
full marks. (We need 10 shapes because there are 10 different sports,
so we have to specify 10 different values in <code>values=</code>: any 10
different values will do. A list of the possible shapes is in
<a href="https://stackoverflow.com/questions/16813278/cycling-through-point-shapes-when-more-than-6-factor-levels">link</a>,
at the bottom. You can even use regular letters, but you have to refer
to them by numeric code:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1"><span class="kw">ggplot</span>(athletes, <span class="kw">aes</span>(<span class="dt">x =</span> Ht, <span class="dt">y =</span> Wt, <span class="dt">shape =</span> Sport, <span class="dt">colour =</span> Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb313-2" title="2"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">66</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">52</span>, <span class="dv">84</span>, <span class="dv">3</span>, <span class="dv">87</span>))</a></code></pre></div>
<p><img src="pasias_files/figure-html/stahillin-1.png" width="672" /></p>
<p>I had to find something for <code>TSprnt</code>, since all the letters
appeared to be taken.</p>
<p>On consideration, I like this last graph the best, because the letters
are more or less reminders of which sport each point is (they are
“mnemonic”, so you don’t have to look them up all the time, as with
colours or shapes: you can eventually remember which is which).</p>
<p>Whatever you come up with, expect: 3 marks if you get a plot with no
warnings, 2 marks if you get a plot with warnings, 1 mark if you get a
plot that would produce warnings but you don’t indicate that there are
warnings, either by saying so or by including the warnings in what you
hand in.</p>
<p>I didn’t ask you to interpret your plot (just getting it was enough
work), but there seems to be a common theme that, for sports played by
both genders, that the athletes are in about the same place relative
to the other ones in their gender (eg., the basketball players are
tall and heavy, the field athletes are really heavy but not very
tall), but male athletes are both taller and heavier than female
athletes playing the same sport. This consistency of pattern was
probably why the interaction was nowhere near significant: there are
additive separate effects of sport and of gender on the height-weight
combination.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="36">
<li id="fn36"><p>Like one of those crazy drinks at Starbucks.<a href="multivariate-analysis-of-variance.html#fnref36" class="footnote-back">↩</a></p></li>
<li id="fn37"><p>Having said that, the shapes are less anbiguous than the colours, because if you’re willing to study the legend, you can work out exactly which sport a shape belongs to, whereas the colours might be hard to tell apart at all.<a href="multivariate-analysis-of-variance.html#fnref37" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysis-of-covariance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repeated-measures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["pasias.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

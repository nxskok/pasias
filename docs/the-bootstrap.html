<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 17 The Bootstrap | Problems and Solutions in Applied Statistics" />
<meta property="og:type" content="book" />
<meta property="og:url" content="http://ritsokiguess.site/pasias" />

<meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
<meta name="github-repo" content="nxskok/pasias" />

<meta name="author" content="Ken Butler" />

<meta name="date" content="2019-01-07" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics">

<title>Chapter 17 The Bootstrap | Problems and Solutions in Applied Statistics</title>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="packages-used-somewhere-in-this-book.html#packages-used-somewhere-in-this-book"><span class="toc-section-number">2</span> Packages used somewhere in this book</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#getting-used-to-r-and-r-studio"><span class="toc-section-number">3</span> Getting used to R and R Studio</a>
<ul>
<li><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><span class="toc-section-number">3.1</span> Getting an R Studio Cloud account</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#getting-started"><span class="toc-section-number">3.2</span> Getting started</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><span class="toc-section-number">3.3</span> Reading data from a file</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#reading-files-different-ways"><span class="toc-section-number">3.4</span> Reading files different ways</a></li>
</ul></li>
<li><a href="reading-in-data-and-drawing-some-graphs.html#reading-in-data-and-drawing-some-graphs"><span class="toc-section-number">4</span> Reading in data and drawing some graphs</a>
<ul>
<li><a href="reading-in-data-and-drawing-some-graphs.html#orange-juice"><span class="toc-section-number">4.1</span> Orange juice</a></li>
<li><a href="reading-in-data-and-drawing-some-graphs.html#making-soap"><span class="toc-section-number">4.2</span> Making soap</a></li>
<li><a href="reading-in-data-and-drawing-some-graphs.html#handling-shipments"><span class="toc-section-number">4.3</span> Handling shipments</a></li>
</ul></li>
<li><a href="data-exploration.html#data-exploration"><span class="toc-section-number">5</span> Data exploration</a>
<ul>
<li><a href="data-exploration.html#north-carolina-births"><span class="toc-section-number">5.1</span> North Carolina births</a></li>
<li><a href="data-exploration.html#more-about-the-nc-births"><span class="toc-section-number">5.2</span> More about the NC births</a></li>
<li><a href="data-exploration.html#nenana-alaska"><span class="toc-section-number">5.3</span> Nenana, Alaska</a></li>
<li><a href="data-exploration.html#computerized-accounting"><span class="toc-section-number">5.4</span> Computerized accounting</a></li>
<li><a href="data-exploration.html#test-scores-in-two-classes"><span class="toc-section-number">5.5</span> Test scores in two classes</a></li>
</ul></li>
<li><a href="one-sample-inference.html#one-sample-inference"><span class="toc-section-number">6</span> One-sample inference</a>
<ul>
<li><a href="one-sample-inference.html#hunter-gatherers-in-australia"><span class="toc-section-number">6.1</span> Hunter-gatherers in Australia</a></li>
<li><a href="one-sample-inference.html#buses-to-boulder"><span class="toc-section-number">6.2</span> Buses to Boulder</a></li>
<li><a href="one-sample-inference.html#length-of-gestation-in-north-carolina"><span class="toc-section-number">6.3</span> Length of gestation in North Carolina</a></li>
<li><a href="one-sample-inference.html#inferring-ice-break-up-in-nenana"><span class="toc-section-number">6.4</span> Inferring ice break-up in Nenana</a></li>
</ul></li>
<li><a href="two-sample-inference.html#two-sample-inference"><span class="toc-section-number">7</span> Two-sample inference</a>
<ul>
<li><a href="two-sample-inference.html#children-and-electronic-devices"><span class="toc-section-number">7.1</span> Children and electronic devices</a></li>
<li><a href="two-sample-inference.html#parking-close-to-the-curb"><span class="toc-section-number">7.2</span> Parking close to the curb</a></li>
<li><a href="two-sample-inference.html#bell-peppers-and-too-much-water"><span class="toc-section-number">7.3</span> Bell peppers and too much water</a></li>
<li><a href="two-sample-inference.html#exercise-and-anxiety-and-bullying-mice"><span class="toc-section-number">7.4</span> Exercise and anxiety and bullying mice</a></li>
<li><a href="two-sample-inference.html#diet-and-growth-in-boys"><span class="toc-section-number">7.5</span> Diet and growth in boys</a></li>
</ul></li>
<li><a href="power-and-sample-size.html#power-and-sample-size"><span class="toc-section-number">8</span> Power and sample size</a>
<ul>
<li><a href="power-and-sample-size.html#simulating-power"><span class="toc-section-number">8.1</span> Simulating power</a></li>
<li><a href="power-and-sample-size.html#calculating-power-and-sample-size-for-estimating-mean"><span class="toc-section-number">8.2</span> Calculating power and sample size for estimating mean</a></li>
<li><a href="power-and-sample-size.html#simulating-power-for-proportions"><span class="toc-section-number">8.3</span> Simulating power for proportions</a></li>
</ul></li>
<li><a href="the-sign-test-and-moods-median-test.html#the-sign-test-and-moods-median-test"><span class="toc-section-number">9</span> The sign test and Moodâ€™s median test</a>
<ul>
<li><a href="the-sign-test-and-moods-median-test.html#running-a-maze"><span class="toc-section-number">9.1</span> Running a maze</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#chocolate-chips"><span class="toc-section-number">9.2</span> Chocolate chips</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#the-power-of-the-sign-test"><span class="toc-section-number">9.3</span> The power of the sign test</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#sugar-in-breakfast-cereals"><span class="toc-section-number">9.4</span> Sugar in breakfast cereals</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#fear-of-math"><span class="toc-section-number">9.5</span> Fear of math</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#medical-instructions"><span class="toc-section-number">9.6</span> Medical instructions</a></li>
</ul></li>
<li><a href="matched-pairs-t-and-sign-test.html#matched-pairs-t-and-sign-test"><span class="toc-section-number">10</span> Matched pairs t and sign test</a>
<ul>
<li><a href="matched-pairs-t-and-sign-test.html#measuring-body-fat"><span class="toc-section-number">10.1</span> Measuring body fat</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#throwing-baseballs-and-softballs"><span class="toc-section-number">10.2</span> Throwing baseballs and softballs</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#throwing-baseballs-and-softballs-again"><span class="toc-section-number">10.3</span> Throwing baseballs and softballs, again</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#changes-in-salary"><span class="toc-section-number">10.4</span> Changes in salary</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#body-fat-revisited"><span class="toc-section-number">10.5</span> Body fat revisited</a></li>
</ul></li>
<li><a href="normal-quantile-plots.html#normal-quantile-plots"><span class="toc-section-number">11</span> Normal quantile plots</a>
<ul>
<li><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><span class="toc-section-number">11.1</span> Lengths of heliconia flowers</a></li>
<li><a href="normal-quantile-plots.html#ferritin-and-normality"><span class="toc-section-number">11.2</span> Ferritin and normality</a></li>
</ul></li>
<li><a href="analysis-of-variance.html#analysis-of-variance"><span class="toc-section-number">12</span> Analysis of variance</a>
<ul>
<li><a href="analysis-of-variance.html#movie-ratings-and-lengths"><span class="toc-section-number">12.1</span> Movie ratings and lengths</a></li>
<li><a href="analysis-of-variance.html#deer-and-how-much-they-eat"><span class="toc-section-number">12.2</span> Deer and how much they eat</a></li>
<li><a href="analysis-of-variance.html#movie-ratings-again"><span class="toc-section-number">12.3</span> Movie ratings again</a></li>
<li><a href="analysis-of-variance.html#atomic-weight-of-carbon"><span class="toc-section-number">12.4</span> Atomic weight of carbon</a></li>
<li><a href="analysis-of-variance.html#can-caffeine-improve-your-performance-on-a-test"><span class="toc-section-number">12.5</span> Can caffeine improve your performance on a test?</a></li>
</ul></li>
<li><a href="tidying-and-selecting-data.html#tidying-and-selecting-data"><span class="toc-section-number">13</span> Tidying and selecting data</a>
<ul>
<li><a href="tidying-and-selecting-data.html#tidying-the-jays-data"><span class="toc-section-number">13.1</span> Tidying the Jays data</a></li>
<li><a href="tidying-and-selecting-data.html#baseball-and-softball-spaghetti"><span class="toc-section-number">13.2</span> Baseball and softball spaghetti</a></li>
<li><a href="tidying-and-selecting-data.html#ethanol-and-sleep-time-in-rats"><span class="toc-section-number">13.3</span> Ethanol and sleep time in rats</a></li>
<li><a href="tidying-and-selecting-data.html#growth-of-tomatoes"><span class="toc-section-number">13.4</span> Growth of tomatoes</a></li>
<li><a href="tidying-and-selecting-data.html#pain-relief-in-migraine-headaches-again"><span class="toc-section-number">13.5</span> Pain relief in migraine headaches (again)</a></li>
<li><a href="tidying-and-selecting-data.html#location-species-and-disease-in-plants"><span class="toc-section-number">13.6</span> Location, species and disease in plants</a></li>
<li><a href="tidying-and-selecting-data.html#mating-songs-in-crickets"><span class="toc-section-number">13.7</span> Mating songs in crickets</a></li>
<li><a href="tidying-and-selecting-data.html#cars"><span class="toc-section-number">13.8</span> Cars</a></li>
<li><a href="tidying-and-selecting-data.html#number-1-songs"><span class="toc-section-number">13.9</span> Number 1 songs</a></li>
<li><a href="tidying-and-selecting-data.html#bikes-on-college"><span class="toc-section-number">13.10</span> Bikes on College</a></li>
<li><a href="tidying-and-selecting-data.html#feeling-the-heat"><span class="toc-section-number">13.11</span> Feeling the heat</a></li>
</ul></li>
<li><a href="regression.html#regression"><span class="toc-section-number">14</span> Regression</a>
<ul>
<li><a href="regression.html#rainfall-in-california"><span class="toc-section-number">14.1</span> Rainfall in California</a></li>
<li><a href="regression.html#carbon-monoxide-in-cigarettes"><span class="toc-section-number">14.2</span> Carbon monoxide in cigarettes</a></li>
<li><a href="regression.html#maximal-oxygen-uptake-in-young-boys"><span class="toc-section-number">14.3</span> Maximal oxygen uptake in young boys</a></li>
<li><a href="regression.html#facebook-friends-and-grey-matter"><span class="toc-section-number">14.4</span> Facebook friends and grey matter</a></li>
<li><a href="regression.html#endogenous-nitrogen-excretion-in-carp"><span class="toc-section-number">14.5</span> Endogenous nitrogen excretion in carp</a></li>
<li><a href="regression.html#sparrowhawks"><span class="toc-section-number">14.6</span> Sparrowhawks</a></li>
<li><a href="regression.html#salaries-of-social-workers"><span class="toc-section-number">14.7</span> Salaries of social workers</a></li>
<li><a href="regression.html#predicting-volume-of-wood-in-pine-trees"><span class="toc-section-number">14.8</span> Predicting volume of wood in pine trees</a></li>
<li><a href="regression.html#tortoise-shells-and-eggs"><span class="toc-section-number">14.9</span> Tortoise shells and eggs</a></li>
<li><a href="regression.html#crickets-revisited"><span class="toc-section-number">14.10</span> Crickets revisited</a></li>
<li><a href="regression.html#roller-coasters"><span class="toc-section-number">14.11</span> Roller coasters</a></li>
<li><a href="regression.html#running-and-blood-sugar"><span class="toc-section-number">14.12</span> Running and blood sugar</a></li>
<li><a href="regression.html#calories-and-fat-in-pizza"><span class="toc-section-number">14.13</span> Calories and fat in pizza</a></li>
<li><a href="regression.html#where-should-the-fire-stations-be"><span class="toc-section-number">14.14</span> Where should the fire stations be?</a></li>
<li><a href="regression.html#being-satisfied-with-hospital"><span class="toc-section-number">14.15</span> Being satisfied with hospital</a></li>
<li><a href="regression.html#handling-shipments-of-chemicals"><span class="toc-section-number">14.16</span> Handling shipments of chemicals</a></li>
<li><a href="regression.html#salaries-of-mathematicians"><span class="toc-section-number">14.17</span> Salaries of mathematicians</a></li>
<li><a href="regression.html#predicting-gpa-of-computer-science-students"><span class="toc-section-number">14.18</span> Predicting GPA of computer science students</a></li>
</ul></li>
<li><a href="dates-and-times.html#dates-and-times"><span class="toc-section-number">15</span> Dates and times</a>
<ul>
<li><a href="dates-and-times.html#dealing-with-dates-in-the-worcester-heart-attack-study"><span class="toc-section-number">15.1</span> Dealing with dates in the Worcester Heart Attack study</a></li>
<li><a href="dates-and-times.html#growth-of-mizuna-lettuce-seeds"><span class="toc-section-number">15.2</span> Growth of Mizuna lettuce seeds</a></li>
<li><a href="dates-and-times.html#types-of-childbirth"><span class="toc-section-number">15.3</span> Types of childbirth</a></li>
<li><a href="dates-and-times.html#wolves-and-caribou"><span class="toc-section-number">15.4</span> Wolves and caribou</a></li>
</ul></li>
<li><a href="functions.html#functions"><span class="toc-section-number">16</span> Functions</a>
<ul>
<li><a href="functions.html#making-some-r-functions"><span class="toc-section-number">16.1</span> Making some R functions</a></li>
<li><a href="functions.html#the-collatz-sequence"><span class="toc-section-number">16.2</span> The Collatz sequence</a></li>
</ul></li>
<li><a href="the-bootstrap.html#the-bootstrap"><span class="toc-section-number">17</span> The Bootstrap</a>
<ul>
<li><a href="the-bootstrap.html#air-conditioning-failures"><span class="toc-section-number">17.1</span> Air conditioning failures</a></li>
<li><a href="the-bootstrap.html#air-conditioning-failures-bootstrapping-the-median"><span class="toc-section-number">17.2</span> Air conditioning failures: bootstrapping the median</a></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression"><span class="toc-section-number">18</span> Logistic regression</a>
<ul>
<li><a href="logistic-regression.html#finding-wolf-spiders-on-the-beach"><span class="toc-section-number">18.1</span> Finding wolf spiders on the beach</a></li>
<li><a href="logistic-regression.html#killing-aphids"><span class="toc-section-number">18.2</span> Killing aphids</a></li>
<li><a href="logistic-regression.html#the-effects-of-substance-a"><span class="toc-section-number">18.3</span> The effects of Substance A</a></li>
<li><a href="logistic-regression.html#what-makes-an-animal-get-infected"><span class="toc-section-number">18.4</span> What makes an animal get infected?</a></li>
<li><a href="logistic-regression.html#the-brain-of-a-cat"><span class="toc-section-number">18.5</span> The brain of a cat</a></li>
<li><a href="logistic-regression.html#how-not-to-get-heart-disease"><span class="toc-section-number">18.6</span> How not to get heart disease</a></li>
<li><a href="logistic-regression.html#successful-breastfeeding"><span class="toc-section-number">18.7</span> Successful breastfeeding</a></li>
<li><a href="logistic-regression.html#making-it-over-the-mountains"><span class="toc-section-number">18.8</span> Making it over the mountains</a></li>
<li><a href="logistic-regression.html#who-needs-the-most-intensive-care"><span class="toc-section-number">18.9</span> Who needs the most intensive care?</a></li>
<li><a href="logistic-regression.html#go-away-and-dont-come-back"><span class="toc-section-number">18.10</span> Go away and donâ€™t come back!</a></li>
</ul></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#logistic-regression-with-ordinal-or-nominal-response"><span class="toc-section-number">19</span> Logistic regression with ordinal or nominal response</a>
<ul>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#do-you-like-your-mobile-phone"><span class="toc-section-number">19.1</span> Do you like your mobile phone?</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#attitudes-towards-abortion"><span class="toc-section-number">19.2</span> Attitudes towards abortion</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#finding-non-missing-values"><span class="toc-section-number">19.3</span> Finding non-missing values</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#european-social-survey-and-voting"><span class="toc-section-number">19.4</span> European Social Survey and voting</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#alligator-food"><span class="toc-section-number">19.5</span> Alligator food</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#how-do-you-like-your-steak-the-data"><span class="toc-section-number">19.6</span> How do you like your steak â€“ the data</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#crimes-in-san-francisco-the-data"><span class="toc-section-number">19.7</span> Crimes in San Francisco â€“ the data</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#how-do-you-like-your-steak"><span class="toc-section-number">19.8</span> How do you like your steak?</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#crimes-in-san-francisco"><span class="toc-section-number">19.9</span> Crimes in San Francisco</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#high-school-and-beyond"><span class="toc-section-number">19.10</span> High School and Beyond</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#what-sports-do-these-athletes-play"><span class="toc-section-number">19.11</span> What sports do these athletes play?</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis"><span class="toc-section-number">20</span> Survival analysis</a>
<ul>
<li><a href="survival-analysis.html#the-worcester-survey"><span class="toc-section-number">20.1</span> The Worcester survey</a></li>
<li><a href="survival-analysis.html#drug-treatment-programs"><span class="toc-section-number">20.2</span> Drug treatment programs</a></li>
<li><a href="survival-analysis.html#multiple-myeloma"><span class="toc-section-number">20.3</span> Multiple myeloma</a></li>
<li><a href="survival-analysis.html#ovarian-cancer"><span class="toc-section-number">20.4</span> Ovarian cancer</a></li>
</ul></li>
<li><a href="analysis-of-variance-revisited.html#analysis-of-variance-revisited"><span class="toc-section-number">21</span> Analysis of variance revisited</a>
<ul>
<li><a href="analysis-of-variance-revisited.html#acid-rain"><span class="toc-section-number">21.1</span> Acid rain</a></li>
<li><a href="analysis-of-variance-revisited.html#treating-hay-fever"><span class="toc-section-number">21.2</span> Treating hay fever</a></li>
<li><a href="analysis-of-variance-revisited.html#focused-comparisons-of-the-effect-of-caffeine"><span class="toc-section-number">21.3</span> Focused comparisons of the effect of caffeine</a></li>
<li><a href="analysis-of-variance-revisited.html#who-studies-the-most-outside-class"><span class="toc-section-number">21.4</span> Who studies the most outside class?</a></li>
<li><a href="analysis-of-variance-revisited.html#mental-context"><span class="toc-section-number">21.5</span> Mental context</a></li>
<li><a href="analysis-of-variance-revisited.html#trying-on-shirts"><span class="toc-section-number">21.6</span> Trying on shirts</a></li>
<li><a href="analysis-of-variance-revisited.html#productivity-and-research-and-development"><span class="toc-section-number">21.7</span> Productivity and research-and-development</a></li>
<li><a href="analysis-of-variance-revisited.html#treating-leprosy"><span class="toc-section-number">21.8</span> Treating leprosy</a></li>
</ul></li>
<li><a href="multivariate-analysis-of-variance.html#multivariate-analysis-of-variance"><span class="toc-section-number">22</span> Multivariate analysis of variance</a>
<ul>
<li><a href="multivariate-analysis-of-variance.html#fabricated-data"><span class="toc-section-number">22.1</span> Fabricated data</a></li>
<li><a href="multivariate-analysis-of-variance.html#do-characteristics-of-urine-depend-on-obesity"><span class="toc-section-number">22.2</span> Do characteristics of urine depend on obesity?</a></li>
<li><a href="multivariate-analysis-of-variance.html#how-do-height-and-weight-depend-on-sport-played-by-elite-athletes"><span class="toc-section-number">22.3</span> How do height and weight depend on sport played by elite athletes?</a></li>
</ul></li>
<li><a href="repeated-measures.html#repeated-measures"><span class="toc-section-number">23</span> Repeated measures</a>
<ul>
<li><a href="repeated-measures.html#effect-of-drug-on-rat-weight"><span class="toc-section-number">23.1</span> Effect of drug on rat weight</a></li>
<li><a href="repeated-measures.html#social-interaction-among-old-people"><span class="toc-section-number">23.2</span> Social interaction among old people</a></li>
<li><a href="repeated-measures.html#childrens-stress-levels-and-airports"><span class="toc-section-number">23.3</span> Childrenâ€™s stress levels and airports</a></li>
<li><a href="repeated-measures.html#body-fat-as-repeated-measures"><span class="toc-section-number">23.4</span> Body fat as repeated measures</a></li>
<li><a href="repeated-measures.html#investigating-motor-activity-in-rats"><span class="toc-section-number">23.5</span> Investigating motor activity in rats</a></li>
<li><a href="repeated-measures.html#repeated-measures-with-no-background"><span class="toc-section-number">23.6</span> Repeated measures with no background</a></li>
</ul></li>
<li><a href="discriminant-analysis.html#discriminant-analysis"><span class="toc-section-number">24</span> Discriminant analysis</a>
<ul>
<li><a href="discriminant-analysis.html#telling-whether-a-banknote-is-real-or-counterfeit"><span class="toc-section-number">24.1</span> Telling whether a banknote is real or counterfeit</a></li>
<li><a href="discriminant-analysis.html#urine-and-obesity-what-makes-a-difference"><span class="toc-section-number">24.2</span> Urine and obesity: what makes a difference?</a></li>
<li><a href="discriminant-analysis.html#understanding-a-manova"><span class="toc-section-number">24.3</span> Understanding a MANOVA</a></li>
<li><a href="discriminant-analysis.html#what-distinguishes-people-who-do-different-jobs"><span class="toc-section-number">24.4</span> What distinguishes people who do different jobs?</a></li>
<li><a href="discriminant-analysis.html#observing-children-with-adhd"><span class="toc-section-number">24.5</span> Observing children with ADHD</a></li>
<li><a href="discriminant-analysis.html#growing-corn"><span class="toc-section-number">24.6</span> Growing corn</a></li>
<li><a href="discriminant-analysis.html#understanding-athletes-height-weight-sport-and-gender"><span class="toc-section-number">24.7</span> Understanding athletesâ€™ height, weight, sport and gender</a></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis"><span class="toc-section-number">25</span> Cluster analysis</a>
<ul>
<li><a href="cluster-analysis.html#sites-on-the-sea-bed"><span class="toc-section-number">25.1</span> Sites on the sea bed</a></li>
<li><a href="cluster-analysis.html#dissimilarities-between-fruits"><span class="toc-section-number">25.2</span> Dissimilarities between fruits</a></li>
<li><a href="cluster-analysis.html#similarity-of-species"><span class="toc-section-number">25.3</span> Similarity of species</a></li>
<li><a href="cluster-analysis.html#rating-beer"><span class="toc-section-number">25.4</span> Rating beer</a></li>
<li><a href="cluster-analysis.html#clustering-the-swiss-bills"><span class="toc-section-number">25.5</span> Clustering the Swiss bills</a></li>
<li><a href="cluster-analysis.html#grouping-similar-cars"><span class="toc-section-number">25.6</span> Grouping similar cars</a></li>
<li><a href="cluster-analysis.html#running-jumping-and-throwing"><span class="toc-section-number">25.7</span> Running, jumping, and throwing</a></li>
<li><a href="cluster-analysis.html#bridges-in-pittsburgh"><span class="toc-section-number">25.8</span> Bridges in Pittsburgh</a></li>
<li><a href="cluster-analysis.html#clustering-the-australian-athletes"><span class="toc-section-number">25.9</span> Clustering the Australian athletes</a></li>
</ul></li>
<li><a href="multidimensional-scaling.html#multidimensional-scaling"><span class="toc-section-number">26</span> Multidimensional Scaling</a>
<ul>
<li><a href="multidimensional-scaling.html#making-a-map-of-wisconsin"><span class="toc-section-number">26.1</span> Making a map of Wisconsin</a></li>
<li><a href="multidimensional-scaling.html#things-that-feel-similar-to-each-other"><span class="toc-section-number">26.2</span> Things that feel similar to each other</a></li>
<li><a href="multidimensional-scaling.html#confusing-letters"><span class="toc-section-number">26.3</span> Confusing letters</a></li>
<li><a href="multidimensional-scaling.html#more-beer-please"><span class="toc-section-number">26.4</span> More beer please</a></li>
<li><a href="multidimensional-scaling.html#feeling-similar-again"><span class="toc-section-number">26.5</span> Feeling similar, again</a></li>
</ul></li>
<li><a href="principal-components-and-factor-analysis.html#principal-components-and-factor-analysis"><span class="toc-section-number">27</span> Principal Components and Factor Analysis</a>
<ul>
<li><a href="principal-components-and-factor-analysis.html#the-weather-somewhere"><span class="toc-section-number">27.1</span> The weather, somewhere</a></li>
<li><a href="principal-components-and-factor-analysis.html#air-pollution"><span class="toc-section-number">27.2</span> Air pollution</a></li>
<li><a href="principal-components-and-factor-analysis.html#a-correlation-matrix"><span class="toc-section-number">27.3</span> A correlation matrix</a></li>
<li><a href="principal-components-and-factor-analysis.html#the-interpersonal-circumplex"><span class="toc-section-number">27.4</span> The Interpersonal Circumplex</a></li>
</ul></li>
<li><a href="frequency-table-analysis.html#frequency-table-analysis"><span class="toc-section-number">28</span> Frequency table analysis</a>
<ul>
<li><a href="frequency-table-analysis.html#college-plans"><span class="toc-section-number">28.1</span> College plans</a></li>
<li><a href="frequency-table-analysis.html#predicting-voting"><span class="toc-section-number">28.2</span> Predicting voting</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="the-bootstrap" class="section level1" number="17">
<h1><span class="header-section-number">Chapter 17</span> The Bootstrap</h1>
<p>Packages for this chapter:</p>
<div class="sourceCode" id="cb1856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1856-1"><a href="the-bootstrap.html#cb1856-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1856-2"><a href="the-bootstrap.html#cb1856-2"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<div id="air-conditioning-failures" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> Air conditioning failures</h2>
<p>Back in 1963, there was a report on failures in
air-conditioning equipment in

aircraft. For one aircraft, the air-conditioning equipment failed 12
times, and the number of hours it ran before failing each time was
recorded. The data are in
<a href="https://raw.githubusercontent.com/nxskok/pasias/master/air_conditioning.csv">link</a>. Boeing
was interested in the mean failure time, because the company wanted to
plan for engineers to fix the failures (and thus needed to estimate a
failure <em>rate</em>).</p>
<p>There is randomization here. Your answers will differ slightly from
mine, unless you throw in this before you start (or at least before
you generate your first random numbers).</p>
<div class="sourceCode" id="cb1857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1857-1"><a href="the-bootstrap.html#cb1857-1"></a><span class="kw">set.seed</span>(<span class="dv">457299</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Read in the data, and observe that you have the correct number
of rows. (Note that the failure times are in ascending order).</li>
</ol>
<p>Solution</p>
<p>This is a <code>.csv</code> so <code>read_csv</code> is the thing:</p>
<div class="sourceCode" id="cb1858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1858-1"><a href="the-bootstrap.html#cb1858-1"></a>my_url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nxskok/pasias/master/air_conditioning.csv&quot;</span></span>
<span id="cb1858-2"><a href="the-bootstrap.html#cb1858-2"></a>aircon &lt;-<span class="st"> </span><span class="kw">read_csv</span>(my_url)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   failure = col_double(),
##   hours = col_double()
## )</code></pre>
<div class="sourceCode" id="cb1860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1860-1"><a href="the-bootstrap.html#cb1860-1"></a>aircon</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    failure hours
##      &lt;dbl&gt; &lt;dbl&gt;
##  1       1     3
##  2       2     5
##  3       3     7
##  4       4    18
##  5       5    43
##  6       6    85
##  7       7    91
##  8       8    98
##  9       9   100
## 10      10   130
## 11      11   230
## 12      12   487</code></pre>
<p>Twelve rows (12 failure times).</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>What do you notice about the <em>shape</em> of the distribution of failure times? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>Make a suitable graph. The obvious one is a histogram:</p>
<div class="sourceCode" id="cb1862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1862-1"><a href="the-bootstrap.html#cb1862-1"></a><span class="kw">ggplot</span>(aircon, <span class="kw">aes</span>(<span class="dt">x =</span> hours)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">7</span>)</span></code></pre></div>
<p><img src="26-bootstrap_files/figure-html/unnamed-chunk-6-1.png" width="672"  /></p>
<p>Youâ€™ll have to play with the number of bins (there are only 12 observations). I got 7 from the Freedman-Diaconis rule:</p>
<div class="sourceCode" id="cb1863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1863-1"><a href="the-bootstrap.html#cb1863-1"></a><span class="kw">nclass.FD</span>(aircon<span class="op">$</span>hours)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>I was a little suspicious that the data would not be much like normal (I have run into failure times before), so I kept away from the Sturges rule.</p>
<p>Another possibility is a one-group boxplot:</p>
<div class="sourceCode" id="cb1865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1865-1"><a href="the-bootstrap.html#cb1865-1"></a><span class="kw">ggplot</span>(aircon, <span class="kw">aes</span>(<span class="dt">y =</span> hours, <span class="dt">x =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="26-bootstrap_files/figure-html/unnamed-chunk-8-1.png" width="672"  /></p>
<p>If you like, you can do a normal quantile plot. I rank that third here, because there is nothing immediately implying a comparison with the <em>normal</em> distribution, but I would accept it:</p>
<div class="sourceCode" id="cb1866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1866-1"><a href="the-bootstrap.html#cb1866-1"></a><span class="kw">ggplot</span>(aircon, <span class="kw">aes</span>(<span class="dt">sample =</span> hours)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>()</span></code></pre></div>
<p><img src="26-bootstrap_files/figure-html/unnamed-chunk-9-1.png" width="672"  /></p>
<p>Pick a visual and defend it.</p>
<p>All three of these graphs are showing a strong skewness to the right.</p>
<p>Extra: this is probably not a surprise, because a time until failure
cannot be less than zero, and distributions with a limit tend to be
skewed away from that limit. (If you look back at the data, there are
some very small failure times, but there are also some very big
ones. The very small ones are saying that the lower limit matters.) If
you were modelling these times until failure, you might use a
distribution like the exponential or gamma or Weibull.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Obtain the means of 1000 bootstrap samples (that is, samples from the data with replacement). Save them.</li>
</ol>
<p>Solution</p>
<p>Something like this, therefore:</p>
<div class="sourceCode" id="cb1867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1867-1"><a href="the-bootstrap.html#cb1867-1"></a><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">sample</span>(aircon<span class="op">$</span>hours, <span class="dt">replace =</span> T)) <span class="op">%&gt;%</span></span>
<span id="cb1867-2"><a href="the-bootstrap.html#cb1867-2"></a><span class="st">  </span><span class="kw">map_dbl</span>(<span class="op">~</span><span class="st"> </span><span class="kw">mean</span>(.)) -&gt;<span class="st"> </span>means</span></code></pre></div>
<p>I often start with <code>rerun(1000)</code>, closing the bracket, and then wonder
why it doesnâ€™t work. In the <code>rerun</code>, you have to say two things: how
many times to rerun, and <em>what</em> to rerun. So donâ€™t close the bracket
on the <code>rerun</code> until youâ€™ve done that.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Make a normal quantile plot of your bootstrap distribution. What do you see? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>This:</p>
<div class="sourceCode" id="cb1868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1868-1"><a href="the-bootstrap.html#cb1868-1"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(means), <span class="kw">aes</span>(<span class="dt">sample =</span> means)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>()</span></code></pre></div>
<p><img src="26-bootstrap_files/figure-html/unnamed-chunk-11-1.png" width="672"  /></p>
<p>This is still skewed to the right (it has a curved shape, or, the low values and the high values are both too high compared to the normal).</p>
<p>Extra: this is less skewed than the original data was, because, with a
sample size of 12, we have a <em>little</em> help from the Central Limit
Theorem, but not much. This picture is the one that has to be normal
enough for <span class="math inline">\(t\)</span> procedures to work, and it is not. This comes back into
the picture when we compare our confidence intervals later.</p>
<p>Also, it makes sense to see how <em>normal</em> a sampling distribution of a
mean is, so a normal quantile plot would be my first choice for this.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Obtain the 95% bootstrap percentile confidence interval for the mean.</li>
</ol>
<p>Solution</p>
<p>This is the 2.5 and 97.5 percentiles of the bootstrapped sampling distribution of the mean:</p>
<div class="sourceCode" id="cb1869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1869-1"><a href="the-bootstrap.html#cb1869-1"></a><span class="kw">quantile</span>(means, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
##  47.05625 187.93333</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>Obtain the 95% bootstrap-<span class="math inline">\(t\)</span> confidence interval for
the mean, and compare your two intervals.</li>
</ol>
<p>Solution</p>
<p>The key is to remember that the original sample (and thus each bootstrap sample) had <span class="math inline">\(n=12\)</span>, so there are <span class="math inline">\(12-1=11\)</span> df. (The fact that there were 1000 bootstrap samples is neither here nor there). This is how I like to do it:</p>
<div class="sourceCode" id="cb1871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1871-1"><a href="the-bootstrap.html#cb1871-1"></a>t_star &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dv">11</span>)</span>
<span id="cb1871-2"><a href="the-bootstrap.html#cb1871-2"></a>t_star</span></code></pre></div>
<pre><code>## [1] 2.200985</code></pre>
<div class="sourceCode" id="cb1873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1873-1"><a href="the-bootstrap.html#cb1873-1"></a><span class="kw">mean</span>(means) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>t_star <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(means)</span></code></pre></div>
<pre><code>## [1]  25.33401 186.81249</code></pre>
<p>The <code>c(-1, 1)</code> thing is the calculation version of the <span class="math inline">\(\pm\)</span>,
and gets both limits at once. Pull the above apart to see how it works. If
you donâ€™t like that, you might prefer something like this:</p>
<div class="sourceCode" id="cb1875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1875-1"><a href="the-bootstrap.html#cb1875-1"></a>mean &lt;-<span class="st"> </span><span class="kw">mean</span>(means)</span>
<span id="cb1875-2"><a href="the-bootstrap.html#cb1875-2"></a>sd &lt;-<span class="st"> </span><span class="kw">sd</span>(means)</span>
<span id="cb1875-3"><a href="the-bootstrap.html#cb1875-3"></a>margin &lt;-<span class="st"> </span>t_star <span class="op">*</span><span class="st"> </span>sd</span>
<span id="cb1875-4"><a href="the-bootstrap.html#cb1875-4"></a>mean <span class="op">-</span><span class="st"> </span>margin</span></code></pre></div>
<pre><code>## [1] 25.33401</code></pre>
<div class="sourceCode" id="cb1877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1877-1"><a href="the-bootstrap.html#cb1877-1"></a>mean <span class="op">+</span><span class="st"> </span>margin</span></code></pre></div>
<pre><code>## [1] 186.8125</code></pre>
<p>I apologize for the crazy first line of that!
As for comparison: the bootstrap-<span class="math inline">\(t\)</span> interval goes down a lot further,
though the upper limits are quite similar (on this scale). Both
intervals are very long and donâ€™t tell us much about the population
mean time to failure, which is not very surprising given the small
sample size (<span class="math inline">\(n=12\)</span>) and the large variability in the data.</p>
<p>Extra: the non-normality of the bootstrap (sampling) distribution says that we should definitely not trust the bootstrap-<span class="math inline">\(t\)</span>, and probably not the bootstrap percentile interval either. Which brings us to the next part.</p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Obtain the BCa 95% confidence interval for the mean.</li>
</ol>
<p>Solution</p>
<p>This means (possibly) installing and (certainly) loading the <code>bootstrap</code> package, and then:</p>
<div class="sourceCode" id="cb1879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1879-1"><a href="the-bootstrap.html#cb1879-1"></a>theta &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1879-2"><a href="the-bootstrap.html#cb1879-2"></a>  <span class="kw">mean</span>(x)</span>
<span id="cb1879-3"><a href="the-bootstrap.html#cb1879-3"></a>}</span>
<span id="cb1879-4"><a href="the-bootstrap.html#cb1879-4"></a>bca_all &lt;-<span class="st"> </span><span class="kw">with</span>(aircon, <span class="kw">bcanon</span>(hours, <span class="dv">1000</span>, theta))</span>
<span id="cb1879-5"><a href="the-bootstrap.html#cb1879-5"></a>bca &lt;-<span class="st"> </span>bca_all<span class="op">$</span>confpoints</span>
<span id="cb1879-6"><a href="the-bootstrap.html#cb1879-6"></a>bca</span></code></pre></div>
<pre><code>##      alpha bca point
## [1,] 0.025  55.58333
## [2,] 0.050  61.25000
## [3,] 0.100  70.66667
## [4,] 0.160  78.50000
## [5,] 0.840 160.66667
## [6,] 0.900 178.50000
## [7,] 0.950 204.25000
## [8,] 0.975 228.75000</code></pre>
<p>Pull out the ones from this that you need: the top one and the bottom one, to get an interval of 55.6
to 228.8.</p>
<p>I seem to need to define the function <code>theta</code> first and pass it into <code>bcanon</code> as the third input. You may have more luck with <code>bcanon(hours, 1000, mean)</code> than I did. Try it.</p>
<p>Or, if you feel like some extra coding: turn this matrix into a data frame, grab the rows you want, and then the column you want:</p>
<div class="sourceCode" id="cb1881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1881-1"><a href="the-bootstrap.html#cb1881-1"></a>bca <span class="op">%&gt;%</span></span>
<span id="cb1881-2"><a href="the-bootstrap.html#cb1881-2"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></span>
<span id="cb1881-3"><a href="the-bootstrap.html#cb1881-3"></a><span class="st">  </span><span class="kw">filter</span>(alpha <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) <span class="op">%&gt;%</span></span>
<span id="cb1881-4"><a href="the-bootstrap.html#cb1881-4"></a><span class="st">  </span><span class="kw">pull</span>(<span class="st">`</span><span class="dt">bca point</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## [1]  55.58333 228.75000</code></pre>
<ol start="8" style="list-style-type: lower-alpha">
<li>Compare the BCa confidence interval with the other ones. Which one would you recommend? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>In this example, the bootstrap-<span class="math inline">\(t\)</span> and percentile intervals are very different, so we should use neither of them, and prefer the BCa interval.</p>
<p>Extra: as usual in this kind of case, the BCa contains values for the mean pulled out into the long tail, but thatâ€™s a proper adjustment for the sampling distribution being skewed.</p>
</div>
<div id="air-conditioning-failures-bootstrapping-the-median" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> Air conditioning failures: bootstrapping the median</h2>
<p>With a skewed data distribution such as the air-conditioning
failure times, we might be interested in inference for the median. One
way to get a confidence interval for the median is to invert the sign
test, as in <code>smmr</code>, but another way is to obtain a bootstrap
sampling distribution for the median. How do these approaches compare
for the air-conditioning data? We explore this here.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the air-conditioning data again (if you donâ€™t already
have it lying around). The link is in the previous question.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb1883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1883-1"><a href="the-bootstrap.html#cb1883-1"></a>my_url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nxskok/pasias/master/air_conditioning.csv&quot;</span></span>
<span id="cb1883-2"><a href="the-bootstrap.html#cb1883-2"></a>aircon &lt;-<span class="st"> </span><span class="kw">read_csv</span>(my_url)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   failure = col_double(),
##   hours = col_double()
## )</code></pre>
<div class="sourceCode" id="cb1885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1885-1"><a href="the-bootstrap.html#cb1885-1"></a>aircon</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    failure hours
##      &lt;dbl&gt; &lt;dbl&gt;
##  1       1     3
##  2       2     5
##  3       3     7
##  4       4    18
##  5       5    43
##  6       6    85
##  7       7    91
##  8       8    98
##  9       9   100
## 10      10   130
## 11      11   230
## 12      12   487</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Use <code>smmr</code> to get a confidence interval for the median (based on the sign test).</li>
</ol>
<p>Solution</p>
<p>Input to <code>ci_median</code> is data frame and column:</p>
<div class="sourceCode" id="cb1887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1887-1"><a href="the-bootstrap.html#cb1887-1"></a><span class="kw">ci_median</span>(aircon, hours)</span></code></pre></div>
<pre><code>## [1]   7.002319 129.998291</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Obtain the bootstrap distribution of the sample median. Make a normal quantile plot of it. What do you notice? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The usual do-it-yourself bootstrap:</p>
<div class="sourceCode" id="cb1889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1889-1"><a href="the-bootstrap.html#cb1889-1"></a><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">sample</span>(aircon<span class="op">$</span>hours, <span class="dt">replace =</span> T)) <span class="op">%&gt;%</span></span>
<span id="cb1889-2"><a href="the-bootstrap.html#cb1889-2"></a><span class="st">  </span><span class="kw">map_dbl</span>(<span class="op">~</span><span class="st"> </span><span class="kw">median</span>(.)) -&gt;<span class="st"> </span>medians</span></code></pre></div>
<p>I actually copied and pasted my code from the previous problem, changing <code>mean</code> to <code>median</code>.</p>
<p>As for a plot, well, this:</p>
<div class="sourceCode" id="cb1890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1890-1"><a href="the-bootstrap.html#cb1890-1"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(medians), <span class="kw">aes</span>(<span class="dt">sample =</span> medians)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>()</span></code></pre></div>
<p><img src="26-bootstrap_files/figure-html/unnamed-chunk-20-1.png" width="672"  /></p>
<p>Not only does this not look very normal, but also there are those
curious horizontal patches of points (that, you might recall, are
characteristic of a discrete distribution). This has happened because
there are only a few possible medians: the median has to be either a
data value or halfway between two data values, so there are only
something like <span class="math inline">\(2(12)-1=23\)</span> different possible medians, with the ones
in the middle being more likely.</p>
<p>This also shows up on a histogram, but only if you have enough
bins. (If you donâ€™t have enough bins, some of the neighbouring
possible values end up in the same bin; here, the aim is to have
enough bins to show the discreteness, rather than the usual thing of
having few enough bins to show the shape.)</p>
<div class="sourceCode" id="cb1891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1891-1"><a href="the-bootstrap.html#cb1891-1"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(medians), <span class="kw">aes</span>(<span class="dt">x =</span> medians)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="26-bootstrap_files/figure-html/unnamed-chunk-21-1.png" width="672"  /></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Obtain a 95% bootstrap percentile confidence interval for the median. How does it compare with the one you obtained earlier?</li>
</ol>
<p>Solution</p>
<p>Also, the usual:</p>
<div class="sourceCode" id="cb1892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1892-1"><a href="the-bootstrap.html#cb1892-1"></a><span class="kw">quantile</span>(medians, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##  2.5% 97.5% 
##  12.5 115.0</code></pre>
<p>This goes down and up not quite so far as the interval from <code>smmr</code>. That might be because the <code>smmr</code> interval is too wide (based on a not-very-powerful test), or because the bootstrap quantile interval is too narrow (as it usually is). Itâ€™s hard to tell which it is.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Obtain a 95% BCa interval. Compare it with the two other intervals you found.</li>
</ol>
<p>Solution</p>
<p>Yet more copying and pasting (from the previous question):</p>
<div class="sourceCode" id="cb1894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1894-1"><a href="the-bootstrap.html#cb1894-1"></a>theta &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1894-2"><a href="the-bootstrap.html#cb1894-2"></a>  <span class="kw">median</span>(x)</span>
<span id="cb1894-3"><a href="the-bootstrap.html#cb1894-3"></a>}</span>
<span id="cb1894-4"><a href="the-bootstrap.html#cb1894-4"></a>bca_all &lt;-<span class="st"> </span><span class="kw">with</span>(aircon, <span class="kw">bcanon</span>(hours, <span class="dv">1000</span>, theta))</span>
<span id="cb1894-5"><a href="the-bootstrap.html#cb1894-5"></a>bca &lt;-<span class="st"> </span>bca_all<span class="op">$</span>confpoints</span>
<span id="cb1894-6"><a href="the-bootstrap.html#cb1894-6"></a>bca</span></code></pre></div>
<pre><code>##      alpha bca point
## [1,] 0.025      12.5
## [2,] 0.050      12.5
## [3,] 0.100      18.0
## [4,] 0.160      30.5
## [5,] 0.840      94.5
## [6,] 0.900      98.0
## [7,] 0.950     100.0
## [8,] 0.975     115.0</code></pre>
<p>Again, I seem to need to define the tiny function, while you can probably call <code>bcanon(hours, 1000, median)</code>. Try it and see.</p>
<p>My BCa interval is a little longer than the bootstrap percentile
interval and a little shorter than the one that came from the sign
test. I would guess that the BCa interval is the most trustworthy of
the three, though there is here not that much difference between
them. All the intervals are again very long, a reflection of the small
sample size and large variability.</p>

</div>
</div>
<p style="text-align: center;">
<a href="functions.html"><button class="btn btn-default">Previous</button></a>
<a href="logistic-regression.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>

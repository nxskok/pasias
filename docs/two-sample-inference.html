<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Problems and Solutions in Applied Statistics" />
<meta property="og:type" content="book" />
<meta property="og:url" content="<a href="http://ritsokiguess.site/pasias" class="uri">http://ritsokiguess.site/pasias</a>" />

<meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
<meta name="github-repo" content="nxskok/pasias" />

<meta name="author" content="Ken Butler" />

<meta name="date" content="2018-10-09" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics">

<title>Problems and Solutions in Applied Statistics</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li class="has-sub"><a href="getting-used-to-r-and-r-studio.html#getting-used-to-r-and-r-studio"><span class="toc-section-number">2</span> Getting used to R and R Studio</a><ul>
<li><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><span class="toc-section-number">2.1</span> Getting an R Studio Cloud account</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#getting-started"><span class="toc-section-number">2.2</span> Getting started</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><span class="toc-section-number">2.3</span> Reading data from a file</a></li>
</ul></li>
<li class="has-sub"><a href="reading-in-data-and-drawing-some-graphs.html#reading-in-data-and-drawing-some-graphs"><span class="toc-section-number">3</span> Reading in data and drawing some graphs</a><ul>
<li><a href="reading-in-data-and-drawing-some-graphs.html#orange-juice"><span class="toc-section-number">3.1</span> Orange juice</a></li>
<li><a href="reading-in-data-and-drawing-some-graphs.html#making-soap"><span class="toc-section-number">3.2</span> Making soap</a></li>
<li><a href="reading-in-data-and-drawing-some-graphs.html#handling-shipments"><span class="toc-section-number">3.3</span> Handling shipments</a></li>
</ul></li>
<li class="has-sub"><a href="data-exploration.html#data-exploration"><span class="toc-section-number">4</span> Data exploration</a><ul>
<li><a href="data-exploration.html#north-carolina-births"><span class="toc-section-number">4.1</span> North Carolina births</a></li>
<li><a href="data-exploration.html#more-about-the-nc-births"><span class="toc-section-number">4.2</span> More about the NC births</a></li>
<li><a href="data-exploration.html#nenana-alaska"><span class="toc-section-number">4.3</span> Nenana, Alaska</a></li>
<li><a href="data-exploration.html#computerized-accounting"><span class="toc-section-number">4.4</span> Computerized accounting</a></li>
<li><a href="data-exploration.html#test-scores-in-two-classes"><span class="toc-section-number">4.5</span> Test scores in two classes</a></li>
</ul></li>
<li class="has-sub"><a href="one-sample-inference.html#one-sample-inference"><span class="toc-section-number">5</span> One-sample inference</a><ul>
<li><a href="one-sample-inference.html#hunter-gatherers-in-australia"><span class="toc-section-number">5.1</span> Hunter-gatherers in Australia</a></li>
<li><a href="one-sample-inference.html#buses-to-boulder"><span class="toc-section-number">5.2</span> Buses to Boulder</a></li>
<li><a href="one-sample-inference.html#length-of-gestation-in-north-carolina"><span class="toc-section-number">5.3</span> Length of gestation in North Carolina</a></li>
<li><a href="one-sample-inference.html#inferring-ice-break-up-in-nenana"><span class="toc-section-number">5.4</span> Inferring ice break-up in Nenana</a></li>
</ul></li>
<li class="has-sub"><a href="two-sample-inference.html#two-sample-inference"><span class="toc-section-number">6</span> Two-sample inference</a><ul>
<li><a href="two-sample-inference.html#children-and-electronic-devices"><span class="toc-section-number">6.1</span> Children and electronic devices</a></li>
<li><a href="two-sample-inference.html#parking-close-to-the-curb"><span class="toc-section-number">6.2</span> Parking close to the curb</a></li>
<li><a href="two-sample-inference.html#bell-peppers-and-too-much-water"><span class="toc-section-number">6.3</span> Bell peppers and too much water</a></li>
<li><a href="two-sample-inference.html#exercise-and-anxiety-and-bullying-mice"><span class="toc-section-number">6.4</span> Exercise and anxiety and bullying mice</a></li>
<li><a href="two-sample-inference.html#diet-and-growth-in-boys"><span class="toc-section-number">6.5</span> Diet and growth in boys</a></li>
</ul></li>
<li class="has-sub"><a href="power-and-sample-size.html#power-and-sample-size"><span class="toc-section-number">7</span> Power and sample size</a><ul>
<li><a href="power-and-sample-size.html#simulating-power"><span class="toc-section-number">7.1</span> Simulating power</a></li>
<li><a href="power-and-sample-size.html#calculating-power-and-sample-size-for-estimating-mean"><span class="toc-section-number">7.2</span> Calculating power and sample size for estimating mean</a></li>
<li><a href="power-and-sample-size.html#simulating-power-for-proportions"><span class="toc-section-number">7.3</span> Simulating power for proportions</a></li>
</ul></li>
<li class="has-sub"><a href="the-sign-test-and-moods-median-test.html#the-sign-test-and-moods-median-test"><span class="toc-section-number">8</span> The sign test and Mood’s median test</a><ul>
<li><a href="the-sign-test-and-moods-median-test.html#running-a-maze"><span class="toc-section-number">8.1</span> Running a maze</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#chocolate-chips"><span class="toc-section-number">8.2</span> Chocolate chips</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#the-power-of-the-sign-test"><span class="toc-section-number">8.3</span> The power of the sign test</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#sugar-in-breakfast-cereals"><span class="toc-section-number">8.4</span> Sugar in breakfast cereals</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#fear-of-math"><span class="toc-section-number">8.5</span> Fear of math</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#medical-instructions"><span class="toc-section-number">8.6</span> Medical instructions</a></li>
</ul></li>
<li class="has-sub"><a href="matched-pairs-t-and-sign-test.html#matched-pairs-t-and-sign-test"><span class="toc-section-number">9</span> Matched pairs t and sign test</a><ul>
<li><a href="matched-pairs-t-and-sign-test.html#measuring-body-fat"><span class="toc-section-number">9.1</span> Measuring body fat</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#throwing-baseballs-and-softballs"><span class="toc-section-number">9.2</span> Throwing baseballs and softballs</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#throwing-baseballs-and-softballs-again"><span class="toc-section-number">9.3</span> Throwing baseballs and softballs, again</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#changes-in-salary"><span class="toc-section-number">9.4</span> Changes in salary</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#body-fat-revisited"><span class="toc-section-number">9.5</span> Body fat revisited</a></li>
</ul></li>
<li class="has-sub"><a href="normal-quantile-plots.html#normal-quantile-plots"><span class="toc-section-number">10</span> Normal quantile plots</a><ul>
<li><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><span class="toc-section-number">10.1</span> Lengths of heliconia flowers</a></li>
<li><a href="normal-quantile-plots.html#ferritin-and-normality"><span class="toc-section-number">10.2</span> Ferritin and normality</a></li>
</ul></li>
<li class="has-sub"><a href="analysis-of-variance.html#analysis-of-variance"><span class="toc-section-number">11</span> Analysis of variance</a><ul>
<li><a href="analysis-of-variance.html#movie-ratings-and-lengths"><span class="toc-section-number">11.1</span> Movie ratings and lengths</a></li>
<li><a href="analysis-of-variance.html#deer-and-how-much-they-eat"><span class="toc-section-number">11.2</span> Deer and how much they eat</a></li>
<li><a href="analysis-of-variance.html#movie-ratings-again"><span class="toc-section-number">11.3</span> Movie ratings again</a></li>
<li><a href="analysis-of-variance.html#atomic-weight-of-carbon"><span class="toc-section-number">11.4</span> Atomic weight of carbon</a></li>
</ul></li>
<li class="has-sub"><a href="tidying-and-selecting-data.html#tidying-and-selecting-data"><span class="toc-section-number">12</span> Tidying and selecting data</a><ul>
<li><a href="tidying-and-selecting-data.html#tidying-the-jays-data"><span class="toc-section-number">12.1</span> Tidying the Jays data</a></li>
<li><a href="tidying-and-selecting-data.html#baseball-and-softball-spaghetti"><span class="toc-section-number">12.2</span> Baseball and softball spaghetti</a></li>
<li><a href="tidying-and-selecting-data.html#ethanol-and-sleep-time-in-rats"><span class="toc-section-number">12.3</span> Ethanol and sleep time in rats</a></li>
<li><a href="tidying-and-selecting-data.html#growth-of-tomatoes"><span class="toc-section-number">12.4</span> Growth of tomatoes</a></li>
<li><a href="tidying-and-selecting-data.html#pain-relief-in-migraine-headaches-again"><span class="toc-section-number">12.5</span> Pain relief in migraine headaches (again)</a></li>
<li><a href="tidying-and-selecting-data.html#location-species-and-disease-in-plants"><span class="toc-section-number">12.6</span> Location, species and disease in plants</a></li>
<li><a href="tidying-and-selecting-data.html#mating-songs-in-crickets"><span class="toc-section-number">12.7</span> Mating songs in crickets</a></li>
<li><a href="tidying-and-selecting-data.html#cars"><span class="toc-section-number">12.8</span> Cars</a></li>
<li><a href="tidying-and-selecting-data.html#number-1-songs"><span class="toc-section-number">12.9</span> Number 1 songs</a></li>
<li><a href="tidying-and-selecting-data.html#bikes-on-college"><span class="toc-section-number">12.10</span> Bikes on College</a></li>
<li><a href="tidying-and-selecting-data.html#feeling-the-heat"><span class="toc-section-number">12.11</span> Feeling the heat</a></li>
</ul></li>
<li class="has-sub"><a href="regression.html#regression"><span class="toc-section-number">13</span> Regression</a><ul>
<li><a href="regression.html#rainfall-in-california"><span class="toc-section-number">13.1</span> Rainfall in California</a></li>
<li><a href="regression.html#carbon-monoxide-in-cigarettes"><span class="toc-section-number">13.2</span> Carbon monoxide in cigarettes</a></li>
<li><a href="regression.html#maximal-oxygen-uptake-in-young-boys"><span class="toc-section-number">13.3</span> Maximal oxygen uptake in young boys</a></li>
<li><a href="regression.html#facebook-friends-and-grey-matter"><span class="toc-section-number">13.4</span> Facebook friends and grey matter</a></li>
<li><a href="regression.html#endogenous-nitrogen-excretion-in-carp"><span class="toc-section-number">13.5</span> Endogenous nitrogen excretion in carp</a></li>
<li><a href="regression.html#sparrowhawks"><span class="toc-section-number">13.6</span> Sparrowhawks</a></li>
<li><a href="regression.html#salaries-of-social-workers"><span class="toc-section-number">13.7</span> Salaries of social workers</a></li>
<li><a href="regression.html#predicting-volume-of-wood-in-pine-trees"><span class="toc-section-number">13.8</span> Predicting volume of wood in pine trees</a></li>
<li><a href="regression.html#tortoise-shells-and-eggs"><span class="toc-section-number">13.9</span> Tortoise shells and eggs</a></li>
<li><a href="regression.html#crickets-revisited"><span class="toc-section-number">13.10</span> Crickets revisited</a></li>
<li><a href="regression.html#roller-coasters"><span class="toc-section-number">13.11</span> Roller coasters</a></li>
<li><a href="regression.html#running-and-blood-sugar"><span class="toc-section-number">13.12</span> Running and blood sugar</a></li>
<li><a href="regression.html#calories-and-fat-in-pizza"><span class="toc-section-number">13.13</span> Calories and fat in pizza</a></li>
<li><a href="regression.html#where-should-the-fire-stations-be"><span class="toc-section-number">13.14</span> Where should the fire stations be?</a></li>
<li><a href="regression.html#being-satisfied-with-hospital"><span class="toc-section-number">13.15</span> Being satisfied with hospital</a></li>
<li><a href="regression.html#handling-shipments-of-chemicals"><span class="toc-section-number">13.16</span> Handling shipments of chemicals</a></li>
<li><a href="regression.html#salaries-of-mathematicians"><span class="toc-section-number">13.17</span> Salaries of mathematicians</a></li>
<li><a href="regression.html#predicting-gpa-of-computer-science-students"><span class="toc-section-number">13.18</span> Predicting GPA of computer science students</a></li>
</ul></li>
<li class="has-sub"><a href="dates-and-times.html#dates-and-times"><span class="toc-section-number">14</span> Dates and times</a><ul>
<li><a href="dates-and-times.html#dealing-with-dates-in-the-worcester-heart-attack-study"><span class="toc-section-number">14.1</span> Dealing with dates in the Worcester Heart Attack study</a></li>
<li><a href="dates-and-times.html#growth-of-mizuna-lettuce-seeds"><span class="toc-section-number">14.2</span> Growth of Mizuna lettuce seeds</a></li>
<li><a href="dates-and-times.html#types-of-childbirth"><span class="toc-section-number">14.3</span> Types of childbirth</a></li>
<li><a href="dates-and-times.html#wolves-and-caribou"><span class="toc-section-number">14.4</span> Wolves and caribou</a></li>
</ul></li>
<li class="has-sub"><a href="functions.html#functions"><span class="toc-section-number">15</span> Functions</a><ul>
<li><a href="functions.html#making-some-r-functions"><span class="toc-section-number">15.1</span> Making some R functions</a></li>
<li><a href="functions.html#the-collatz-sequence"><span class="toc-section-number">15.2</span> The Collatz sequence</a></li>
</ul></li>
<li class="has-sub"><a href="logistic-regression.html#logistic-regression"><span class="toc-section-number">16</span> Logistic regression</a><ul>
<li><a href="logistic-regression.html#finding-wolf-spiders-on-the-beach"><span class="toc-section-number">16.1</span> Finding wolf spiders on the beach</a></li>
<li><a href="logistic-regression.html#killing-aphids"><span class="toc-section-number">16.2</span> Killing aphids</a></li>
<li><a href="logistic-regression.html#the-effects-of-substance-a"><span class="toc-section-number">16.3</span> The effects of Substance A</a></li>
<li><a href="logistic-regression.html#what-makes-an-animal-get-infected"><span class="toc-section-number">16.4</span> What makes an animal get infected?</a></li>
<li><a href="logistic-regression.html#the-brain-of-a-cat"><span class="toc-section-number">16.5</span> The brain of a cat</a></li>
<li><a href="logistic-regression.html#how-not-to-get-heart-disease"><span class="toc-section-number">16.6</span> How not to get heart disease</a></li>
<li><a href="logistic-regression.html#successful-breastfeeding"><span class="toc-section-number">16.7</span> Successful breastfeeding</a></li>
<li><a href="logistic-regression.html#making-it-over-the-mountains"><span class="toc-section-number">16.8</span> Making it over the mountains</a></li>
<li><a href="logistic-regression.html#who-needs-the-most-intensive-care"><span class="toc-section-number">16.9</span> Who needs the most intensive care?</a></li>
<li><a href="logistic-regression.html#go-away-and-dont-come-back"><span class="toc-section-number">16.10</span> Go away and don’t come back!</a></li>
</ul></li>
<li class="has-sub"><a href="logistic-regression-with-ordinal-or-nominal-response.html#logistic-regression-with-ordinal-or-nominal-response"><span class="toc-section-number">17</span> Logistic regression with ordinal or nominal response</a><ul>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#do-you-like-your-mobile-phone"><span class="toc-section-number">17.1</span> Do you like your mobile phone?</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#what-sports-do-these-athletes-play"><span class="toc-section-number">17.2</span> What sports do these athletes play?</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="two-sample-inference" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Two-sample inference</h1>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.1.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.8
## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div id="children-and-electronic-devices" class="section level2">
<h2><span class="header-section-number">6.1</span> Children and electronic devices</h2>
<p>Do children (aged 8–17) spend more time on electronic
devices now than they did 10 years ago? Samples of 15 children aged
8–17 were taken in each of two years, 1999 and 2009, and the children (with
their parents’ help) were
asked to keep a diary of the number of hours they spent using
electronic devices on a certain day. The data are in the file
<a href="http://www.utsc.utoronto.ca/~butler/c32/pluggedin.txt" class="uri">http://www.utsc.utoronto.ca/~butler/c32/pluggedin.txt</a>.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and verify that you have 30 rows of data from two
different years.</li>
</ol>
<p>Solution</p>
<p>I see this:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" data-line-number="1">myurl=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/c32/pluggedin.txt&quot;</span></a>
<a class="sourceLine" id="cb250-2" data-line-number="2">plugged=<span class="kw">read_delim</span>(myurl,<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   year = col_integer(),
##   hours = col_integer()
## )</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" data-line-number="1">plugged</a></code></pre></div>
<pre><code>## # A tibble: 30 x 2
##     year hours
##    &lt;int&gt; &lt;int&gt;
##  1  1999     4
##  2  1999     5
##  3  1999     7
##  4  1999     7
##  5  1999     5
##  6  1999     7
##  7  1999     5
##  8  1999     6
##  9  1999     5
## 10  1999     6
## # ... with 20 more rows</code></pre>
<p>I see only the first ten rows (with an indication that there are 20 more, so 30 altogether). In your notebook, it’ll look a bit different: again, you’ll see the first 10 rows, but you’ll see exactly how many rows and columns there are, and there will be buttons “Next” and “Previous” to see earlier and later rows, and a little right-arrow to see more columns to the right (to which is added a little left-arrow if there are previous columns to scroll back to). If you want to check for yourself that there are 30 rows, you can click Next a couple of times to get down to row 30, and then see that the Next button cannot be clicked again, and therefore that 30 rows is how many there are.</p>
<p>Or, you can summarize the years by counting how many there are
of each:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" data-line-number="1">plugged <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(year)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##    year     n
##   &lt;int&gt; &lt;int&gt;
## 1  1999    15
## 2  2009    15</code></pre>
<p>or the more verbose form of the same thing:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" data-line-number="1">plugged <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">rows=</span><span class="kw">n</span>())</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##    year  rows
##   &lt;int&gt; &lt;int&gt;
## 1  1999    15
## 2  2009    15</code></pre>
<p>Any of those says that it looks good. 30 rows, 1999 and 2009, 15
measurements for each.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Draw side-by-side boxplots of the number of hours for each
year. <code>year</code> is a numeric variable that we want to treat as a
factor, so we need to <em>make</em> it into a factor.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1"><span class="kw">ggplot</span>(plugged,<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">factor</span>(year),<span class="dt">y=</span>hours))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-5-1.png" width="672"  /></p>
<p>The <code>fct_inorder</code> trick from assignment 1 will also work, since
the years are in the data in the order we want them to be displayed.</p>
<p>The median for 2009 is noticeably higher, and there is no skewness or
outliers worth worrying about.</p>
<p>The measurements for the two years have a very similar spread, so
there would be no problem running the pooled test here.</p>
<p>You might be bothered by the <code>factor(year)</code> on the <span class="math inline">\(x\)</span>-axis. To
get around that, you can define year-as-factor <em>first</em>, using
<code>mutate</code>, then feed your new column into the boxplot. That goes
like this. There is a wrinkle that I explain afterwards:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" data-line-number="1">plugged <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">the_year=</span><span class="kw">factor</span>(year)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb259-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>the_year, <span class="dt">y=</span>hours))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-6-1.png" width="672"  /></p>
<p>You could even redefine <code>year</code> to be the factor version of
itself (if you don’t need the year-as-number anywhere else). The
wrinkle I mentioned above is that in the <code>ggplot</code> you  name the data frame first; the data frame used is the
(nameless) data frame that came out of the previous step, not
<code>plugged</code> but <code>plugged</code> with a new column
<code>the_year</code>.</p>
<p>Note how the <span class="math inline">\(x\)</span>-axis now has the name of the new variable.</p>
<p>If you forget to make <code>year</code> into a factor, this happens:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" data-line-number="1"><span class="kw">ggplot</span>(plugged,<span class="kw">aes</span>(<span class="dt">x=</span>year,<span class="dt">y=</span>hours))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<pre><code>## Warning: Continuous x aesthetic -- did you forget aes(group=...)?</code></pre>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-7-1.png" width="672"  /></p>
<p>You get <em>one</em> boxplot, for all the hours, without distinguishing
by year, and a warning message that tries (and fails) to read our
mind: yes, we have a continuous, quantitative <code>x</code>, but
<code>geom_boxplot</code> doesn’t take a <code>group</code>.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Test whether the mean number of hours has <em>increased</em> since</li>
</ol>
<ol start="1999" style="list-style-type: decimal">
<li>Which test did R do?</li>
</ol>
<p>Solution</p>
<p>The hard part to remember is how you specify a one-sided test in
R; it’s <code>alternative=&quot;less&quot;</code> (rather
than “greater”) because 1999 is “before” 2009:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" data-line-number="1"><span class="kw">t.test</span>(hours<span class="op">~</span>year,<span class="dt">data=</span>plugged,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)  </a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  hours by year
## t = -3.3323, df = 24.861, p-value = 0.001348
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf -0.8121415
## sample estimates:
## mean in group 1999 mean in group 2009 
##           5.933333           7.600000</code></pre>
<p>The P-value is 0.0013. R does the Welch-Satterthwaite test by default
(the unequal-variances one). Since we didn’t change that, that’s what
we got. (The pooled test is below.)</p>
<p>This is the cleanest way to do it, because this version of
<code>t.test</code>, with a “model formula” (the thing with the
squiggle) allows a <code>data=</code> to say which data frame to get
things from. The other ways, using (for example) <code>with</code>, also work:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" data-line-number="1"><span class="kw">with</span>(plugged,<span class="kw">t.test</span>(hours<span class="op">~</span>year,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>))</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  hours by year
## t = -3.3323, df = 24.861, p-value = 0.001348
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf -0.8121415
## sample estimates:
## mean in group 1999 mean in group 2009 
##           5.933333           7.600000</code></pre>
<p>This also works, but is <em>ugly</em>:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" data-line-number="1"><span class="kw">t.test</span>(plugged<span class="op">$</span>hours<span class="op">~</span>plugged<span class="op">$</span>year,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  plugged$hours by plugged$year
## t = -3.3323, df = 24.861, p-value = 0.001348
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf -0.8121415
## sample estimates:
## mean in group 1999 mean in group 2009 
##           5.933333           7.600000</code></pre>
<p>Ugly because you’ve just typed the name of the data frame and the
dollar sign <em>twice</em> for no reason. As a general principle, if you
as a programmer are repeating yourself, you should stop and ask
yourself how you can avoid the repeat.</p>
<p>If you want the pooled test in R, you have to ask for it:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" data-line-number="1"><span class="kw">t.test</span>(hours<span class="op">~</span>year,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>,<span class="dt">data=</span>plugged,<span class="dt">var.equal=</span>T)    </a></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  hours by year
## t = -3.3323, df = 28, p-value = 0.001216
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf -0.8158312
## sample estimates:
## mean in group 1999 mean in group 2009 
##           5.933333           7.600000</code></pre>
<p>As is often the case, the P-values for the pooled and
Welch-Satterthwaite tests are very similar, so from that point of view
it doesn’t matter much which one you use. If you remember back to the
boxplots, the number of hours had about the same spread for the two
years, so if you used the pooled test instead of the
Welch-Satterthwaite test, that would have been just fine.</p>
<p>There is a school of thought that says we should learn the
Welch-Satterthwaite test and use that always. This is because W-S (i)
works when the populations from which the groups are sampled have
different SDs and (ii) is pretty good even when those SDs are the same.</p>
<p>The pooled test can go badly wrong if the groups have very different
SDs. The story is this: if the larger sample is from the population
with the larger SD, the probability of a type I error will be smaller
than <span class="math inline">\(\alpha\)</span>, and if the larger sample is from the population with
the <em>smaller</em> SD, the probability of a type I error will be
larger than <span class="math inline">\(\alpha\)</span>. This is why you see S-W in STAB22. You see the
pooled test in STAB57 because the logic of its derivation is so much
clearer,
<label for="tufte-mn-14" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-14" class="margin-toggle"><span class="marginnote">I return to this issue when we look at the same data in SAS later.</span>
not because it’s really the better test in
practice. The theory says that if your data are normal in both groups
with the same variance, then the pooled test is best, but it says
<em>nothing</em> about the quality of the pooled test if any of that
goes wrong.
The usual approach to assessing things like this is via simulation,
as we do for estimating power (later): generate some random data
eg. from normal distributions with the same means, SDs 10 and 20
and sample sizes 15 and 30, run the pooled <span class="math inline">\(t\)</span>-test, see if you
reject, then repeat lots of times and see whether you reject about
5% of the time. Then do the same thing again with the sample sizes
switched around. Or, do the same thing with Welch-Satterthwaite.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Obtain a 99% confidence interval for the difference in means.</li>
</ol>
<p>Solution</p>
<p>Take off the thing that made it one-sided, and
put in a thing that gets the right CI:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" data-line-number="1"><span class="kw">t.test</span>(hours<span class="op">~</span>year,<span class="dt">data=</span>plugged,<span class="dt">conf.level=</span><span class="fl">0.99</span>)  </a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  hours by year
## t = -3.3323, df = 24.861, p-value = 0.002696
## alternative hypothesis: true difference in means is not equal to 0
## 99 percent confidence interval:
##  -3.0614628 -0.2718705
## sample estimates:
## mean in group 1999 mean in group 2009 
##           5.933333           7.600000</code></pre>
<p><span class="math inline">\(-3.06\)</span> to <span class="math inline">\(-0.27\)</span>. The interval contains only negative values, which
is consistent with our having rejected a null hypothesis of no
difference in means.</p>
</div>
<div id="parking-close-to-the-curb" class="section level2">
<h2><span class="header-section-number">6.2</span> Parking close to the curb</h2>
<p>In 2009, the Toronto Star commissioned a survey to address
the issue of who is better at parking a car: men or women. The
researchers recorded 93 drivers who were parallel-parking their car in
downtown Toronto, and for each driver, recorded the distance between
the car and the curb, in inches, when the driver was finished parking
their car. The data are in an Excel spreadsheet,
<a href="http://www.utsc.utoronto.ca/~butler/c32/parking.xlsx">link</a>. (Let me
know if you cannot handle this format.) Click on the link. The data
will probably download automatically. Check the folder on your
computer where things get downloaded.
<label for="tufte-mn-15" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-15" class="margin-toggle"><span class="marginnote">Mine is rather prosaically called <em>Downloads</em>.</span>
If the spreadsheet is just
displayed and not downloaded, save it somewhere on your computer.</p>
<ol style="list-style-type: lower-alpha">
<li>There are two sheets in this spreadsheet workbook. They are
of the same data in two different formats. Take a look at Sheet 1
and Sheet 2. Describe the format of the data in each case. Which will be the most suitable data layout, bearing in
mind that one of the first things we do is to make side-by-side
boxplots of parking distances for males and females? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The data in Sheet 1 has one column of parking distances for
males, and another for females. This is often how you see data
of this sort laid out. Sheet 2 has <em>one</em> column of parking
distances, all combined together, and a second column indicating
the gender of the driver whose distance is in the first column.
If you look back at the kind of data we’ve used to make
side-by-side boxplots, it’s always been in the format of Sheet
2: one column containing all the values of the variable we’re
interested in, with a second column indicating which group each
observation belongs to (“group” here being
“gender of driver”).
So we need to use the data in Sheet 2, because the
data in Sheet 1 are not easy to handle with R.
The layout of Sheet 2 is the way R likes to do most things:
so-called “long format” with a lot of rows and not many
columns. This is true for descriptive stuff: side-by-side
boxplots or histograms or means by group, as well as modelling
such as (here) a two-sample <span class="math inline">\(t\)</span>-test, or (in other
circumstances, as with several groups) a one-way analysis of
variance.
Hadley Wickham, the guy behind the <code>tidyverse</code>, likes to
talk about “tidy data” (like Sheet 2), with each column
containing a variable, and “untidy data” (like Sheet 1), where
the two columns are the same thing (distances), but under
different circumstances (genders). As we’ll see later, it is
possible to convert from one format to the other. Usually you
want to make untidy data tidy (the function for this is called
<code>gather</code>).</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Read your preferred sheet directly into R, <em>without</em>
using a <code>.csv</code> file. (There is a clue in the lecture notes,
in the section about reading in files.) If you get stuck, make a
<code>.csv</code> file and read that in.</li>
</ol>
<p>Solution</p>
<p>The direct way is to use the package <code>readxl</code>. This has a
<code>read_excel</code> that works the same way as any of the other
<code>read_</code> functions. You’ll have to make sure that you
read in sheet 2, since that’s the one you want.
There is some setup first. There are a couple of ways you can do that:</p>
<ul>
<li><p>Download the spreadsheet to your computer, and upload it
to your project on R Studio Cloud (or, if you are running R
Studio on your computer, use something like
<code>file.choose</code> to get the file from wherever it got
downloaded to).</p></li>
<li><p>Use the function <code>download.file</code> to get the file
from the URL and store it in your project folder
directly. This also works in R Studio Cloud, and completely
by-passes the download-upload steps that you would have to do
otherwise. (I am grateful to Rose Gao for this idea.)
Here is how you can use <code>download.file</code> here:</p></li>
</ul>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1">my_url=<span class="st">&#39;http://www.utsc.utoronto.ca/~butler/c32/parking.xlsx&#39;</span></a>
<a class="sourceLine" id="cb272-2" data-line-number="2">local=<span class="st">&quot;parking.xlsx&quot;</span></a>
<a class="sourceLine" id="cb272-3" data-line-number="3"><span class="kw">download.file</span>(my_url, local, <span class="dt">mode=</span><span class="st">&quot;wb&quot;</span>)</a></code></pre></div>
<p>When you’ve gotten the spreadsheet into your project folder via one of
those two ways, you go ahead and do this:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" data-line-number="1"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb273-2" data-line-number="2">parking=<span class="kw">read_excel</span>(<span class="st">&quot;parking.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb273-3" data-line-number="3">parking</a></code></pre></div>
<pre><code>## # A tibble: 93 x 2
##    distance gender
##       &lt;dbl&gt; &lt;chr&gt; 
##  1      0.5 male  
##  2      1   male  
##  3      1.5 male  
##  4      1.5 male  
##  5      1.5 male  
##  6      3   male  
##  7      3.5 male  
##  8      5   male  
##  9      6   male  
## 10      6   male  
## # ... with 83 more rows</code></pre>
<p>You have to do it this way, using the version of the spreadsheet on
your computer, since <code>read_excel</code> won’t take a
URL, or if it does, I can’t make it work.
<label for="tufte-mn-16" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-16" class="margin-toggle"><span class="marginnote">Let me know if you have more success than I did.</span>
I put the spreadsheet in R Studio’s
current folder, so I could read it in by name, or you can do the
<code>f=file.choose()</code> thing, find it, then read it in.
The <code>sheet=</code> thing can take either a number (as here: the
second sheet in the workbook), or a name (whatever name the sheet has
on its tab in the workbook).</p>
<p>Extra: Rose actually came up with a better idea, which I will show
you and explain:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" data-line-number="1">tf=<span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb275-2" data-line-number="2"><span class="kw">download.file</span>(my_url, tf, <span class="dt">mode=</span><span class="st">&quot;wb&quot;</span>)</a>
<a class="sourceLine" id="cb275-3" data-line-number="3">p=<span class="kw">read_excel</span>(tf, <span class="dt">sheet =</span> <span class="dv">2</span>)</a></code></pre></div>
<p>What <code>tempfile()</code> does is to create a temporary file to hold the
spreadsheet that you are about to download. After downloading the
spreadsheet to the temporary file, you then use <code>read_excel</code> to
read <em>from the temporary file</em> into the data frame.</p>
<p>The advantage of this approach is that the temporary file disappears
as soon as you close R, and so you don’t have a copy of the
spreadsheet lying around that you don’t need (once you have created
the data frame that I called <code>parking</code>, anyway).</p>
<p>If you are wondering about that <code>mode</code> thing on
<code>download.file</code>: files are of two different types, “text”
(like the text of an email, that you can open and look at in something
like Notepad), and “binary” that you can’t look at directly, but for
which you need special software like Word or Excel to decode it for
you.
<label for="tufte-mn-17" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-17" class="margin-toggle"><span class="marginnote">A Word or Excel document has all kinds of formatting information hidden in the file as well as the text that you see on the screen.</span><br />
The first character in <code>mode</code> is either
<code>w</code> for “write a new file”, which is what we want here, or
<code>a</code> for “append”, which would mean adding to the end of a
file that already exists. Thus <code>mode=&quot;wb&quot;</code> means
“create a new binary file”.
End of Extra.
If you can’t make any of this work, then do it in two steps:
save the appropriate sheet as a <code>.csv</code>
file, and then read the <code>.csv</code> file using
<code>read_csv</code>. If you experiment, you’ll find that saving a
spreadsheet workbook as <code>.csv</code> only saves the sheet
you’re looking at, so make sure you are looking at sheet 2
before you Save As <code>.csv</code>. I did that, and called my
saved <code>.csv</code> <code>parking2.csv</code> (because it was from
sheet 2, but you can use any name you like).
Then I read this into R thus:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" data-line-number="1">parking2=<span class="kw">read_csv</span>(<span class="st">&quot;parking2.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   distance = col_double(),
##   gender = col_character()
## )</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" data-line-number="1">parking2</a></code></pre></div>
<pre><code>## # A tibble: 93 x 2
##    distance gender
##       &lt;dbl&gt; &lt;chr&gt; 
##  1      0.5 male  
##  2      1   male  
##  3      1.5 male  
##  4      1.5 male  
##  5      1.5 male  
##  6      3   male  
##  7      3.5 male  
##  8      5   male  
##  9      6   male  
## 10      6   male  
## # ... with 83 more rows</code></pre>
<p>The read-in data frame <code>parking</code>
has 93 rows (<span class="math inline">\(47+46=93\)</span> drivers) and two columns: the distance from
the curb that the driver ended up at, and the gender of the
driver. This is as the spreadsheet Sheet 2 was, and the first few
distances match the ones in the spreadsheet.</p>
<p>If I were grading this, you’d get some credit for the <code>.csv</code>
route, but I really wanted you to figure out how to read the Excel
spreadsheet directly, so that’s what would be worth full marks.</p>
<p>You might want to check that you have some males and some females, and
how many of each, which you could do this way:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" data-line-number="1">parking <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(gender)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   gender     n
##   &lt;chr&gt;  &lt;int&gt;
## 1 female    47
## 2 male      46</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Obtain side-by-side boxplots of parking distances for
males and females. Does one
gender seem to be better at parking than the other? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>With the right data set, this is a piece of cake:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" data-line-number="1"><span class="kw">ggplot</span>(parking,<span class="kw">aes</span>(<span class="dt">x=</span>gender,<span class="dt">y=</span>distance))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-18-1.png" width="672"  /></p>
<p>The outcome variable is distance from the curb, so smaller should be
better (more accurate parking). With that in mind, the median for
females is a little smaller than for males (about 8.5 vs. about 10),
so it seems that on average females are more accurate parkers than
males are. The difference is small, however (and so you might be
wondering at this point whether it’s a statistically significant
difference — don’t worry, that’s coming up).</p>
<p>Before I leave this one, I want to show you something else:
above-and-below histograms, as another way of comparing males and
females (two or more groups, in general). First, we make a histogram of all
the distances, without distinguishing by gender:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" data-line-number="1"><span class="kw">ggplot</span>(parking,<span class="kw">aes</span>(<span class="dt">x=</span>distance))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">8</span>)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-19-1.png" width="672"  /></p>
<p>That big outlier is the very inaccurate male driver.</p>
<p>Now, how do we get a <em>separate</em> histogram for each
<code>gender</code>? In <code>ggplot</code>, separate plots for each
“something” are called <strong>facets</strong>, and the way to get facets
arranged as you want them is called <code>facet_grid</code>. Let me show you
the code first, and then explain how it works:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" data-line-number="1"><span class="kw">ggplot</span>(parking,<span class="kw">aes</span>(<span class="dt">x=</span>distance))<span class="op">+</span></a>
<a class="sourceLine" id="cb284-2" data-line-number="2"><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">7</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb284-3" data-line-number="3"><span class="kw">facet_grid</span>(gender<span class="op">~</span>.)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-20-1.png" width="672"  /></p>
<p><code>facet_grid</code> takes a “model formula” with a squiggle, with <span class="math inline">\(y\)</span>
on the left and <span class="math inline">\(x\)</span> on the right. We want to compare our two
histograms, one for males and one for females, and I think the best
way to compare histograms is to have one on top of the other. Note
that the same <code>distance</code> scale is used for both histograms, so
that it is a fair comparison. The above-and-below is accomplished by
having <code>gender</code> as the <span class="math inline">\(y\)</span> in the arrangement of the facets, so
it goes before the squiggle. We don’t have any <span class="math inline">\(x\)</span> in the arrangement
of the facets, and we tell <code>ggplot</code> this by putting a dot where
the <span class="math inline">\(x\)</span> would be.
<label for="tufte-mn-18" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-18" class="margin-toggle"><span class="marginnote">You might have a second categorical variable by which you want to arrange the facets left and right, and that would go where the dot is.</span></p>
<p>You can also use <code>facet_wrap</code> for this, but you have to be
more careful since you don’t have any control over how the histograms
come out (you probably get them side by side, which is not so helpful
for comparing distributions). You can make it work by using
<code>ncol=1</code> to arrange “all” the histograms in one column:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" data-line-number="1"><span class="kw">ggplot</span>(parking,<span class="kw">aes</span>(<span class="dt">x=</span>distance))<span class="op">+</span></a>
<a class="sourceLine" id="cb285-2" data-line-number="2"><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">7</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb285-3" data-line-number="3"><span class="kw">facet_wrap</span>(<span class="op">~</span>gender,<span class="dt">ncol=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-21-1.png" width="672"  /></p>
<p>The centres of both histograms are somewhere around 10, so it’s hard
to see any real difference between males and females here. Maybe this
is further evidence that the small difference we saw between the
boxplots is really not worth getting excited about.</p>
<p>You might be concerned about how you know what to put with the
squiggle-thing in <code>facet_grid</code> and <code>facet_wrap</code>. The
answer is that <code>facet_wrap</code> <em>only</em> has something to the
right of the squiggle (which <code>ggplot</code> then decides how to
arrange), but <code>facet_grid</code> <em>must</em> have something on
<em>both</em> sides of the squiggle (how to arrange in the <span class="math inline">\(y\)</span> direction
on the left, how to arrange in the <span class="math inline">\(x\)</span> direction on the right), and if
you don’t have anything else to put there, you put a dot. Here’s my
<code>facet_grid</code> code from above, again:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" data-line-number="1"><span class="kw">ggplot</span>(parking,<span class="kw">aes</span>(<span class="dt">x=</span>distance))<span class="op">+</span></a>
<a class="sourceLine" id="cb286-2" data-line-number="2"><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">7</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb286-3" data-line-number="3"><span class="kw">facet_grid</span>(gender<span class="op">~</span>.)</a></code></pre></div>
<p>We wanted gender to go up and down, and we had nothing to go left and
right, hence the dot. Contrast that with my <code>facet_wrap</code>
code:
<label for="tufte-mn-19" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-19" class="margin-toggle"><span class="marginnote">I took out the <em>ncol</em> since that confuses the explanation here.</span></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" data-line-number="1"><span class="kw">ggplot</span>(parking,<span class="kw">aes</span>(<span class="dt">x=</span>distance))<span class="op">+</span></a>
<a class="sourceLine" id="cb287-2" data-line-number="2"><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">7</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb287-3" data-line-number="3"><span class="kw">facet_wrap</span>(<span class="op">~</span>gender)</a></code></pre></div>
<p>This says “make a separate facet for each gender”, but it doesn’t
say anything about how to arrange them.
The choice of bins for my histogram(s) came from Sturges’ rule: with
<span class="math inline">\(n\)</span> being the number of observations, you use <span class="math inline">\(k\)</span> bins where
<span class="math inline">\(k=\log_2(n)+1\)</span>, rounded up. If we were to make a histogram of all the
parking distances combined together, we would have <span class="math inline">\(n=47+48=95\)</span>
observations, so we should use this many bins:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" data-line-number="1">sturges=<span class="kw">log</span>(<span class="dv">95</span>,<span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb288-2" data-line-number="2">sturges</a></code></pre></div>
<pre><code>## [1] 7.569856</code></pre>
<p>Round this up to 8. (The second thing in <code>log</code> is the base of
the logs, if you specify it, otherwise it defaults to <span class="math inline">\(e\)</span> and gives
you “natural” logs.) I seem to have the powers of 2 in my head, so I
can do it mentally by saying “the next power of 2 is 128, which is <span class="math inline">\(2^7\)</span>, so I need <span class="math inline">\(7+1=8\)</span> bins.”</p>
<p>Or:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" data-line-number="1"><span class="kw">with</span>(parking,<span class="kw">nclass.Sturges</span>(distance))</a></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>Sturges’ rule tends to produce not enough bins if <span class="math inline">\(n\)</span> is small, so be
prepared to increase it a bit if you don’t have much data.
I think that gives a fairly bare-bones picture of the shape: skewed to
the right with outlier.</p>
<p>The other rule we saw was Freedman-Diaconis:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" data-line-number="1"><span class="kw">with</span>(parking, <span class="kw">nclass.FD</span>(distance))</a></code></pre></div>
<pre><code>## [1] 14</code></pre>
<p>and that leads to this histogram:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" data-line-number="1"><span class="kw">ggplot</span>(parking,<span class="kw">aes</span>(<span class="dt">x=</span>distance))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">14</span>)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-27-1.png" width="672"  /></p>
<p>That gives rather more detail (a lot more bars: the binwidth in the
Sturges-rule histogram is about 7, or twice what you see here), but in
this case the overall story is about the same.</p>
<p>In the case of faceted histograms, you would want to apply a rule that
uses the number of observations in <em>each</em> histogram. The facets
might have quite different numbers of observations, but you can only
use one <code>binwidth</code> (or <code>bins</code>), so you may have to
compromise. For example, using Sturges’ rule based on 47 observations
(the number of males; the number of females is one more):</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" data-line-number="1"><span class="kw">log</span>(<span class="dv">47</span>,<span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span></a></code></pre></div>
<pre><code>## [1] 6.554589</code></pre>
<p>and so each facet should have that many bins, rounded up. That’s where
I got my 7 for the facetted histogram from. This one doesn’t work
immediately with <code>nclass.Sturges</code>, because we do not have
<em>one</em> column whose length is the number of observations we want:
we have one column of distances that are males and females mixed
up. To do <em>that</em>, <code>filter</code> one of the genders first:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" data-line-number="1">parking <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb297-2" data-line-number="2"><span class="kw">filter</span>(gender<span class="op">==</span><span class="st">&quot;female&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb297-3" data-line-number="3"><span class="kw">with</span>(.,<span class="kw">nclass.Sturges</span>(distance))</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>I used the “dot” trick again, which you can read as “it”: “from <code>parking</code>, take only the rows for the females, and with it, give me the number of bins for a histogram by Sturges’ rule.”</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Explain briefly why this is two independent samples
rather than matched pairs.</li>
</ol>
<p>Solution</p>
<p>There is no way to pair any male with a corresponding female,
because they are unrelated people. You might also notice that
there are not even the <em>same number</em> of males and females,
so there can be no way of pairing them up without leaving one
over. (In general, if the two samples are paired, there must be
the same number of observations in each; if there are different
numbers in each, as here, they cannot be paired.)
If you want that more mathematically, let <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> be the
two sample sizes; then:
<span class="math display">\[
\mbox{Paired} \Longrightarrow n_1=n_2
\]</span></p>
<p>from which it follows logically (the “contrapositive”) that</p>
<p><span class="math display">\[
n_1 \ne n_2 \Longrightarrow \mbox{not paired}
\]</span>
You’ll note from the logic that if the two sample sizes are the same,
that tells you <em>nothing</em> about whether it’s paired or independent
samples: it could be either, and in that case you have to look at the
description of the data to decide between them.</p>
<p>Here, anything that gets at why the males and females cannot be paired
up is good.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Run a suitable <span class="math inline">\(t\)</span>-test for comparing parking distances
for males and females. What do you conclude, in the context of the data?</li>
</ol>
<p>Solution</p>
<p>A two-sample <span class="math inline">\(t\)</span>-test. I think either the Welch or the pooled one can
be justified (and I would expect them to give similar answers). You
can do the Welch one either without comment or by asserting that the
boxplots show different spreads; if you are going to do the pooled
one, you need to say that the spreads are “about equal”, by
comparing the heights of the boxes on the boxplots:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" data-line-number="1"><span class="kw">t.test</span>(distance<span class="op">~</span>gender,<span class="dt">data=</span>parking)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  distance by gender
## t = -1.3238, df = 79.446, p-value = 0.1894
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -4.5884103  0.9228228
## sample estimates:
## mean in group female   mean in group male 
##             9.308511            11.141304</code></pre>
<p>This is the Welch-Satterthwaite version of the test, the one that does
not assume equal SDs in the two groups. The P-value of 0.1894 is not
small, so there is no evidence of any difference in parking accuracy
between males and females.</p>
<p>Or, this being the pooled one:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1"><span class="kw">t.test</span>(distance<span class="op">~</span>gender,<span class="dt">data=</span>parking,<span class="dt">var.equal=</span>T)</a></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  distance by gender
## t = -1.329, df = 91, p-value = 0.1872
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -4.5722381  0.9066506
## sample estimates:
## mean in group female   mean in group male 
##             9.308511            11.141304</code></pre>
<p>You might have thought, looking at the boxplots, that the groups had
about the same SD (based, for example, on noting that the two boxes
were about the same height, so the IQRs were about the same). In that
case, you might run a pooled <span class="math inline">\(t\)</span>-test, which here gives an almost
identical P-value of 0.1872, and the exact same conclusion.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Why might you have some doubts about the <span class="math inline">\(t\)</span>-test that
you just did? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The two-sample <span class="math inline">\(t\)</span>-test is based on an assumption of
normally-distributed data within each group. If you go back
and look at the boxplots, you’ll see either (depending on
your point of view) that both groups are right-skewed, or
that both groups have outliers, neither of which fits a
normal distribution. The outlier in the male group is
particularly egregious.
<label for="tufte-mn-20" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-20" class="margin-toggle"><span class="marginnote">Google defines this as meaning <em>outstandingly bad, shocking</em>.</span> So I think we
are entitled to question whether a two-sample <span class="math inline">\(t\)</span>-test is
the right thing to do.
Having said that, we should go back and remember that the
<span class="math inline">\(t\)</span>-tests are “robust to departures from normality” (since
we are working with the Central Limit Theorem here), and
therefore that this test might be quite good even though the
data are not normal, because the sample sizes of 40-plus are
large (by the standards of what typically makes the Central
Limit Theorem work for us). So it may not be as bad as it seems.
A common competitor for the two-sample <span class="math inline">\(t\)</span>-test is the
Mann-Whitney test. This doesn’t assume normality, but it
<em>does</em> assume symmetric distributions, which it’s not
clear that we have here. I like a test called Mood’s Median
Test, which is kind of the two-sample equivalent of the sign
test (which we will also see later). It goes like this:
Work out the overall median of all the distances, regardless
of gender:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" data-line-number="1">parking <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">med=</span><span class="kw">median</span>(distance))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     med
##   &lt;dbl&gt;
## 1     9</code></pre>
<p>The overall median is 9.</p>
<p>Count up how many distances of each gender were above or below the
overall median. (Strictly, I’m supposed to throw away any values that
are exactly equal to the overall median, but I won’t here for clarity
of exposition.)</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" data-line-number="1">tab=<span class="kw">with</span>(parking,<span class="kw">table</span>(gender,distance<span class="op">&lt;</span><span class="dv">9</span>))</a>
<a class="sourceLine" id="cb305-2" data-line-number="2">tab</a></code></pre></div>
<pre><code>##         
## gender   FALSE TRUE
##   female    23   24
##   male      27   19</code></pre>
<p>For example, 19 of the male drivers had a distance (strictly) less than 9.
Both genders are pretty close to 50–50 above and below the overall
median, which suggests that the males and females have about the same
median. This can be tested (it’s a chi-squared test for independence,
if you know that):</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" data-line-number="1"><span class="kw">chisq.test</span>(tab,<span class="dt">correct=</span>F)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tab
## X-squared = 0.89075, df = 1, p-value = 0.3453</code></pre>
<p>This is even less significant (P-value 0.3453) than the two-sample
<span class="math inline">\(t\)</span>-test, and so is consistent with our conclusion from before that
there is actually no difference between males and females in terms of
average parking distance. The Mood’s median test is believable because
it is not affected by outliers or distribution shape.</p>
<ol start="7" style="list-style-type: lower-alpha">
<li>The Toronto Star in its report said that females are
more accurate at parking their cars. Why do you think they
concluded that, and do you think they were right to do so?
Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The conclusion from the boxplots was that the female
median distance was less than the males, slightly, in this
sample. That is probably what the Star seized on.
Were they right? Well, that was why we did the test of
significance. We were trying to see whether this observed
difference between males and females was “real” (would
hold up if you looked at “all” male and female drivers)
or “reproducible” (you would expect to see it again if
you did another study like this one). The large,
non-significant P-values in all our tests tell us that the
difference observed here was nothing more than chance. So
it was not reasonable to conclude that females generally
are more accurate at parallel-parking than males are.</p>
</div>
<div id="bell-peppers-and-too-much-water" class="section level2">
<h2><span class="header-section-number">6.3</span> Bell peppers and too much water</h2>
<p>A pathogen called <em>Phytophthora capsici</em> causes bell
peppers to wilt and die. It is thought that too much water aids in the
spread of the pathogen. Two fields are under study, labelled
<code>a</code> and <code>b</code>. The first step in the research project is
to compare the mean soil water content of the two fields. There is
a suspicion that field <code>a</code> will have a higher water content
than field <code>b</code>. The data
are in the
file
<a href="http://www.utsc.utoronto.ca/~butler/d29/bellpepper.csv">link</a>.</p>
<ol style="list-style-type: lower-alpha">
<li>Read the file in using <code>read_csv</code>, and
list the resulting data frame.</li>
</ol>
<p>Solution</p>
<p>Reading directly from the URL is easiest:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" data-line-number="1">my_url=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/d29/bellpepper.csv&quot;</span></a>
<a class="sourceLine" id="cb309-2" data-line-number="2">pepper=<span class="kw">read_csv</span>(my_url)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   field = col_character(),
##   water = col_double()
## )</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" data-line-number="1">pepper</a></code></pre></div>
<pre><code>## # A tibble: 30 x 2
##    field water
##    &lt;chr&gt; &lt;dbl&gt;
##  1 a      10.2
##  2 a      10.7
##  3 a      15.5
##  4 a      10.4
##  5 a       9.9
##  6 a      10  
##  7 a      16.6
##  8 a      15.1
##  9 a      15.2
## 10 a      13.8
## # ... with 20 more rows</code></pre>
<p>If you like, find out how many observations you have from each field, thus:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" data-line-number="1">pepper <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(field)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   field     n
##   &lt;chr&gt; &lt;int&gt;
## 1 a        14
## 2 b        16</code></pre>
<p>Fourteen and sixteen.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Make side-by-side boxplots of the water content values for
the two fields. How do the fields seem to compare?</li>
</ol>
<p>Solution</p>
<p>This kind of thing:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" data-line-number="1"><span class="kw">ggplot</span>(pepper,<span class="kw">aes</span>(<span class="dt">x=</span>field,<span class="dt">y=</span>water))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/dartmouth-1.png" width="672"  /></p>
<p>This one is rather interesting: the distribution of water contents for
field <code>a</code> is generally higher than that for field <code>b</code>,
but the median for <code>a</code> is actually <em>lower</em>.</p>
<p>The other reasonable plot is a facetted histogram, something like this:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1"><span class="kw">ggplot</span>(pepper,<span class="kw">aes</span>(<span class="dt">x=</span>water))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">6</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb316-2" data-line-number="2"><span class="kw">facet_grid</span>(field<span class="op">~</span>.)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-37-1.png" width="672"  /></p>
<p>The distribution of water content in field <code>b</code> is actually
bimodal, which is probably the explanation of the funny thing with the
median. What actually seems to be happening (at least for these data)
is that the water content in field B is either about the same as field
A, or a lot less (nothing in between). I can borrow an idea from
earlier to find the five-number summaries for each field:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" data-line-number="1">pepper <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nest</span>(<span class="op">-</span>field) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-2" data-line-number="2"><span class="kw">mutate</span>(<span class="dt">qq=</span><span class="kw">map</span>(data,<span class="op">~</span><span class="kw">enframe</span>(<span class="kw">quantile</span>(.<span class="op">$</span>water)))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-3" data-line-number="3"><span class="kw">unnest</span>(qq) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-4" data-line-number="4"><span class="kw">mutate</span>(<span class="dt">pctile=</span><span class="kw">parse_number</span>(name)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-5" data-line-number="5"><span class="kw">select</span>(<span class="op">-</span>name) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-6" data-line-number="6"><span class="kw">spread</span>(pctile,value)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##   field   `0`  `25`  `50`  `75` `100`
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 a       9.9 10.5   11.4  14.8  16.6
## 2 b       7.1  8.33  11.8  12.6  13.9</code></pre>
<p>This is a weird one: all the quantiles are greater for field A
<em>except</em> for the median.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Do a two-sample <span class="math inline">\(t\)</span>-test to test whether there is evidence
that the mean water
content in field <code>a</code> is higher than that of field
<code>b</code>. What do you conclude? Explain briefly. (You’ll need to
figure out a way of doing a one-sided test, or how to adapt the
results from a two-sided test.)</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" data-line-number="1"><span class="kw">t.test</span>(water<span class="op">~</span>field,<span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>, <span class="dt">data=</span>pepper)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  water by field
## t = 2.0059, df = 27.495, p-value = 0.0274
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  0.2664399       Inf
## sample estimates:
## mean in group a mean in group b 
##        12.52857        10.76875</code></pre>
<p>Note the use of <code>alternative</code> to specify that the first group
mean (that of field <code>a</code>) is bigger than the second, field
<code>b</code>, under the alternative hypothesis.</p>
<p>The P-value, 0.0274, is less than 0.05, so we reject the null (equal
means) in favour of the <code>a</code> mean being bigger than the
<code>b</code> mean: field <code>a</code> really does have a higher mean water
content.</p>
<p>Another way to tackle this is to do a two-sided test and adapt the P-value:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" data-line-number="1"><span class="kw">t.test</span>(water<span class="op">~</span>field, <span class="dt">data=</span>pepper)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  water by field
## t = 2.0059, df = 27.495, p-value = 0.0548
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.03878411  3.55842696
## sample estimates:
## mean in group a mean in group b 
##        12.52857        10.76875</code></pre>
<p>This time we do <em>not</em> go straight to the P-value. First we check
that we are on the correct side, which we are since the sample mean
for field <code>a</code> <em>is</em> bigger than for field <code>b</code>. Then we are
entitled to take the two-sided P-value 0.0548 and <em>halve</em> it to
get the same 0.0274 that we did before.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Is the result of your test consistent with the boxplot, or
not? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The test said that field <code>a</code> had a greater mean water
content. Looking at the boxplot, this is consistent with where the
boxes sit (<code>a</code>’s box is higher up than
<code>b</code>’s). However, it is not consistent with the medians,
where <code>b</code>’s median is actually <em>bigger</em>.
You have two possible right answers here: comparing the boxes with
the test result (they agree) or comparing the medians with the
test result (they disagree). Either is good. If you like, you
could also take the angle that the two boxes overlap a fair bit,
so it is surprising that the test came out significant. (The
resolution of this one is that we have 30 measurements altogether,
14 and 16 in the two groups, so the sample size is not tiny. With
smaller samples, having overlapping boxes would probably lead to a
non-significant difference.)</p>
</div>
<div id="exercise-and-anxiety-and-bullying-mice" class="section level2">
<h2><span class="header-section-number">6.4</span> Exercise and anxiety and bullying mice</h2>
<p>Does exercise help to reduce anxiety?
To assess this, some researchers randomly assigned
mice to either
an enriched environment where there was an exercise wheel available,
or a standard environment with no exercise options. After three weeks
in the specified environment, for five minutes a day for two weeks,
the mice were each exposed to a “mouse bully” — a mouse who was very
strong, aggressive, and territorial. One measure of mouse anxiety is
amount of time hiding in a dark compartment, with mice who are more
anxious spending more time in darkness. The amount of time spent in
darkness is recorded for each of the mice.</p>
<p>The data can be found at
<a href="http://www.utsc.utoronto.ca/~butler/d29/stressedmice.txt">link</a>.</p>
<ol style="list-style-type: lower-alpha">
<li>Read the data into R, and display your data frame. Count the number of mice in each group.</li>
</ol>
<p>Solution</p>
<p>These are aligned columns with spaces in between, so we need <code>read_table</code>:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" data-line-number="1">my_url=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/d29/stressedmice.txt&quot;</span></a>
<a class="sourceLine" id="cb323-2" data-line-number="2">mice=<span class="kw">read_table</span>(my_url)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Time = col_integer(),
##   Environment = col_character()
## )</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" data-line-number="1">mice</a></code></pre></div>
<pre><code>## # A tibble: 14 x 2
##     Time Environment
##    &lt;int&gt; &lt;chr&gt;      
##  1   359 Enriched   
##  2   280 Enriched   
##  3   138 Enriched   
##  4   227 Enriched   
##  5   203 Enriched   
##  6   184 Enriched   
##  7   231 Enriched   
##  8   394 Standard   
##  9   477 Standard   
## 10   439 Standard   
## 11   428 Standard   
## 12   391 Standard   
## 13   488 Standard   
## 14   454 Standard</code></pre>
<p>You can call the data frame whatever you like.</p>
<p>If you must, you can physically count the number of mice in each group, but you ought to get in the habit of coding this kind of thing:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" data-line-number="1">mice <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(Environment)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   Environment     n
##   &lt;chr&gt;       &lt;int&gt;
## 1 Enriched        7
## 2 Standard        7</code></pre>
<p>Seven in each.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Draw side-by-side boxplots of time spent in darkness for each
group of mice.</li>
</ol>
<p>Solution</p>
<p>This:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" data-line-number="1"><span class="kw">ggplot</span>(mice, <span class="kw">aes</span>(<span class="dt">x=</span>Environment, <span class="dt">y=</span>Time))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/artichoke-1.png" width="672"  /></p>
<p>You did remember to put capital letters on the variable names, didn’t you?</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Do the boxplots support the hypothesis about exercise and
anxiety? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The hypothesis about exercise and anxiety is that mice who
exercise more should be less anxious. How does that play out in
this study? Well, mice in the enriched environment at least have
the opportunity to exercise, which the mice in the standard
environment do not, and anxiety is measured by the amount of time
spent in darkness (more equals more anxious).
So we’d expect the mice in the standard environment to spend more
time in darkness, if that hypothesis is correct.
That’s exactly what the boxplots show, with very little
doubt.
<label for="tufte-mn-21" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-21" class="margin-toggle"><span class="marginnote">This means that I would expect to reject a null hypothesis of equal means, but I get ahead of myself.</span>
Your answer needs to make two points: (i) what you would expect to
see, if the hypothesis about anxiety and exercise is true, and
(ii) whether you actually did see it. You can do this either way
around: for example, you can say what you see in the boxplot, and
then make the case that this <em>does</em> support the idea of more
exercise corresponding with less anxiety.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Carry out a <span class="math inline">\(t\)</span>-test for comparing the mean time spent in
darkness for the mice in the two groups. Think carefully about the
details of the <span class="math inline">\(t\)</span>-test (and what you need evidence in favour of).</li>
</ol>
<p>Solution</p>
<p>We are trying to prove that exercise goes with <em>less</em>
anxiety, so a one-sided test is called for. The other thing to
think about is how R organizes the groups for
<code>Environment</code>: in alphabetical order. Thus
<code>Enriched</code> is first (like on the boxplot). We’re trying to
prove that the mean <code>Time</code> is <em>less</em> for
<code>Enriched</code> than for <code>Standard</code>, so we need <code>alternative=&quot;less&quot;</code>:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" data-line-number="1"><span class="kw">with</span>(mice,<span class="kw">t.test</span>(Time<span class="op">~</span>Environment,<span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>))</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Time by Environment
## t = -6.7966, df = 9.1146, p-value = 3.734e-05
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##       -Inf -151.2498
## sample estimates:
## mean in group Enriched mean in group Standard 
##               231.7143               438.7143</code></pre>
<p>A common clue that you have the wrong alternative hypothesis is a P-value coming out close to <em>1</em>, which is what you would have gotten from something like this:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" data-line-number="1"><span class="kw">with</span>(mice,<span class="kw">t.test</span>(Time<span class="op">~</span>Environment,<span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>))</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Time by Environment
## t = -6.7966, df = 9.1146, p-value = 1
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  -262.7502       Inf
## sample estimates:
## mean in group Enriched mean in group Standard 
##               231.7143               438.7143</code></pre>
<p>Here, we looked at the pictures and expected to find a difference, so we expected to find a P-value close to 0 rather than close to 1.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>What do you conclude, in terms of anxiety and exercise (at
least for mice)? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The P-value (from the previous part) is 0.000037, which is way less
than 0.05 (or 0.01 or whatever <span class="math inline">\(\alpha\)</span> you chose). So the null
hypothesis (equal means) is resoundingly rejected in favour of the
one-sided alternative that the mean anxiety (as measured by time
spent in darkness) is less for the mice who (can) exercise.
You need to end up by doing a one-sided test. An alternative to
what I did is to do a two-sided test in the previous part. Then
you can fix it up by recognizing that the means are the right way
around for the research hypothesis (the mean time in darkness is
way less for <code>Enriched</code>), and then dividing the two-sided
P-value by 2. But you need to do the “correct side” thing: just
halving the two-sided P-value is not enough, because the sample
mean for <code>Enriched</code> might have been <em>more</em> than for
<code>Standard</code>.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Does anything in the previous parts suggest any problems with
the analysis you just did? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>Look at the side-by-side boxplots. The strict assumptions hiding
behind the <span class="math inline">\(t\)</span>-tests are that the data in each group come from
normal distributions (equal standard deviations are not
required). Are the data symmetric? Are there any outliers? Well, I
see a high outlier in the <code>Enriched</code> group, so I have some
doubts about the normality. On the other hand, I only have seven
observations in each group, so there is no guarantee even if the
populations from which they come are normal that the samples will
be. So maybe things are not so bad.
This is one of those situations where you make a case and defend it. I
don’t mind so much which case you make, as long as you can defend
it. Thus, something like either of these two is good:</p>
<ul>
<li><p>I see an outlier in the <code>Enriched</code> group. The data
within each group are supposed to be normally distributed, and
the <code>Enriched</code> group is not. So I see a problem.</p></li>
<li><p>I see an outlier in the <code>Enriched</code> group. But the
sample sizes are small, and an apparent outlier could arise by
chance. So I do not see a problem.</p></li>
</ul>
<p>Extra: another way to think about this is normal quantile plots to assess
normality within each group. This uses the facetting trick to get a separate normal quantile plot for each <code>Environment</code>:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" data-line-number="1"><span class="kw">ggplot</span>(mice, <span class="kw">aes</span>(<span class="dt">sample=</span>Time))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb334-2" data-line-number="2"><span class="kw">facet_wrap</span>(<span class="op">~</span>Environment, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-45-1.png" width="672"  /></p>
<p>For the <code>Enriched</code> group, the upper-end outlier shows up. In a
way this plot is no more illuminating than the boxplot, because you
still have to make a call about whether this is “too big”. Bear in
mind also that these facetted normal quantile plots, with two groups,
come out tall and skinny, so vertical deviations from the line are
exaggerated. On this plot, the lowest value also looks too low.</p>
<p>For the <code>Standard</code> group, there are no problems with normality
at all.</p>
<p>What happens if we change the shape of the plots?</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" data-line-number="1"><span class="kw">ggplot</span>(mice, <span class="kw">aes</span>(<span class="dt">sample=</span>Time))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb335-2" data-line-number="2"><span class="kw">facet_wrap</span>(<span class="op">~</span>Environment, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>, <span class="dt">ncol=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-46-1.png" width="672"  /></p>
<p>This makes the plots come out in one column, that is, short and
squat. I prefer these. I’d still call the highest value in
<code>Enriched</code> an outlier, but the lowest value now looks pretty
close to what you’d expect.</p>
</div>
<div id="diet-and-growth-in-boys" class="section level2">
<h2><span class="header-section-number">6.5</span> Diet and growth in boys</h2>
<p>A dietician is studying the effect of
different diets on children’s growth. In part of the study, the
dietician is investigating two religious sects, labelled <code>a</code>
and <code>b</code> in our data set. Both sects are vegetarian; the
difference between them is that people in Sect A only eat vegetables
from below the ground, and Sect B only eats vegetables from above the
ground. The height and weight of the boys
<label for="tufte-mn-22" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-22" class="margin-toggle"><span class="marginnote">This was not sexism, but a recognition that boys and girls will be of different heights for reasons unrelated to diet. Doing it this way makes the analysis simpler.</span> are measured at regular
intervals. The data in
<a href="http://www.utsc.utoronto.ca/~butler/d29/kids-diet.txt">link</a> are the
heights of the boys at age 12.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and find out how many observations you have
and which variables.</li>
</ol>
<p>Solution</p>
<p>The data values are separated by one space, so:</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" data-line-number="1">my_url=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/d29/kids-diet.txt&quot;</span></a>
<a class="sourceLine" id="cb336-2" data-line-number="2">diet=<span class="kw">read_delim</span>(my_url,<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   sect = col_character(),
##   height = col_integer()
## )</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" data-line-number="1">diet</a></code></pre></div>
<pre><code>## # A tibble: 21 x 2
##    sect  height
##    &lt;chr&gt;  &lt;int&gt;
##  1 a        140
##  2 a        140
##  3 a        140
##  4 a        143
##  5 a        135
##  6 a        144
##  7 a        156
##  8 a        149
##  9 a        146
## 10 a        148
## # ... with 11 more rows</code></pre>
<p>21 observations on two variables, <code>sect</code> and
<code>height</code>. (You should state this; it is not enough to make the
reader figure it out for themselves.)</p>
<p>The heights are evidently in centimetres.</p>
<p>You can call the data frame whatever you like.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Obtain side-by-side boxplots of the heights for boys from
each sect. Does it look as if the heights of the boys in each sect
are different? Comment briefly.</li>
</ol>
<p>Solution</p>
<p>The boxplot is the kind of thing we’ve seen before:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" data-line-number="1"><span class="kw">ggplot</span>(diet,<span class="kw">aes</span>(<span class="dt">x=</span>sect,<span class="dt">y=</span>height))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-48-1.png" width="672"  /></p>
<p>It looks to me as if the boys in Sect B are taller on average.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Looking at your boxplots, do you see any problems with
doing a two-sample <span class="math inline">\(t\)</span>-test? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The assumption is that the data in each group are
“approximately normal”. Boxplots don’t tell you about normality specifically,
but they tell you whether there are any outliers (none here) and
something about the shape (via the lengths of the whiskers). I’d
say the Sect A values are as symmetric as we could hope for. For
Sect B, you can say either that they’re skewed to the left (and
that therefore we have a problem), or that the heights are close
enough to symmetric (and that therefore we don’t). For me, either
is good.
As ever, normal quantile plots can offer more insight. With
data in this form, the
two samples are mixed up, but using facets is the way to go. Philosophically, we draw a normal quantile plot of <em>all</em> the heights, and then say at the end that we would actually like a separate plot for each sect:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" data-line-number="1">diet <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample=</span>height))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb341-2" data-line-number="2"><span class="kw">facet_wrap</span>(<span class="op">~</span>sect, <span class="dt">ncol=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="05-two-sample-inference_files/figure-html/unnamed-chunk-49-1.png" width="672"  /></p>
<p>I decided that I wanted short squat plots rather than tall skinny ones.</p>
<p>With the sizes of the samples, I really don’t see any problems
here. Most of the evidence for the left skewness in Sect B is actually coming
from that largest value being too small. Sect A is as good as you
could wish for. Having extreme values being <em>not extreme enough</em> is not a problem, since it won’t be distorting the mean.</p>
<p>The other way of doing this is to use <code>filter</code> to pull out the
rows you want and then feed that into the plot:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" data-line-number="1">secta=<span class="kw">filter</span>(diet,sect<span class="op">==</span><span class="st">&quot;a&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb342-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample=</span>sect))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p>and the same for sect B. This is the usual <code>ggplot</code>-in-pipeline
thing where you don’t have a named data frame in the <code>ggplot</code>
because it will use whatever came out of the previous step of the
pipeline.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Run a <span class="math inline">\(t\)</span>-test to determine whether the mean heights differ
significantly. What do you conclude? Explain briefly. (Run the
<span class="math inline">\(t\)</span>-test even if your previous work suggests that it is not the
right thing to do.)</li>
</ol>
<p>Solution</p>
<p>The wording states that a two-sided test is correct, which is the
default, so you don’t need anything special:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb343-1" data-line-number="1"><span class="kw">t.test</span>(height<span class="op">~</span>sect,<span class="dt">data=</span>diet)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  height by sect
## t = -1.7393, df = 14.629, p-value = 0.103
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -12.007505   1.229728
## sample estimates:
## mean in group a mean in group b 
##        144.8333        150.2222</code></pre>
<p>This is a two-sample test, so it takes a <code>data=</code>.</p>
<p>Our null hypothesis is that the two sects have equal mean height. The
P-value of 0.103 is larger than 0.05, so we do not reject that null
hypothesis. That is, there is no evidence that the sects differ in
mean height. (That is, our earlier thought that the boys in Sect B were taller
is explainable by chance.)</p>
<p>You <em>must</em> end up with a statement about mean heights, and when
you do a test, you must state the conclusion in the context of the
problem, whether I ask you to or not.
“Don’t reject the null hypothesis”
is a step on the way to an answer, not an answer in
itself. If you think it’s an answer in itself, you won’t be of much
use to the world as a statistician.</p>
<p>C32 folks might have been thinking that Mood’s median test was the
thing, if you were worried about that skewness in Sect B. My guess is
that the <span class="math inline">\(t\)</span>-test is the right, so it will be the better test
(and give the smaller P-value) here, but if you want to do it, you
could do it this way:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb345-1" data-line-number="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb345-2" data-line-number="2"><span class="kw">median_test</span>(diet,height,sect)</a></code></pre></div>
<pre><code>## $table
##      above
## group above below
##     a     4     7
##     b     6     3
## 
## $test
##        what     value
## 1 statistic 1.8181818
## 2        df 1.0000000
## 3   P-value 0.1775299</code></pre>
<p>My suspicion (that I wrote before doing the test) is correct: there is
even less evidence of a difference in median height between the
sects. The table shows that both sects are pretty close to 50–50
above and below the overall median, and with sample sizes this small,
they are certainly not significantly different from an even split. The
small frequencies bring a warning about the chi-squared approximation
possibly not working (that <code>smmr</code> suppresses). We had one like
this in C32, but there the result was very significant, and this one
is very non-significant. However, the implication is the same: even if
the P-value is not very accurate (because the expected frequencies for
sect B are both 4.5), the conclusion is unlikely to be wrong because
the P-value is so far from 0.05.</p>

</div>
</div>
<p style="text-align: center;">
<a href="one-sample-inference.html"><button class="btn btn-default">Previous</button></a>
<a href="power-and-sample-size.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>

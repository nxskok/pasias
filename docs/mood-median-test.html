<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Mood median test | Problems and Solutions in Applied Statistics</title>
  <meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Mood median test | Problems and Solutions in Applied Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://ritsokiguess.site/pasias" />
  
  <meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="github-repo" content="nxskok/pasias" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Mood median test | Problems and Solutions in Applied Statistics" />
  
  <meta name="twitter:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  

<meta name="author" content="Ken Butler" />


<meta name="date" content="2021-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-sign-test.html"/>
<link rel="next" href="matched-pairs-t-and-sign-test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Problems and Solutions in Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages-used-somewhere-in-this-book"><i class="fa fa-check"></i>Packages used somewhere in this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>1</b> Getting used to R and R Studio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#running-r-studio-on-jupyterhub"><i class="fa fa-check"></i><b>1.1</b> Running R Studio on Jupyterhub</a></li>
<li class="chapter" data-level="1.2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><i class="fa fa-check"></i><b>1.2</b> Getting an R Studio Cloud account</a></li>
<li class="chapter" data-level="1.3" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a></li>
<li class="chapter" data-level="1.4" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><i class="fa fa-check"></i><b>1.4</b> Reading data from a file</a></li>
<li class="chapter" data-level="1.5" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-files-different-ways"><i class="fa fa-check"></i><b>1.5</b> Reading files different ways</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-in-data.html"><a href="reading-in-data.html"><i class="fa fa-check"></i><b>2</b> Reading in data</a></li>
<li class="chapter" data-level="3" data-path="drawing-graphs.html"><a href="drawing-graphs.html"><i class="fa fa-check"></i><b>3</b> Drawing graphs</a></li>
<li class="chapter" data-level="4" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>4</b> Data exploration</a></li>
<li class="chapter" data-level="5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>5</b> Working with dataframes</a></li>
<li class="chapter" data-level="6" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>6</b> One-sample inference</a></li>
<li class="chapter" data-level="7" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>7</b> Two-sample inference</a></li>
<li class="chapter" data-level="8" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>8</b> Power and sample size</a></li>
<li class="chapter" data-level="9" data-path="the-sign-test.html"><a href="the-sign-test.html"><i class="fa fa-check"></i><b>9</b> The sign test</a></li>
<li class="chapter" data-level="10" data-path="mood-median-test.html"><a href="mood-median-test.html"><i class="fa fa-check"></i><b>10</b> Mood median test</a><ul>
<li class="chapter" data-level="10.1" data-path="mood-median-test.html"><a href="mood-median-test.html#sugar-in-breakfast-cereals"><i class="fa fa-check"></i><b>10.1</b> Sugar in breakfast cereals</a></li>
<li class="chapter" data-level="10.2" data-path="mood-median-test.html"><a href="mood-median-test.html#fear-of-math"><i class="fa fa-check"></i><b>10.2</b> Fear of math</a></li>
<li class="chapter" data-level="10.3" data-path="mood-median-test.html"><a href="mood-median-test.html#medical-instructions"><i class="fa fa-check"></i><b>10.3</b> Medical instructions</a></li>
<li class="chapter" data-level="10.4" data-path="mood-median-test.html"><a href="mood-median-test.html#handspans-revisited"><i class="fa fa-check"></i><b>10.4</b> Handspans revisited</a></li>
<li class="chapter" data-level="10.5" data-path="mood-median-test.html"><a href="mood-median-test.html#sugar-in-breakfast-cereals-1"><i class="fa fa-check"></i><b>10.5</b> Sugar in breakfast cereals</a></li>
<li class="chapter" data-level="10.6" data-path="mood-median-test.html"><a href="mood-median-test.html#fear-of-math-1"><i class="fa fa-check"></i><b>10.6</b> Fear of math</a></li>
<li class="chapter" data-level="10.7" data-path="mood-median-test.html"><a href="mood-median-test.html#medical-instructions-1"><i class="fa fa-check"></i><b>10.7</b> Medical instructions</a></li>
<li class="chapter" data-level="10.8" data-path="mood-median-test.html"><a href="mood-median-test.html#handspans-revisited-1"><i class="fa fa-check"></i><b>10.8</b> Handspans revisited</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="matched-pairs-t-and-sign-test.html"><a href="matched-pairs-t-and-sign-test.html"><i class="fa fa-check"></i><b>11</b> Matched pairs t and sign test</a></li>
<li class="chapter" data-level="12" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html"><i class="fa fa-check"></i><b>12</b> Normal quantile plots</a><ul>
<li class="chapter" data-level="12.1" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><i class="fa fa-check"></i><b>12.1</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.2" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality"><i class="fa fa-check"></i><b>12.2</b> Ferritin and normality</a></li>
<li class="chapter" data-level="12.3" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers-1"><i class="fa fa-check"></i><b>12.3</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.4" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality-1"><i class="fa fa-check"></i><b>12.4</b> Ferritin and normality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>13</b> Analysis of variance</a></li>
<li class="chapter" data-level="14" data-path="writing-reports.html"><a href="writing-reports.html"><i class="fa fa-check"></i><b>14</b> Writing reports</a></li>
<li class="chapter" data-level="15" data-path="learning-to-code.html"><a href="learning-to-code.html"><i class="fa fa-check"></i><b>15</b> Learning to code</a><ul>
<li class="chapter" data-level="15.1" data-path="learning-to-code.html"><a href="learning-to-code.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="learning-to-code.html"><a href="learning-to-code.html#data-and-pre-processing"><i class="fa fa-check"></i><b>15.2</b> Data and pre-processing</a></li>
<li class="chapter" data-level="15.3" data-path="learning-to-code.html"><a href="learning-to-code.html#analysis"><i class="fa fa-check"></i><b>15.3</b> Analysis</a></li>
<li class="chapter" data-level="15.4" data-path="learning-to-code.html"><a href="learning-to-code.html#conclusions-see-note-9"><i class="fa fa-check"></i><b>15.4</b> Conclusions (see note 9)</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="treating-dandruff.html"><a href="treating-dandruff.html"><i class="fa fa-check"></i><b>16</b> Treating dandruff</a><ul>
<li class="chapter" data-level="16.1" data-path="treating-dandruff.html"><a href="treating-dandruff.html#introduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="treating-dandruff.html"><a href="treating-dandruff.html#exploratory-analysis"><i class="fa fa-check"></i><b>16.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="16.3" data-path="treating-dandruff.html"><a href="treating-dandruff.html#analysis-of-variance-1"><i class="fa fa-check"></i><b>16.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="16.4" data-path="treating-dandruff.html"><a href="treating-dandruff.html#assessment-of-assumptions"><i class="fa fa-check"></i><b>16.4</b> Assessment of Assumptions</a></li>
<li class="chapter" data-level="16.5" data-path="treating-dandruff.html"><a href="treating-dandruff.html#conclusions"><i class="fa fa-check"></i><b>16.5</b> Conclusions</a></li>
<li class="chapter" data-level="16.6" data-path="treating-dandruff.html"><a href="treating-dandruff.html#end"><i class="fa fa-check"></i><b>16.6</b> End</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>17</b> Tidying data</a></li>
<li class="chapter" data-level="18" data-path="simple-regression.html"><a href="simple-regression.html"><i class="fa fa-check"></i><b>18</b> Simple regression</a></li>
<li class="chapter" data-level="19" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>19</b> Multiple regression</a></li>
<li class="chapter" data-level="20" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html"><i class="fa fa-check"></i><b>20</b> Regression with categorical variables</a><ul>
<li class="chapter" data-level="20.1" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited"><i class="fa fa-check"></i><b>20.1</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.2" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching"><i class="fa fa-check"></i><b>20.2</b> Pulse rates and marching</a></li>
<li class="chapter" data-level="20.3" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited-1"><i class="fa fa-check"></i><b>20.3</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.4" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching-1"><i class="fa fa-check"></i><b>20.4</b> Pulse rates and marching</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>21</b> Dates and times</a></li>
<li class="chapter" data-level="22" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>22</b> Functions</a></li>
<li class="chapter" data-level="23" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html"><i class="fa fa-check"></i><b>23</b> Vector and matrix algebra</a><ul>
<li class="chapter" data-level="23.1" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again"><i class="fa fa-check"></i><b>23.1</b> Heights and foot lengths again</a></li>
<li class="chapter" data-level="23.2" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again-1"><i class="fa fa-check"></i><b>23.2</b> Heights and foot lengths again</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>24</b> The Bootstrap</a></li>
<li class="chapter" data-level="25" data-path="bayesian-statistics-with-stan.html"><a href="bayesian-statistics-with-stan.html"><i class="fa fa-check"></i><b>25</b> Bayesian Statistics with Stan</a></li>
<li class="chapter" data-level="26" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>26</b> Logistic regression</a></li>
<li class="chapter" data-level="27" data-path="logistic-regression-with-ordinal-response.html"><a href="logistic-regression-with-ordinal-response.html"><i class="fa fa-check"></i><b>27</b> Logistic regression with ordinal response</a></li>
<li class="chapter" data-level="28" data-path="logistic-regression-with-nominal-response.html"><a href="logistic-regression-with-nominal-response.html"><i class="fa fa-check"></i><b>28</b> Logistic regression with nominal response</a></li>
<li class="chapter" data-level="29" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>29</b> Survival analysis</a></li>
<li class="chapter" data-level="30" data-path="analysis-of-variance-revisited.html"><a href="analysis-of-variance-revisited.html"><i class="fa fa-check"></i><b>30</b> Analysis of variance revisited</a></li>
<li class="chapter" data-level="31" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>31</b> Analysis of covariance</a></li>
<li class="chapter" data-level="32" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>32</b> Multivariate analysis of variance</a></li>
<li class="chapter" data-level="33" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i><b>33</b> Repeated measures</a></li>
<li class="chapter" data-level="34" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>34</b> Discriminant analysis</a></li>
<li class="chapter" data-level="35" data-path="hierarchical-cluster-analysis.html"><a href="hierarchical-cluster-analysis.html"><i class="fa fa-check"></i><b>35</b> Hierarchical cluster analysis</a></li>
<li class="chapter" data-level="36" data-path="k-means-cluster-analysis.html"><a href="k-means-cluster-analysis.html"><i class="fa fa-check"></i><b>36</b> K-means cluster analysis</a></li>
<li class="chapter" data-level="37" data-path="drawing-maps-with-leaflet.html"><a href="drawing-maps-with-leaflet.html"><i class="fa fa-check"></i><b>37</b> Drawing maps with Leaflet</a></li>
<li class="chapter" data-level="38" data-path="multidimensional-scaling.html"><a href="multidimensional-scaling.html"><i class="fa fa-check"></i><b>38</b> Multidimensional Scaling</a></li>
<li class="chapter" data-level="39" data-path="principal-components.html"><a href="principal-components.html"><i class="fa fa-check"></i><b>39</b> Principal Components</a><ul>
<li class="chapter" data-level="39.1" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere"><i class="fa fa-check"></i><b>39.1</b> The weather, somewhere</a></li>
<li class="chapter" data-level="39.2" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere-1"><i class="fa fa-check"></i><b>39.2</b> The weather, somewhere</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>40</b> Factor Analysis</a></li>
<li class="chapter" data-level="41" data-path="frequency-table-analysis.html"><a href="frequency-table-analysis.html"><i class="fa fa-check"></i><b>41</b> Frequency table analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Problems and Solutions in Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mood-median-test" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Mood median test</h1>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb47-2" title="2"><span class="kw">library</span>(smmr)</a></code></pre></div>
<div id="sugar-in-breakfast-cereals" class="section level2">
<h2><span class="header-section-number">10.1</span> Sugar in breakfast cereals</h2>
<p>The data for this question are in
<a href="http://ritsokiguess.site/datafiles/cereal-sugar.txt">http://ritsokiguess.site/datafiles/cereal-sugar.txt</a>. The
story here is whether breakfast cereals marketed to children have a
lot of sugar in them; in particular, whether they have more sugar on
average than cereals marketed to adults.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data (to R) and display the data set. Do you have
a variable that distinguishes the children’s cereals from the
adults’ cereals, and another that contains the amount of sugar?</p></li>
<li><p>Calculate the mean sugar content for each group of cereals (the
adults’ ones and the children’s ones). Do they look similar or different?</p></li>
<li><p>Make side-by-side boxplots of the sugar contents of the two
types of cereal. What do you see that is out of the ordinary?</p></li>
<li><p>Explain briefly why you would not trust a two-sample <span class="math inline">\(t\)</span>-test
with these data. (That is, say what the problem is, and why it’s a
problem.)</p></li>
<li><p>Run a suitable test to see whether the “typical” amount of
sugar differs between adult’s and children’s cereals. Justify the test
that you run. (You can use the version of your test that lives in a
package, if that is easier for you.) What do you conclude, in the
context of the data?</p></li>
</ol>
</div>
<div id="fear-of-math" class="section level2">
<h2><span class="header-section-number">10.2</span> Fear of math</h2>
<p>Two new short courses have been proposed for helping
students who suffer from severe math phobia. The courses are labelled
A and B. Ten students were randomly allocated to one of these two
courses, and each student’s score on a math phobia test was recorded
after they completed their course. The math phobia test produces
whole-number scores between 0 and 10, with a higher score indicating a
greater fear of mathematics. The data can be found in
<a href="http://ritsokiguess.site/datafiles/mathphobia.txt">link</a>. We start
with R for this question.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data and check, however you like, that you have 10
observations, 5 from each course.</p></li>
<li><p>Do a two-sample <span class="math inline">\(t\)</span>-test to assess whether there is a
difference in mean phobia scores after the students have taken the two
courses. What do you conclude? (You have no <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
reason to
suppose that a particular one of the tests will produce a higher mean
than the other, so do a two-sided test.)</p></li>
<li><p>Draw boxplots of the math phobia scores for each group (one
line of code). What is the most striking thing that you notice?</p></li>
<li><p>Explain briefly why a <span class="math inline">\(t\)</span>-test would not be good for these
data. (There are two things that you need to say.)</p></li>
<li><p>Run a suitable test to compare the “typical” scores for the
two courses. (You can use the version from a package rather than
building your own.) What do you conclude?</p></li>
</ol>
</div>
<div id="medical-instructions" class="section level2">
<h2><span class="header-section-number">10.3</span> Medical instructions</h2>
<p>Do people understand medical instructions better at certain
times of the day? In a study, students in a grade 12 class are
randomly divided into two groups, A and B. All students see a video
describing how to use an infant forehead thermometer. The students in
Group A see the video at 8:30 am, while the students in Group B see
the same video at 3:00 pm (on the same day). The next day, all the
students are given a test on the material in the video (graded out of
100). The observed scores are in
<a href="http://ritsokiguess.site/datafiles/forehead.txt">link</a> (values
separated by spaces).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read the data into R and display the (first ten) values.</p></li>
<li><p>Obtain a suitable plot that will enable you to assess the
assumptions for a two-sample <span class="math inline">\(t\)</span>-test.</p></li>
<li><p>Why might you have doubts about using a two-sample <span class="math inline">\(t\)</span>-test here?</p></li>
<li><p>Run Mood’s median test as in class (<em>without</em> using
<code>smmr</code>). What do you conclude, in the context of the data?
What recommendation would you make about the time of day to see the
video? (You might get a warning about “chisquared approximation being incorrect”,
which you can ignore here.)</p></li>
<li><p>Run Mood’s median test on these data using my <code>smmr</code>
package, and verify that you get the same answer.</p></li>
</ol>
</div>
<div id="handspans-revisited" class="section level2">
<h2><span class="header-section-number">10.4</span> Handspans revisited</h2>
<p>Take your right hand, and stretch the fingers out as far as
you can. The distance between the tip of your thumb and the tip of
your little (pinky) finger is your handspan. The students in a
Statistics class at Penn State measured their handspans and also
whether they identified as male or female. The data are at <a href="http://ritsokiguess.site/datafiles/handspan.txt">http://ritsokiguess.site/datafiles/handspan.txt</a>,
with handspans
measured in inches. We want to
see whether male students have a larger mean handspan than female students.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in and display (some of) the data.</p></li>
<li><p>Make a suitable (facetted) normal quantile plot of the data. (Bear in
mind what is supposed to have a normal distribution.)</p></li>
<li><p>Discuss briefly whether you might prefer to use Mood’s median
test to compare the handspans of the male and female students,
compared to a two-sample <span class="math inline">\(t\)</span>-test.</p></li>
<li><p>Run Mood’s median test. What do you conclude from the test, in the context of the data?</p></li>
</ol>
<p>My solutions follow:</p>
</div>
<div id="sugar-in-breakfast-cereals-1" class="section level2">
<h2><span class="header-section-number">10.5</span> Sugar in breakfast cereals</h2>
<p>The data for this question are in
<a href="http://ritsokiguess.site/datafiles/cereal-sugar.txt">http://ritsokiguess.site/datafiles/cereal-sugar.txt</a>. The
story here is whether breakfast cereals marketed to children have a
lot of sugar in them; in particular, whether they have more sugar on
average than cereals marketed to adults.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data (to R) and display the data set. Do you have
a variable that distinguishes the children’s cereals from the
adults’ cereals, and another that contains the amount of sugar?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">my_url=<span class="st">&quot;http://ritsokiguess.site/datafiles/cereal-sugar.txt&quot;</span></a>
<a class="sourceLine" id="cb48-2" title="2">cereals=<span class="kw">read_delim</span>(my_url,<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   who = col_character(),
##   sugar = col_double()
## )</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">cereals</a></code></pre></div>
<pre><code>## # A tibble: 40 x 2
##    who      sugar
##    &lt;chr&gt;    &lt;dbl&gt;
##  1 children  40.3
##  2 children  55  
##  3 children  45.7
##  4 children  43.3
##  5 children  50.3
##  6 children  45.9
##  7 children  53.5
##  8 children  43  
##  9 children  44.2
## 10 children  44  
## # … with 30 more rows</code></pre>
<p>The variable <code>who</code> is a categorical variable saying who the
cereal is intended for, and the variable <code>sugar</code> says how much
sugar each cereal has.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Calculate the mean sugar content for each group of cereals (the
adults’ ones and the children’s ones). Do they look similar or different?</li>
</ol>
<p>Solution</p>
<p><code>group_by</code> and <code>summarize</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">cereals <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(who) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">summarize</span>(<span class="dt">sugar_mean=</span><span class="kw">mean</span>(sugar))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   who      sugar_mean
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 adults         10.9
## 2 children       46.6</code></pre>
<p>These means look very different, though it would be better to look at
a boxplot (coming up in a moment).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Make side-by-side boxplots of the sugar contents of the two
types of cereal. What do you see that is out of the ordinary?</li>
</ol>
<p>Solution</p>
<p>The usual:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">ggplot</span>(cereals,<span class="kw">aes</span>(<span class="dt">x=</span>who,<span class="dt">y=</span>sugar))<span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>I see outliers: two high ones on the adults’ cereals, and one high and
one low on the children’s cereals.</p>
<p>My thought above about the means being very different is definitely supported by the medians being very different on the boxplots. We should have no trouble declaring that the “typical” amounts of sugar in the adults’ and children’s cereals are different.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Explain briefly why you would not trust a two-sample <span class="math inline">\(t\)</span>-test
with these data. (That is, say what the problem is, and why it’s a
problem.)</li>
</ol>
<p>Solution</p>
<p>The problem is the outliers (which is rather a giveaway), but the
reason it’s a problem is that the two-sample <span class="math inline">\(t\)</span>-test assumes
(approximately) normal data, and a normal distribution doesn’t
have outliers.
Not only do you need to note the outliers, but you also need to
say why the outliers cause a problem <em>in this case</em>. Anything
less than that is not a complete answer.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Run a suitable test to see whether the “typical” amount of
sugar differs between adult’s and children’s cereals. Justify the test
that you run. (You can use the version of your test that lives in a
package, if that is easier for you.) What do you conclude, in the
context of the data?</li>
</ol>
<p>Solution</p>
<p>Having ruled out the two-sample <span class="math inline">\(t\)</span>-test, we are left with Mood’s
median test. I didn’t need you to build it yourself, so you can
use package <code>smmr</code> to run it with:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">median_test</span>(cereals,sugar,who)</a></code></pre></div>
<pre><code>## $table
##           above
## group      above below
##   adults       2    19
##   children    18     1
## 
## $test
##        what        value
## 1 statistic 2.897243e+01
## 2        df 1.000000e+00
## 3   P-value 7.341573e-08</code></pre>
<p>We conclude that there <em>is</em> a difference between the median
amounts of sugar between the two groups of cereals, the P-value of 0.00000007
being extremely small.</p>
<p>Why did it come out so small? Because the amount of sugar was smaller
than the overall median for almost all the adult cereals, and larger
than the overall median for almost all the children’s ones. That is,
the children’s cereals really do have more sugar.</p>
<p>Mood’s median test doesn’t come with a confidence interval (for the
difference in population medians), because whether or not a certain
difference in medians is rejected depends on what those medians
actually are, and the idea of the duality of the test and CI doesn’t
carry over as we would like.</p>
<p>My daughter likes chocolate Cheerios, but she also likes Shredded
Wheat and <em>Bran Flakes</em>. Go figure. (Her current favourite is
Raisin Bran, even though she doesn’t like raisins by themselves.)</p>
<p>Mood’s median test is the test we should trust, but you might be
curious about how the <span class="math inline">\(t\)</span>-test stacks up here:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">t.test</span>(sugar<span class="op">~</span>who,<span class="dt">data=</span>cereals)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  sugar by who
## t = -11.002, df = 37.968, p-value = 2.278e-13
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -42.28180 -29.13925
## sample estimates:
##   mean in group adults mean in group children 
##               10.90000               46.61053</code></pre>
<p>The P-value is <em>even smaller</em>, and we have the advantage of
getting a confidence interval for the difference in means: from about
30 to about 40 units less sugar in the adult cereals. Whatever the
units were.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="fear-of-math-1" class="section level2">
<h2><span class="header-section-number">10.6</span> Fear of math</h2>
<p>Two new short courses have been proposed for helping
students who suffer from severe math phobia. The courses are labelled
A and B. Ten students were randomly allocated to one of these two
courses, and each student’s score on a math phobia test was recorded
after they completed their course. The math phobia test produces
whole-number scores between 0 and 10, with a higher score indicating a
greater fear of mathematics. The data can be found in
<a href="http://ritsokiguess.site/datafiles/mathphobia.txt">link</a>. We start
with R for this question.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and check, however you like, that you have 10
observations, 5 from each course.</li>
</ol>
<p>Solution</p>
<p>This doesn’t need much comment:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/mathphobia.txt&quot;</span></a>
<a class="sourceLine" id="cb59-2" title="2">math &lt;-<span class="st"> </span><span class="kw">read_delim</span>(my_url, <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   course = col_character(),
##   phobia = col_double()
## )</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">math</a></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    course phobia
##    &lt;chr&gt;   &lt;dbl&gt;
##  1 a           8
##  2 a           7
##  3 a           7
##  4 a           6
##  5 a           6
##  6 b           9
##  7 b           8
##  8 b           7
##  9 b           2
## 10 b           1</code></pre>
<p>This will do, counting the <code>a</code> and <code>b</code>. Or, to save
yourself that trouble:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">math <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(course)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   course     n
##   &lt;chr&gt;  &lt;int&gt;
## 1 a          5
## 2 b          5</code></pre>
<p>Five each. The story is to get the computer to do the grunt work for
you, if you can make it do so. Other ways:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">math <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(course) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">count =</span> <span class="kw">n</span>())</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   course count
##   &lt;chr&gt;  &lt;int&gt;
## 1 a          5
## 2 b          5</code></pre>
<p>and this:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">with</span>(math, <span class="kw">table</span>(course))</a></code></pre></div>
<pre><code>## course
## a b 
## 5 5</code></pre>
<p>giving the same answer. Lots of ways.</p>
<p>Extra: there is an experimental design issue here. You might have noticed that each student did only <em>one</em> of the courses. Couldn’t students do both, in a matched-pairs kind of way? Well, it’s a bit like the kids learning to read in that if the first of the courses reduces a student’s anxiety, the second course won’t appear to do much good (even if it actually would have been helpful had the student done that one first). This is the same idea as the kids learning to read: once you’ve learned to read, you’ve learned to read, and learning to read a second way won’t help much. The place where matched pairs scores is when you can “wipe out” the effect of one treatment before a subject gets the other one. We have an example of kids throwing baseballs and softballs that is like that: if you throw one kind of ball, that won’t affect how far you can throw the other kind.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Do a two-sample <span class="math inline">\(t\)</span>-test to assess whether there is a
difference in mean phobia scores after the students have taken the two
courses. What do you conclude? (You have no <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
reason to
suppose that a particular one of the tests will produce a higher mean
than the other, so do a two-sided test.)</li>
</ol>
<p>Solution</p>
<p>A two-sided test is the default, so there is not much to do here:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">t.test</span>(phobia <span class="op">~</span><span class="st"> </span>course, <span class="dt">data =</span> math)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  phobia by course
## t = 0.83666, df = 4.4199, p-value = 0.4456
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.076889  5.876889
## sample estimates:
## mean in group a mean in group b 
##             6.8             5.4</code></pre>
<p>The P-value of 0.4456 is nowhere near less than 0.05, so there is no
evidence at all that the<br />
mean math phobia scores are different between the two courses.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Draw boxplots of the math phobia scores for each group (one
line of code). What is the most striking thing that you notice?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">ggplot</span>(math, <span class="kw">aes</span>(<span class="dt">x =</span> course, <span class="dt">y =</span> phobia)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>Boxplot <code>a</code> is just weird. The bar across the middle is
actually at the top, and it has no bottom. (Noting something sensible
like this is enough.) Boxplot <code>b</code> is hugely spread
out.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p>By way of explanation: the course <code>a</code> scores have a number of
values equal so that the 3rd quartile and the median are the name, and
also that the first quartile and the minimum value are the same:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">tmp &lt;-<span class="st"> </span>math <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(course <span class="op">==</span><span class="st"> &quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb72-2" title="2">tmp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(phobia)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   phobia     n
##    &lt;dbl&gt; &lt;int&gt;
## 1      6     2
## 2      7     2
## 3      8     1</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">summary</span>(tmp)</a></code></pre></div>
<pre><code>##     course              phobia   
##  Length:5           Min.   :6.0  
##  Class :character   1st Qu.:6.0  
##  Mode  :character   Median :7.0  
##                     Mean   :6.8  
##                     3rd Qu.:7.0  
##                     Max.   :8.0</code></pre>
<p>The phobia scores from course A are two 6’s, two 7’s and an 8. The
median and third quartile are both 7, and the first quartile is the
same as the lowest value, 6.</p>
<p>Technique note: I wanted to do two things with the phobia scores from
course A: count up how many of each score, and show you what the
five-number summary looks like. One pipe won’t do this (the pipe
“branches”), so I saved what I needed to use, before it branched,
into a data frame <code>tmp</code> and then used <code>tmp</code> twice. Pipes
are powerful, but not <em>all</em>-powerful.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Explain briefly why a <span class="math inline">\(t\)</span>-test would not be good for these
data. (There are two things that you need to say.)</li>
</ol>
<p>Solution</p>
<p>The easiest way to structure this is to ask yourself first what the
<span class="math inline">\(t\)</span>-test needs, and second whether you have it.
The <span class="math inline">\(t\)</span>-test assumes (approximately) normal data. The boxplot for
group <code>a</code> doesn’t even look symmetric, and the one for group
<code>b</code> has an oddly asymmetric box. So I think the normality is
in question here, and therefore another test would be
better. (This is perhaps a bit glib of an answer, since there are
only 5 values in each group, and so they can certainly look
non-normal even if they actually are normal, but these values are
all integers, so it is perhaps wise to be cautious.)
We have the machinery to assess the normality for these, in one shot:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">ggplot</span>(math, <span class="kw">aes</span>(<span class="dt">sample =</span> phobia)) <span class="op">+</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>course, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>I don’t know what <em>you</em> make of those, but they both look pretty
straight to me (and there are only five observations, so it’s hard to
judge). Course <code>b</code> maybe has a “hole” in it (three large
values and two small ones). Maybe. I dunno. What I would <em>really</em>
be worried about is outliers, and at least we don’t have those.
I mentioned in class that the <span class="math inline">\(t\)</span>-tests are robust to non-normality. I
ought to have expanded on that a bit: what really makes the <span class="math inline">\(t\)</span>-test
still behave itself with non-normality is when you have <em>large</em>
samples, that is, when the Central Limit Theorem has had a chance to
take hold. (That’s what drives the normality not really being
necessary in most cases.) But, even with small samples, exact
normality doesn’t matter so much. Here, we have two tiny samples, and
so we have to insist a bit more, but only a bit more, on a
more-or-less normal shape in each group. (It’s kind of a double
jeopardy in that the situation where normality matters most, namely
with small samples, is where it’s the hardest to judge, because
samples of size 5 even from a normal distribution can look very
non-normal.)
But, the biggest threats to the <span class="math inline">\(t\)</span>-test are big-time skewness and
outliers, and we are not suffering too badly from those.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Run a suitable test to compare the “typical” scores for the
two courses. (You can use the version from a package rather than
building your own.) What do you conclude?</li>
</ol>
<p>Solution</p>
<p>This is an invite to use <code>smmr</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">median_test</span>(math, phobia, course)</a></code></pre></div>
<pre><code>## $table
##      above
## group above below
##     a     1     2
##     b     2     2
## 
## $test
##        what     value
## 1 statistic 0.1944444
## 2        df 1.0000000
## 3   P-value 0.6592430</code></pre>
<p>We are nowhere near rejecting equal medians; in fact, both courses are
very close to 50–50 above and below the overall median.</p>
<p>If you look at the frequency table, you might be confused by
something: there were 10 observations, but there are only <span class="math inline">\(1+2+2+2=7\)</span>
in the table. This is because three of the observations were equal to
the overall median, and had to be thrown away:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">math <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">med =</span> <span class="kw">median</span>(phobia))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     med
##   &lt;dbl&gt;
## 1     7</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">math <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(phobia)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   phobia     n
##    &lt;dbl&gt; &lt;int&gt;
## 1      1     1
## 2      2     1
## 3      6     2
## 4      7     3
## 5      8     2
## 6      9     1</code></pre>
<p>The overall median was 7. Because the actual data were really discrete
(the phobia scores could only be whole numbers), we risked losing a
lot of our data when we did this test (and we didn’t have much to
begin with). The other thing to say is that with small sample sizes,
the frequencies in the table have to be <em>very</em> lopsided for you
to have a chance of rejecting the null. Something like this is what
you’d need:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb83-2" title="2">g &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb83-3" title="3">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(x, g)</a>
<a class="sourceLine" id="cb83-4" title="4"><span class="kw">median_test</span>(d, x, g)</a></code></pre></div>
<pre><code>## $table
##      above
## group above below
##     1     0     3
##     2     4     0
## 
## $test
##        what       value
## 1 statistic 7.000000000
## 2        df 1.000000000
## 3   P-value 0.008150972</code></pre>
<p>I faked it up so that we had 10 observations, three of which were
equal to the overall median. Of the rest, all the small ones were in
group 1 and all the large ones were in group 2. This is lopsided
enough to reject with, though, because of the small frequencies, there
actually was a warning about
“chi-squared approximation may be inaccurate.”<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="medical-instructions-1" class="section level2">
<h2><span class="header-section-number">10.7</span> Medical instructions</h2>
<p>Do people understand medical instructions better at certain
times of the day? In a study, students in a grade 12 class are
randomly divided into two groups, A and B. All students see a video
describing how to use an infant forehead thermometer. The students in
Group A see the video at 8:30 am, while the students in Group B see
the same video at 3:00 pm (on the same day). The next day, all the
students are given a test on the material in the video (graded out of
100). The observed scores are in
<a href="http://ritsokiguess.site/datafiles/forehead.txt">link</a> (values
separated by spaces).</p>
<ol style="list-style-type: lower-alpha">
<li>Read the data into R and display the (first ten) values.</li>
</ol>
<p>Solution</p>
<p>Separated by spaces, so <code>read_delim</code>:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/forehead.txt&quot;</span></a>
<a class="sourceLine" id="cb85-2" title="2">instr &lt;-<span class="st"> </span><span class="kw">read_delim</span>(my_url, <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   group = col_character(),
##   score = col_double()
## )</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">instr</a></code></pre></div>
<pre><code>## # A tibble: 18 x 2
##    group score
##    &lt;chr&gt; &lt;dbl&gt;
##  1 A        88
##  2 A        89
##  3 A        79
##  4 A       100
##  5 A        98
##  6 A        89
##  7 A        65
##  8 A        94
##  9 A        95
## 10 A        91
## 11 B        87
## 12 B        69
## 13 B        78
## 14 B        79
## 15 B        83
## 16 B        90
## 17 B        85
## 18 B        58</code></pre>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Obtain a suitable plot that will enable you to assess the
assumptions for a two-sample <span class="math inline">\(t\)</span>-test.</li>
</ol>
<p>Solution</p>
<p>We need the values in each group to be approximately normally
distributed. Side-by-side boxplots will do it:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">ggplot</span>(instr, <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> score)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>or, if you like, separate (facetted) normal quantile plots, which I
would do this way:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">ggplot</span>(instr, <span class="kw">aes</span>(<span class="dt">sample =</span> score)) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb90-3" title="3"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>group, <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Why might you have doubts about using a two-sample <span class="math inline">\(t\)</span>-test here?</li>
</ol>
<p>Solution</p>
<p>We are looking for non-normality in at least one of the
groups. Here, both groups have an outlier at the low end that
would be expected to pull the mean downward. I don’t think there
is left-skewness here, since there is no particular evidence of
the high-end values being bunched up: the problem in both cases
with normality is at the low end.
One way or another, I’m expecting you to have noticed the outliers.
Extra: last year, when I first drew the normal quantile plots,
there was no <code>stat_qq_line</code>, so you had to imagine where
the line went if you did it this way. Without the line, these
plots look somewhat curved, which would have pointed to
left-skewness, but now we see that the lowest observation is too
low, and maybe the second-lowest one as well, while the other
observations are just fine.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Run Mood’s median test as in class (<em>without</em> using
<code>smmr</code>). What do you conclude, in the context of the data?
What recommendation would you make about the time of day to see the
video? (You might get a warning about “chisquared approximation being incorrect”,
which you can ignore here.)</li>
</ol>
<p>Solution</p>
<p>The overall median first:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">instr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">med =</span> <span class="kw">median</span>(score))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     med
##   &lt;dbl&gt;
## 1  87.5</code></pre>
<p>87.5, which is not equal to any of the data values (they are all
integers). This will avoid any issues with values-equal-to-median later.</p>
<p>Then, create and save a table of the value by group and above/below
median. You can count either above or below (it comes out equivalently
either way):</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">tab &lt;-<span class="st"> </span><span class="kw">with</span>(instr, <span class="kw">table</span>(group, score <span class="op">&gt;</span><span class="st"> </span><span class="fl">87.5</span>))</a>
<a class="sourceLine" id="cb93-2" title="2">tab</a></code></pre></div>
<pre><code>##      
## group FALSE TRUE
##     A     2    8
##     B     7    1</code></pre>
<p>Then, chi-squared test for independence (the null) or association of
some kind (the alternative). The <code>correct=F</code> is saying not to
do Yates’s correction, so that it would come out the same if you were
doing it by hand (“observed minus expected, squared, divided by expected”
and all that stuff).</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">chisq.test</span>(tab, <span class="dt">correct =</span> F)</a></code></pre></div>
<pre><code>## Warning in chisq.test(tab, correct = F): Chi-squared approximation may be
## incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tab
## X-squared = 8.1, df = 1, p-value = 0.004427</code></pre>
<p>The P-value is 0.0044, which is (much) smaller than 0.05, and
therefore you can reject independence and conclude association: that
is, whether a student scores above or below the median depends on
which group they are in, or, that the median scores are different for
the two groups.</p>
<p>The warning is because the expected frequencies are on the small side
(if you have done this kind of problem by hand, you might remember
something about “expected frequencies less than 5”. This is that.)
Here, the P-value is so small that we can afford to have it be
inaccurate by a bit and still not affect the conclusion, so I think we
are safe.</p>
<p>As for which group is better, well, the easiest way is to go back to
your boxplots and see that the median for group A (8:30 am) is
substantially higher than for group B (3:00pm). But you can also see
it from your frequency table, if you displayed it:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">tab</a></code></pre></div>
<pre><code>##      
## group FALSE TRUE
##     A     2    8
##     B     7    1</code></pre>
<p>Most of the people in the 8:30 am group scored above the median, and
most of the people in the 3:00 pm group scored below the median. So
the scores at 8:30 am were better overall.</p>
<p>As I write this, it is just after 3:00 pm and I am about to make
myself a pot of tea!</p>
<p>Extra: about that <code>correct=F</code> thing. There was a point of view for a
long time that when you are dealing with a <span class="math inline">\(2 \times 2\)</span> table, you can
get better P-values by, before squaring “observed minus expected”,
taking 0.5 away from the absolute value of the difference. This is
called Yates’s correction. It is in the same spirit as the
“continuity correction” that you might have encountered in the
normal approximation to the binomial, where in the binomial you have
to have a whole number of successes, but the normal allows fractional
values as well. In about the 1960s, the usefulness of Yates’s
correction was shot down, for general contingency tables. There is,
however, one case where it <em>is</em> useful, and that is the case
where the row totals and column totals are <em>fixed</em>.</p>
<p>What do I mean by that? Well, first let’s look at a case where the
totals are <em>not</em> all fixed. Consider a survey in which you want
to see whether males and females agree or disagree on some burning
issue of the day. You collect random samples of, say, 500 males and
500 females, and you count how many of them say Yes or No to your
statement.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>
You might get results like this:</p>
<pre><code>
Yes  No  Total
Males    197 303   500
Females  343 157   500
Total    540 460  1000
</code></pre>
<p>In this table, the row totals must be 500, because you asked this many
males and this many females, and each one must have answered
something. The column totals, however, are not fixed: you didn’t know,
ahead of time, that 540 people would answer “yes”. That was just the
way the data turned out, and if you did another survey with the same
design, you’d probably get a different number of people saying
“yes”.</p>
<p>For another example, let’s go back to Fisher (yes, <em>that</em>
Fisher). A “lady” of his acquaintance claimed to be able, by
drinking a cup of tea with milk and sugar in it, whether the milk or
the sugar had been added first. Fisher, or, more likely, his
housekeeper, prepared 8 cups of tea, 4 with milk first and 4 with
sugar first. The lady knew that four of the cups had milk first, and
her job was to say which four. The results might have been like this:</p>
<pre><code>
Actual 
Milk first  sugar first  Total
Lady   Milk first        3            1         4
says   sugar first       1            3         4
Total             4            4         8
</code></pre>
<p>This time, all of the row totals and all of the column totals must be
4, regardless of what the lady thinks. Even if she thinks 5 of the
cups of tea actually had milk first, she is going to pick 4 of them to
say that they have milk first, since she knows there are only 4. In
this case, all of the row and column totals are fixed at 4, and the
right analysis is called Fisher’s Exact Test, based on the
hypergeometric distribution. In a <span class="math inline">\(2\times 2\)</span> table like this one,
there is only one “degree of freedom”, since as soon as you specify
one of the frequencies, say the number of cups where the lady said
milk first and they actually were milk first, you can work out the
others. But, leaving that aside, the usual chi-squared analysis is a
perfectly good approximation, especially if the frequencies are large,
and especially if you use Yates’s correction.</p>
<p>It is clear that Fisher must have been English, since he was able to
get a publication out of drinking tea.</p>
<p>How does that apply to Mood’s median test? Well, let’s remind
ourselves of the table we had:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">tab</a></code></pre></div>
<pre><code>##      
## group FALSE TRUE
##     A     2    8
##     B     7    1</code></pre>
<p>We know how many students were in each group: 10 in group A and 8 in
B. So the row totals are fixed. What about the columns? These are
whether each observation was above or below the overall median. There
were 18 observations altogether, so there <em>must</em> be 9 above and 9
below.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
So the column totals are fixed as well. All
totals fixed, so we should be using Yates’s correction. I didn’t,
because I wanted to keep things simple, but I should have done.</p>
<p>R’s <code>chisq.test</code> by default <em>always</em> uses Yates’s
correction, and if you don’t want it, you have to say
<code>correct=F</code>. Which is why I have been doing so all through.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Run Mood’s median test on these data using my <code>smmr</code>
package, and verify that you get the same answer.</li>
</ol>
<p>Solution</p>
<p>Not much to it, since the data is already read in:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">median_test</span>(instr, score, group)</a></code></pre></div>
<pre><code>## $table
##      above
## group above below
##     A     8     2
##     B     1     7
## 
## $test
##        what       value
## 1 statistic 8.100000000
## 2        df 1.000000000
## 3   P-value 0.004426526</code></pre>
<p>Identical, test statistic, degrees of freedom and P-value. The table
of frequencies is also the same, just with columns rearranged. (In
<code>smmr</code> I counted the number of values below the overall median,
whereas in my build-it-yourself I counted the number of
values above.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="handspans-revisited-1" class="section level2">
<h2><span class="header-section-number">10.8</span> Handspans revisited</h2>
<p>Take your right hand, and stretch the fingers out as far as
you can. The distance between the tip of your thumb and the tip of
your little (pinky) finger is your handspan. The students in a
Statistics class at Penn State measured their handspans and also
whether they identified as male or female. The data are at <a href="http://ritsokiguess.site/datafiles/handspan.txt">http://ritsokiguess.site/datafiles/handspan.txt</a>,
with handspans
measured in inches. We want to
see whether male students have a larger mean handspan than female students.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in and display (some of) the data.</li>
</ol>
<p>Solution</p>
<p>Delimited by a single space, so:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/handspan.txt&quot;</span></a>
<a class="sourceLine" id="cb106-2" title="2">span &lt;-<span class="st"> </span><span class="kw">read_delim</span>(my_url, <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   sex = col_character(),
##   handspan = col_double()
## )</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">span</a></code></pre></div>
<pre><code>## # A tibble: 190 x 2
##    sex   handspan
##    &lt;chr&gt;    &lt;dbl&gt;
##  1 M         21.5
##  2 M         22.5
##  3 M         23.5
##  4 F         20  
##  5 F         19  
##  6 F         20.5
##  7 F         20.5
##  8 F         20.2
##  9 M         23  
## 10 M         24.5
## # … with 180 more rows</code></pre>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Make a suitable (facetted) normal quantile plot of the data. (Bear in
mind what is supposed to have a normal distribution.)</li>
</ol>
<p>Solution</p>
<p>Here, we need <em>each</em> group to be approximately
normal, so make normal quantile plots of handspan, facetted by sex:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">ggplot</span>(span, <span class="kw">aes</span>(<span class="dt">sample=</span>handspan)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="kw">facet_wrap</span>(<span class="op">~</span>sex)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Discuss briefly whether you might prefer to use Mood’s median
test to compare the handspans of the male and female students,
compared to a two-sample <span class="math inline">\(t\)</span>-test.</li>
</ol>
<p>Solution</p>
<p>A two-sample <span class="math inline">\(t\)</span>-test assumes that each of the two samples comes
from a (approximately) normal distribution (“the data
are normal” is not precise enough). The female values, on the left, definitely have some
outliers at the low end (or a long lower tail), so these are
definitely not normal.
The male values (on the right) are
slightly skewed to the left, or there are some mild outliers at the low end, or, if you prefer, these are
approximately normal.
(You need discussion of each of the males and
females, or of why looking at one group is enough.) Because the males are not close enough to normal (or,
because neither group is close enough to normal), we would prefer
to use Mood’s median test. (Say this.) You do yourself a favour by making it clear that you know that <em>both</em> groups have to be normal enough;
if one is good but the other is not, that is not enough.</p>
<p>The other relevant issue is sample size. The best answer discusses that as well, even though you have a lot to think about already. This data set has 190 observations in it, so the samples must be pretty big:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">span <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(sex)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   sex       n
##   &lt;chr&gt; &lt;int&gt;
## 1 F       103
## 2 M        87</code></pre>
<p>With these sample sizes, we can expect a lot of help from the central limit theorem. The apparent outliers in the males won’t be a problem, and maybe we could even get away with those
outliers in the females.</p>
<p>Extra: you could also think about bootstrapped sampling distributions of the sample mean here. The one we are most concerned about is the females; if it turns out that they are all right, then the males must be all right too, since the plot for them is showing less non-normality (or, without the double negative, is closer to being normal). So let’s do the females:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">span <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="st">  </span><span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;F&quot;</span>) -&gt;<span class="st"> </span>females </a>
<a class="sourceLine" id="cb113-3" title="3"><span class="kw">tibble</span>(<span class="dt">sim =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-4" title="4"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_sample =</span> <span class="kw">list</span>(<span class="kw">sample</span>(females<span class="op">$</span>handspan, <span class="dt">replace =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">my_mean =</span> <span class="kw">mean</span>(my_sample)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> my_mean)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>My take is that the sampling distribution of the sample mean for the females is normal enough, therefore the one for the males is also normal enough, therefore the two-sample <span class="math inline">\(t\)</span>-test is actually fine.</p>
<p>The reason that this one is close to normal is different from the other one, though. In the other question, we had milder non-normality but a smaller sample; in this one, the data distribution is less normal, but we had a much larger sample size to compensate.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Run Mood’s median test. What do you conclude from the test, in the context of the data?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">median_test</span>(span, handspan, sex)</a></code></pre></div>
<pre><code>## $table
##      above
## group above below
##     F    17    82
##     M    65    11
## 
## $test
##        what       value
## 1 statistic 8.06725e+01
## 2        df 1.00000e+00
## 3   P-value 2.66404e-19</code></pre>
<p>The P-value of <span class="math inline">\(2.66 \times 10^{-19}\)</span> is extremely small, so we
can conclude that males and females have different median
handspans. Remember that we are now comparing medians, and that
this test is <em>two</em>-sided.</p>
<p>You can stop here, or you can go on and note that most of the
males have a handspan bigger than the median, and most of the
females have a handspan smaller than the median, so that males
have on average a larger handspan. But you have to make the case
that males have a larger handspan; you cannot just assert this
from the P-value.</p>
<p>A more formal way to do this is to make the same observation as
above, then note that this is “on the correct side” (for males
to have a larger handspan), and thus that you can halve the
P-value, and conclude that males’ handspans are indeed larger in
terms of median.</p>
<p>Extra: you are probably expecting a confidence interval now for
the difference in medians. I haven’t talked about that in lecture, because the ideas are a bit trickier than they were for the confidence interval for the sign test. The sign test could be used for testing any median, so we could try a bunch of medians and see whether each one was rejected or not. The problem with Mood’s median test is that it only tests that the medians are <em>the same</em>. If you could easily test that the difference in medians was 3, say, you would know whether 3 was inside or outside the confidence interval for the difference in medians.</p>
<p>What were the actual sample medians, anyway?</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">span <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-2" title="2"><span class="kw">summarize</span>(<span class="dt">med =</span> <span class="kw">median</span>(handspan))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   sex     med
##   &lt;chr&gt; &lt;dbl&gt;
## 1 F      20  
## 2 M      22.5</code></pre>
<p>Here’s an idea: if we shift all the female handspans up by 2.5 inches, the medians would be the same:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">span <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="kw">ifelse</span>(sex<span class="op">==</span><span class="st">&quot;F&quot;</span>, handspan<span class="fl">+2.5</span>, handspan)) -&gt;<span class="st"> </span>d</a>
<a class="sourceLine" id="cb118-2" title="2">d</a></code></pre></div>
<pre><code>## # A tibble: 190 x 3
##    sex   handspan     x
##    &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1 M         21.5  21.5
##  2 M         22.5  22.5
##  3 M         23.5  23.5
##  4 F         20    22.5
##  5 F         19    21.5
##  6 F         20.5  23  
##  7 F         20.5  23  
##  8 F         20.2  22.8
##  9 M         23    23  
## 10 M         24.5  24.5
## # … with 180 more rows</code></pre>
<p>Dataframe <code>d</code> has a new column <code>x</code> that is the handspan plus 2.5 inches for females, and the unchanged handspan for males. So the median of <code>x</code> should be the same for males and females:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb120-2" title="2"><span class="kw">summarize</span>(<span class="dt">med_x =</span> <span class="kw">median</span>(x))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   sex   med_x
##   &lt;chr&gt; &lt;dbl&gt;
## 1 F      22.5
## 2 M      22.5</code></pre>
<p>and also the medians of <code>x</code> cannot possibly be significantly different:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">median_test</span>(d, x, sex)</a></code></pre></div>
<pre><code>## $table
##      above
## group above below
##     F    46    36
##     M    41    35
## 
## $test
##        what      value
## 1 statistic 0.07369901
## 2        df 1.00000000
## 3   P-value 0.78602526</code></pre>
<p>Quite a lot of the values of <code>x</code> are exactly equal to the overall median (and are discarded), so the P-value is not exactly 1 as you would expect. But it is definitely not significant, and so a difference of 2.5 inches smaller for females is going to be in a confidence interval for the difference in medians.</p>
<p>The strategy now is to try shifting the female handspans by different amounts, run Mood’s median test for each one, and see which shifts are not rejected. These are the ones for which that difference in medians would be in the confidence interval. Before we get to that, though, I want to simplify the procedure we have, so that it is easier to run it lots of times. First, let’s get just the P-value out of the median test:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">d<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">median_test</span>(d, x, sex)</a>
<a class="sourceLine" id="cb124-2" title="2">d<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pluck</span>(<span class="st">&quot;test&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.7860253</code></pre>
<p>That’s the P-value. <code>pluck</code> pulls individual things out of bigger things. The variable I called <code>d.1</code> has two things in it. The one called <code>table</code> has the numbers of data values above and below the overall median; the one called <code>test</code> has the test statistic and P-value in it. <code>test</code> is a dataframe; inside <em>that</em> is a column called <code>what</code> and a column called <code>value</code> with the number we want in it, and we want the third thing in that (the other two are the chi-squared test statistic and its degrees of freedom). Hence the <code>pluck</code> statement got the right thing.</p>
<p>Let’s think strategy: we want to shift the female handspans by a bunch of different amounts, run the test on each one, and get the P-value each time. When you’re running a big for-each like this, you want the thing you do each time to be as simple as possible. So let’s write a function that takes the shift as input, works out the new <code>x</code>, runs the test, and returns the P-value. We have all the ingredients, so it’s a matter of putting them together:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1">shift_pval &lt;-<span class="st"> </span><span class="cf">function</span>(shift) {</a>
<a class="sourceLine" id="cb126-2" title="2">  span <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="kw">ifelse</span>(sex <span class="op">==</span><span class="st"> &quot;F&quot;</span>, handspan <span class="op">+</span><span class="st"> </span>shift, handspan)) -&gt;<span class="st"> </span>d</a>
<a class="sourceLine" id="cb126-3" title="3">  d<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">median_test</span>(d, x, sex)</a>
<a class="sourceLine" id="cb126-4" title="4">  d<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pluck</span>(<span class="st">&quot;test&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb126-5" title="5">}</a></code></pre></div>
<p>In the function, the <code>shift</code> is input. The first line computes the handspans shifted by the input amount, whatever it is; the second line runs the median test on the shifted data; the last line pulls out, and returns, the P-value.</p>
<p>I am being a little sloppy here (but R is letting me get away with it): the function is also using a dataframe called <code>span</code>, which is the one we read in from the file earlier. That <em>was not input to the function</em>, so, if you have experience with other programming languages, you might be wondering whether that is “in the scope” of inside the function: that is, whether R will know about it. R does; anything the function needs that is not part of the input, it will take from your workspace. This is, you might imagine, dangerous; if the input to your function is called, say, <code>x</code>, you might easily have an <code>x</code> lying around in your workspace from some other analysis that has nothing to do with the <code>x</code> you want as the input to your function. The safe way to do it, and what I should have done, is to have <code>span</code> be input to my function as well. However, that clutters up the discussion below, so we’ll leave things as I did them here.</p>
<p>Let’s test this on a shift of 2.5 inches, and on the original data (a shift of zero):</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">shift_pval</span>(<span class="fl">2.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.7860253</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">shift_pval</span>(<span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 2.66404e-19</code></pre>
<p>Those are the same P-values we got before, so good.</p>
<p>Now, let’s get a bunch of shifts, say from 0 to 5 in steps of 0.5:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">tibble</span>(<span class="dt">shift =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## # A tibble: 11 x 1
##    shift
##    &lt;dbl&gt;
##  1   0  
##  2   0.5
##  3   1  
##  4   1.5
##  5   2  
##  6   2.5
##  7   3  
##  8   3.5
##  9   4  
## 10   4.5
## 11   5</code></pre>
<p>work out the P-value for each one, rowwise:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">tibble</span>(<span class="dt">shift =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.5</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_value =</span> <span class="kw">shift_pval</span>(shift))</a></code></pre></div>
<pre><code>## # A tibble: 11 x 2
## # Rowwise: 
##    shift  p_value
##    &lt;dbl&gt;    &lt;dbl&gt;
##  1   0   2.66e-19
##  2   0.5 7.38e-15
##  3   1   6.41e- 9
##  4   1.5 5.46e- 5
##  5   2   5.29e- 2
##  6   2.5 7.86e- 1
##  7   3   5.15e- 3
##  8   3.5 1.13e- 5
##  9   4   1.89e- 9
## 10   4.5 1.84e-14
## 11   5   1.61e-18</code></pre>
<p>and finally decide whether each shift is inside or outside the CI (because I am too lazy to figure out the scientific notation):</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">tibble</span>(<span class="dt">shift =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.5</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb135-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_value =</span> <span class="kw">shift_pval</span>(shift)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb135-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">where =</span> <span class="kw">ifelse</span>(p_value<span class="op">&lt;</span><span class="fl">0.05</span>, <span class="st">&quot;outside&quot;</span>, <span class="st">&quot;inside&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 11 x 3
## # Rowwise: 
##    shift  p_value where  
##    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  
##  1   0   2.66e-19 outside
##  2   0.5 7.38e-15 outside
##  3   1   6.41e- 9 outside
##  4   1.5 5.46e- 5 outside
##  5   2   5.29e- 2 inside 
##  6   2.5 7.86e- 1 inside 
##  7   3   5.15e- 3 outside
##  8   3.5 1.13e- 5 outside
##  9   4   1.89e- 9 outside
## 10   4.5 1.84e-14 outside
## 11   5   1.61e-18 outside</code></pre>
<p>The confidence interval goes from 2 inches to 2.5 inches on this scale. I checked and it goes up to 3 really, except that 3 itself is outside the interval. So let’s call it 2 to 3 inches. This means that the median female handspan is between 2 and 3 inches <em>smaller</em> than the median male handspan, because we had to shift the female handspans up by that much to make them not significantly different.</p>
<p>You, of course, would do just the last pipeline; I showed you the steps so you could see what was going on.</p>
<p>The final observation is that this interval is a long way from containing zero, because the P-value was so tiny.</p>
<p>Let’s see how the <span class="math inline">\(t\)</span>-interval looks in comparison (two-sided, because we want the confidence interval):</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">t.test</span>(handspan<span class="op">~</span>sex, <span class="dt">data =</span> span)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  handspan by sex
## t = -10.871, df = 187.92, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.001496 -2.079466
## sample estimates:
## mean in group F mean in group M 
##        20.01699        22.55747</code></pre>
<p>Almost exactly the same (except that F is before M). So it made no difference at all whether we did a <span class="math inline">\(t\)</span>-test or a Mood’s median test, as the bootstrapped sampling distribution suggested.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>That is, before looking at the data. This is Latin. It’s also the place that the Bayesian “prior distribution” comes from. The “posterior distribution” comes from the Latin <em>a posteriori</em>, which means <em>afterwards</em>, that is, after you have looked at the data.<a href="mood-median-test.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>That is, before looking at the data. This is Latin. It’s also the place that the Bayesian “prior distribution” comes from. The “posterior distribution” comes from the Latin <em>a posteriori</em>, which means <em>afterwards</em>, that is, after you have looked at the data.<a href="mood-median-test.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>The two groups have very different spreads, but that is not a problem as long as we remember to do the Welch-Satterthwaite test that does not assume equal spreads. This is the default in R, so we are good, at least with that.<a href="mood-median-test.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>There <em>was</em>, in the <code>chisq.test</code> inside <code>median_test</code>, but in <code>smmr</code> I didn’t pass that warning back to the outside world.<a href="mood-median-test.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>To simplify things, we’ll assume that everyone gave a Yes or a No answer, though you could add a column like “No answer” if you wanted to make it more realistic.<a href="mood-median-test.html#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Except in the case of the previous problem, where there were multiple observations equal to the overall median. Which we ignore for the moment.<a href="mood-median-test.html#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-sign-test.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="matched-pairs-t-and-sign-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["pasias.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

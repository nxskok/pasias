<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 19 Functions | Problems and Solutions in Applied Statistics" />
<meta property="og:type" content="book" />
<meta property="og:url" content="http://ritsokiguess.site/pasias" />

<meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
<meta name="github-repo" content="nxskok/pasias" />

<meta name="author" content="Ken Butler" />

<meta name="date" content="2021-04-26" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics">

<title>Chapter 19 Functions | Problems and Solutions in Applied Statistics</title>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/jquery-1.12.4/jquery.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="index.html#packages-used-somewhere-in-this-book"><span class="toc-section-number">1.1</span> Packages used somewhere in this book</a></li>
</ul></li>
<li><a href="getting-used-to-r-and-r-studio.html#getting-used-to-r-and-r-studio"><span class="toc-section-number">2</span> Getting used to R and R Studio</a>
<ul>
<li><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><span class="toc-section-number">2.1</span> Getting an R Studio Cloud account</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#getting-started"><span class="toc-section-number">2.2</span> Getting started</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><span class="toc-section-number">2.3</span> Reading data from a file</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#reading-files-different-ways"><span class="toc-section-number">2.4</span> Reading files different ways</a></li>
</ul></li>
<li><a href="reading-in-data.html#reading-in-data"><span class="toc-section-number">3</span> Reading in data</a>
<ul>
<li><a href="reading-in-data.html#orange-juice"><span class="toc-section-number">3.1</span> Orange juice</a></li>
<li><a href="reading-in-data.html#making-soap"><span class="toc-section-number">3.2</span> Making soap</a></li>
<li><a href="reading-in-data.html#handling-shipments"><span class="toc-section-number">3.3</span> Handling shipments</a></li>
</ul></li>
<li><a href="drawing-graphs.html#drawing-graphs"><span class="toc-section-number">4</span> Drawing graphs</a>
<ul>
<li><a href="drawing-graphs.html#orange-juice-1"><span class="toc-section-number">4.1</span> Orange juice</a></li>
<li><a href="drawing-graphs.html#making-soap-1"><span class="toc-section-number">4.2</span> Making soap</a></li>
<li><a href="drawing-graphs.html#handling-shipments-1"><span class="toc-section-number">4.3</span> Handling shipments</a></li>
</ul></li>
<li><a href="data-exploration.html#data-exploration"><span class="toc-section-number">5</span> Data exploration</a>
<ul>
<li><a href="data-exploration.html#north-carolina-births"><span class="toc-section-number">5.1</span> North Carolina births</a></li>
<li><a href="data-exploration.html#more-about-the-nc-births"><span class="toc-section-number">5.2</span> More about the NC births</a></li>
<li><a href="data-exploration.html#nenana-alaska"><span class="toc-section-number">5.3</span> Nenana, Alaska</a></li>
<li><a href="data-exploration.html#computerized-accounting"><span class="toc-section-number">5.4</span> Computerized accounting</a></li>
<li><a href="data-exploration.html#test-scores-in-two-classes"><span class="toc-section-number">5.5</span> Test scores in two classes</a></li>
<li><a href="data-exploration.html#working-with-dataframes"><span class="toc-section-number">5.6</span> Working with dataframes</a></li>
<li><a href="data-exploration.html#tidying-the-jays-data"><span class="toc-section-number">5.7</span> Tidying the Jays data</a></li>
<li><a href="data-exploration.html#cars"><span class="toc-section-number">5.8</span> Cars</a></li>
</ul></li>
<li><a href="one-sample-inference.html#one-sample-inference"><span class="toc-section-number">6</span> One-sample inference</a>
<ul>
<li><a href="one-sample-inference.html#hunter-gatherers-in-australia"><span class="toc-section-number">6.1</span> Hunter-gatherers in Australia</a></li>
<li><a href="one-sample-inference.html#buses-to-boulder"><span class="toc-section-number">6.2</span> Buses to Boulder</a></li>
<li><a href="one-sample-inference.html#length-of-gestation-in-north-carolina"><span class="toc-section-number">6.3</span> Length of gestation in North Carolina</a></li>
<li><a href="one-sample-inference.html#inferring-ice-break-up-in-nenana"><span class="toc-section-number">6.4</span> Inferring ice break-up in Nenana</a></li>
</ul></li>
<li><a href="two-sample-inference.html#two-sample-inference"><span class="toc-section-number">7</span> Two-sample inference</a>
<ul>
<li><a href="two-sample-inference.html#children-and-electronic-devices"><span class="toc-section-number">7.1</span> Children and electronic devices</a></li>
<li><a href="two-sample-inference.html#parking-close-to-the-curb"><span class="toc-section-number">7.2</span> Parking close to the curb</a></li>
<li><a href="two-sample-inference.html#bell-peppers-and-too-much-water"><span class="toc-section-number">7.3</span> Bell peppers and too much water</a></li>
<li><a href="two-sample-inference.html#exercise-and-anxiety-and-bullying-mice"><span class="toc-section-number">7.4</span> Exercise and anxiety and bullying mice</a></li>
<li><a href="two-sample-inference.html#diet-and-growth-in-boys"><span class="toc-section-number">7.5</span> Diet and growth in boys</a></li>
</ul></li>
<li><a href="power-and-sample-size.html#power-and-sample-size"><span class="toc-section-number">8</span> Power and sample size</a>
<ul>
<li><a href="power-and-sample-size.html#simulating-power"><span class="toc-section-number">8.1</span> Simulating power</a></li>
<li><a href="power-and-sample-size.html#calculating-power-and-sample-size-for-estimating-mean"><span class="toc-section-number">8.2</span> Calculating power and sample size for estimating mean</a></li>
<li><a href="power-and-sample-size.html#simulating-power-for-proportions"><span class="toc-section-number">8.3</span> Simulating power for proportions</a></li>
</ul></li>
<li><a href="the-sign-test.html#the-sign-test"><span class="toc-section-number">9</span> The sign test</a>
<ul>
<li><a href="the-sign-test.html#running-a-maze"><span class="toc-section-number">9.1</span> Running a maze</a></li>
<li><a href="the-sign-test.html#chocolate-chips"><span class="toc-section-number">9.2</span> Chocolate chips</a></li>
<li><a href="the-sign-test.html#the-power-of-the-sign-test"><span class="toc-section-number">9.3</span> The power of the sign test</a></li>
</ul></li>
<li><a href="moods-median-test.html#moods-median-test"><span class="toc-section-number">10</span> Mood’s median test</a>
<ul>
<li><a href="moods-median-test.html#sugar-in-breakfast-cereals"><span class="toc-section-number">10.1</span> Sugar in breakfast cereals</a></li>
<li><a href="moods-median-test.html#fear-of-math"><span class="toc-section-number">10.2</span> Fear of math</a></li>
<li><a href="moods-median-test.html#medical-instructions"><span class="toc-section-number">10.3</span> Medical instructions</a></li>
</ul></li>
<li><a href="matched-pairs-t-and-sign-test.html#matched-pairs-t-and-sign-test"><span class="toc-section-number">11</span> Matched pairs t and sign test</a>
<ul>
<li><a href="matched-pairs-t-and-sign-test.html#measuring-body-fat"><span class="toc-section-number">11.1</span> Measuring body fat</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#throwing-baseballs-and-softballs"><span class="toc-section-number">11.2</span> Throwing baseballs and softballs</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#throwing-baseballs-and-softballs-again"><span class="toc-section-number">11.3</span> Throwing baseballs and softballs, again</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#changes-in-salary"><span class="toc-section-number">11.4</span> Changes in salary</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#body-fat-revisited"><span class="toc-section-number">11.5</span> Body fat revisited</a></li>
</ul></li>
<li><a href="normal-quantile-plots.html#normal-quantile-plots"><span class="toc-section-number">12</span> Normal quantile plots</a>
<ul>
<li><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><span class="toc-section-number">12.1</span> Lengths of heliconia flowers</a></li>
<li><a href="normal-quantile-plots.html#ferritin-and-normality"><span class="toc-section-number">12.2</span> Ferritin and normality</a></li>
</ul></li>
<li><a href="analysis-of-variance.html#analysis-of-variance"><span class="toc-section-number">13</span> Analysis of variance</a>
<ul>
<li><a href="analysis-of-variance.html#movie-ratings-and-lengths"><span class="toc-section-number">13.1</span> Movie ratings and lengths</a></li>
<li><a href="analysis-of-variance.html#deer-and-how-much-they-eat"><span class="toc-section-number">13.2</span> Deer and how much they eat</a></li>
<li><a href="analysis-of-variance.html#movie-ratings-again"><span class="toc-section-number">13.3</span> Movie ratings again</a></li>
<li><a href="analysis-of-variance.html#atomic-weight-of-carbon"><span class="toc-section-number">13.4</span> Atomic weight of carbon</a></li>
<li><a href="analysis-of-variance.html#can-caffeine-improve-your-performance-on-a-test"><span class="toc-section-number">13.5</span> Can caffeine improve your performance on a test?</a></li>
</ul></li>
<li><a href="writing-reports.html#writing-reports"><span class="toc-section-number">14</span> Writing reports</a>
<ul>
<li><a href="writing-reports.html#atomic-weight-of-carbon-1"><span class="toc-section-number">14.1</span> Atomic weight of carbon</a></li>
<li><a href="writing-reports.html#sparrowhawks"><span class="toc-section-number">14.2</span> Sparrowhawks</a></li>
</ul></li>
<li><a href="tidying-data.html#tidying-data"><span class="toc-section-number">15</span> Tidying data</a>
<ul>
<li><a href="tidying-data.html#baseball-and-softball-spaghetti"><span class="toc-section-number">15.1</span> Baseball and softball spaghetti</a></li>
<li><a href="tidying-data.html#ethanol-and-sleep-time-in-rats"><span class="toc-section-number">15.2</span> Ethanol and sleep time in rats</a></li>
<li><a href="tidying-data.html#growth-of-tomatoes"><span class="toc-section-number">15.3</span> Growth of tomatoes</a></li>
<li><a href="tidying-data.html#pain-relief-in-migraine-headaches-again"><span class="toc-section-number">15.4</span> Pain relief in migraine headaches (again)</a></li>
<li><a href="tidying-data.html#location-species-and-disease-in-plants"><span class="toc-section-number">15.5</span> Location, species and disease in plants</a></li>
<li><a href="tidying-data.html#mating-songs-in-crickets"><span class="toc-section-number">15.6</span> Mating songs in crickets</a></li>
<li><a href="tidying-data.html#number-1-songs"><span class="toc-section-number">15.7</span> Number 1 songs</a></li>
<li><a href="tidying-data.html#bikes-on-college"><span class="toc-section-number">15.8</span> Bikes on College</a></li>
<li><a href="tidying-data.html#feeling-the-heat"><span class="toc-section-number">15.9</span> Feeling the heat</a></li>
</ul></li>
<li><a href="regression.html#regression"><span class="toc-section-number">16</span> Regression</a>
<ul>
<li><a href="regression.html#rainfall-in-california"><span class="toc-section-number">16.1</span> Rainfall in California</a></li>
<li><a href="regression.html#carbon-monoxide-in-cigarettes"><span class="toc-section-number">16.2</span> Carbon monoxide in cigarettes</a></li>
<li><a href="regression.html#maximal-oxygen-uptake-in-young-boys"><span class="toc-section-number">16.3</span> Maximal oxygen uptake in young boys</a></li>
<li><a href="regression.html#facebook-friends-and-grey-matter"><span class="toc-section-number">16.4</span> Facebook friends and grey matter</a></li>
<li><a href="regression.html#endogenous-nitrogen-excretion-in-carp"><span class="toc-section-number">16.5</span> Endogenous nitrogen excretion in carp</a></li>
<li><a href="regression.html#salaries-of-social-workers"><span class="toc-section-number">16.6</span> Salaries of social workers</a></li>
<li><a href="regression.html#predicting-volume-of-wood-in-pine-trees"><span class="toc-section-number">16.7</span> Predicting volume of wood in pine trees</a></li>
<li><a href="regression.html#tortoise-shells-and-eggs"><span class="toc-section-number">16.8</span> Tortoise shells and eggs</a></li>
<li><a href="regression.html#crickets-revisited"><span class="toc-section-number">16.9</span> Crickets revisited</a></li>
<li><a href="regression.html#roller-coasters"><span class="toc-section-number">16.10</span> Roller coasters</a></li>
<li><a href="regression.html#running-and-blood-sugar"><span class="toc-section-number">16.11</span> Running and blood sugar</a></li>
<li><a href="regression.html#calories-and-fat-in-pizza"><span class="toc-section-number">16.12</span> Calories and fat in pizza</a></li>
<li><a href="regression.html#where-should-the-fire-stations-be"><span class="toc-section-number">16.13</span> Where should the fire stations be?</a></li>
</ul></li>
<li><a href="regression-1.html#regression-1"><span class="toc-section-number">17</span> Regression</a>
<ul>
<li><a href="regression-1.html#being-satisfied-with-hospital"><span class="toc-section-number">17.1</span> Being satisfied with hospital</a></li>
<li><a href="regression-1.html#handling-shipments-of-chemicals"><span class="toc-section-number">17.2</span> Handling shipments of chemicals</a></li>
<li><a href="regression-1.html#salaries-of-mathematicians"><span class="toc-section-number">17.3</span> Salaries of mathematicians</a></li>
<li><a href="regression-1.html#predicting-gpa-of-computer-science-students"><span class="toc-section-number">17.4</span> Predicting GPA of computer science students</a></li>
</ul></li>
<li><a href="dates-and-times.html#dates-and-times"><span class="toc-section-number">18</span> Dates and times</a>
<ul>
<li><a href="dates-and-times.html#dealing-with-dates-in-the-worcester-heart-attack-study"><span class="toc-section-number">18.1</span> Dealing with dates in the Worcester Heart Attack study</a></li>
<li><a href="dates-and-times.html#growth-of-mizuna-lettuce-seeds"><span class="toc-section-number">18.2</span> Growth of Mizuna lettuce seeds</a></li>
<li><a href="dates-and-times.html#types-of-childbirth"><span class="toc-section-number">18.3</span> Types of childbirth</a></li>
<li><a href="dates-and-times.html#wolves-and-caribou"><span class="toc-section-number">18.4</span> Wolves and caribou</a></li>
</ul></li>
<li><a href="functions.html#functions"><span class="toc-section-number">19</span> Functions</a>
<ul>
<li><a href="functions.html#making-some-r-functions"><span class="toc-section-number">19.1</span> Making some R functions</a></li>
<li><a href="functions.html#the-collatz-sequence"><span class="toc-section-number">19.2</span> The Collatz sequence</a></li>
</ul></li>
<li><a href="the-bootstrap.html#the-bootstrap"><span class="toc-section-number">20</span> The Bootstrap</a>
<ul>
<li><a href="the-bootstrap.html#air-conditioning-failures"><span class="toc-section-number">20.1</span> Air conditioning failures</a></li>
<li><a href="the-bootstrap.html#air-conditioning-failures-bootstrapping-the-median"><span class="toc-section-number">20.2</span> Air conditioning failures: bootstrapping the median</a></li>
</ul></li>
<li><a href="bayesian-statistics-with-stan.html#bayesian-statistics-with-stan"><span class="toc-section-number">21</span> Bayesian Statistics with Stan</a>
<ul>
<li><a href="bayesian-statistics-with-stan.html#estimating-proportion-in-favour-from-a-survey"><span class="toc-section-number">21.1</span> Estimating proportion in favour from a survey</a></li>
<li><a href="bayesian-statistics-with-stan.html#bayesian-regression"><span class="toc-section-number">21.2</span> Bayesian regression</a></li>
</ul></li>
<li><a href="logistic-regression.html#logistic-regression"><span class="toc-section-number">22</span> Logistic regression</a>
<ul>
<li><a href="logistic-regression.html#finding-wolf-spiders-on-the-beach"><span class="toc-section-number">22.1</span> Finding wolf spiders on the beach</a></li>
<li><a href="logistic-regression.html#killing-aphids"><span class="toc-section-number">22.2</span> Killing aphids</a></li>
<li><a href="logistic-regression.html#the-effects-of-substance-a"><span class="toc-section-number">22.3</span> The effects of Substance A</a></li>
<li><a href="logistic-regression.html#what-makes-an-animal-get-infected"><span class="toc-section-number">22.4</span> What makes an animal get infected?</a></li>
<li><a href="logistic-regression.html#the-brain-of-a-cat"><span class="toc-section-number">22.5</span> The brain of a cat</a></li>
<li><a href="logistic-regression.html#how-not-to-get-heart-disease"><span class="toc-section-number">22.6</span> How not to get heart disease</a></li>
<li><a href="logistic-regression.html#successful-breastfeeding"><span class="toc-section-number">22.7</span> Successful breastfeeding</a></li>
<li><a href="logistic-regression.html#making-it-over-the-mountains"><span class="toc-section-number">22.8</span> Making it over the mountains</a></li>
<li><a href="logistic-regression.html#who-needs-the-most-intensive-care"><span class="toc-section-number">22.9</span> Who needs the most intensive care?</a></li>
<li><a href="logistic-regression.html#go-away-and-dont-come-back"><span class="toc-section-number">22.10</span> Go away and don’t come back!</a></li>
</ul></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#logistic-regression-with-ordinal-or-nominal-response"><span class="toc-section-number">23</span> Logistic regression with ordinal or nominal response</a>
<ul>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#do-you-like-your-mobile-phone"><span class="toc-section-number">23.1</span> Do you like your mobile phone?</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#attitudes-towards-abortion"><span class="toc-section-number">23.2</span> Attitudes towards abortion</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#finding-non-missing-values"><span class="toc-section-number">23.3</span> Finding non-missing values</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#european-social-survey-and-voting"><span class="toc-section-number">23.4</span> European Social Survey and voting</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#alligator-food"><span class="toc-section-number">23.5</span> Alligator food</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#how-do-you-like-your-steak-the-data"><span class="toc-section-number">23.6</span> How do you like your steak – the data</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#crimes-in-san-francisco-the-data"><span class="toc-section-number">23.7</span> Crimes in San Francisco – the data</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#how-do-you-like-your-steak"><span class="toc-section-number">23.8</span> How do you like your steak?</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#crimes-in-san-francisco"><span class="toc-section-number">23.9</span> Crimes in San Francisco</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#high-school-and-beyond"><span class="toc-section-number">23.10</span> High School and Beyond</a></li>
<li><a href="logistic-regression-with-ordinal-or-nominal-response.html#what-sports-do-these-athletes-play"><span class="toc-section-number">23.11</span> What sports do these athletes play?</a></li>
</ul></li>
<li><a href="survival-analysis.html#survival-analysis"><span class="toc-section-number">24</span> Survival analysis</a>
<ul>
<li><a href="survival-analysis.html#the-worcester-survey"><span class="toc-section-number">24.1</span> The Worcester survey</a></li>
<li><a href="survival-analysis.html#drug-treatment-programs"><span class="toc-section-number">24.2</span> Drug treatment programs</a></li>
<li><a href="survival-analysis.html#multiple-myeloma"><span class="toc-section-number">24.3</span> Multiple myeloma</a></li>
<li><a href="survival-analysis.html#ovarian-cancer"><span class="toc-section-number">24.4</span> Ovarian cancer</a></li>
</ul></li>
<li><a href="analysis-of-variance-revisited.html#analysis-of-variance-revisited"><span class="toc-section-number">25</span> Analysis of variance revisited</a>
<ul>
<li><a href="analysis-of-variance-revisited.html#acid-rain"><span class="toc-section-number">25.1</span> Acid rain</a></li>
<li><a href="analysis-of-variance-revisited.html#treating-hay-fever"><span class="toc-section-number">25.2</span> Treating hay fever</a></li>
<li><a href="analysis-of-variance-revisited.html#focused-comparisons-of-the-effect-of-caffeine"><span class="toc-section-number">25.3</span> Focused comparisons of the effect of caffeine</a></li>
<li><a href="analysis-of-variance-revisited.html#who-studies-the-most-outside-class"><span class="toc-section-number">25.4</span> Who studies the most outside class?</a></li>
<li><a href="analysis-of-variance-revisited.html#mental-context"><span class="toc-section-number">25.5</span> Mental context</a></li>
<li><a href="analysis-of-variance-revisited.html#trying-on-shirts"><span class="toc-section-number">25.6</span> Trying on shirts</a></li>
<li><a href="analysis-of-variance-revisited.html#productivity-and-research-and-development"><span class="toc-section-number">25.7</span> Productivity and research-and-development</a></li>
<li><a href="analysis-of-variance-revisited.html#treating-leprosy"><span class="toc-section-number">25.8</span> Treating leprosy</a></li>
</ul></li>
<li><a href="multivariate-analysis-of-variance.html#multivariate-analysis-of-variance"><span class="toc-section-number">26</span> Multivariate analysis of variance</a>
<ul>
<li><a href="multivariate-analysis-of-variance.html#fabricated-data"><span class="toc-section-number">26.1</span> Fabricated data</a></li>
<li><a href="multivariate-analysis-of-variance.html#do-characteristics-of-urine-depend-on-obesity"><span class="toc-section-number">26.2</span> Do characteristics of urine depend on obesity?</a></li>
<li><a href="multivariate-analysis-of-variance.html#how-do-height-and-weight-depend-on-sport-played-by-elite-athletes"><span class="toc-section-number">26.3</span> How do height and weight depend on sport played by elite athletes?</a></li>
</ul></li>
<li><a href="repeated-measures.html#repeated-measures"><span class="toc-section-number">27</span> Repeated measures</a>
<ul>
<li><a href="repeated-measures.html#effect-of-drug-on-rat-weight"><span class="toc-section-number">27.1</span> Effect of drug on rat weight</a></li>
<li><a href="repeated-measures.html#social-interaction-among-old-people"><span class="toc-section-number">27.2</span> Social interaction among old people</a></li>
<li><a href="repeated-measures.html#childrens-stress-levels-and-airports"><span class="toc-section-number">27.3</span> Children’s stress levels and airports</a></li>
<li><a href="repeated-measures.html#body-fat-as-repeated-measures"><span class="toc-section-number">27.4</span> Body fat as repeated measures</a></li>
<li><a href="repeated-measures.html#investigating-motor-activity-in-rats"><span class="toc-section-number">27.5</span> Investigating motor activity in rats</a></li>
<li><a href="repeated-measures.html#repeated-measures-with-no-background"><span class="toc-section-number">27.6</span> Repeated measures with no background</a></li>
</ul></li>
<li><a href="discriminant-analysis.html#discriminant-analysis"><span class="toc-section-number">28</span> Discriminant analysis</a>
<ul>
<li><a href="discriminant-analysis.html#telling-whether-a-banknote-is-real-or-counterfeit"><span class="toc-section-number">28.1</span> Telling whether a banknote is real or counterfeit</a></li>
<li><a href="discriminant-analysis.html#urine-and-obesity-what-makes-a-difference"><span class="toc-section-number">28.2</span> Urine and obesity: what makes a difference?</a></li>
<li><a href="discriminant-analysis.html#understanding-a-manova"><span class="toc-section-number">28.3</span> Understanding a MANOVA</a></li>
<li><a href="discriminant-analysis.html#what-distinguishes-people-who-do-different-jobs"><span class="toc-section-number">28.4</span> What distinguishes people who do different jobs?</a></li>
<li><a href="discriminant-analysis.html#observing-children-with-adhd"><span class="toc-section-number">28.5</span> Observing children with ADHD</a></li>
<li><a href="discriminant-analysis.html#growing-corn"><span class="toc-section-number">28.6</span> Growing corn</a></li>
<li><a href="discriminant-analysis.html#understanding-athletes-height-weight-sport-and-gender"><span class="toc-section-number">28.7</span> Understanding athletes’ height, weight, sport and gender</a></li>
</ul></li>
<li><a href="cluster-analysis.html#cluster-analysis"><span class="toc-section-number">29</span> Cluster analysis</a>
<ul>
<li><a href="cluster-analysis.html#sites-on-the-sea-bed"><span class="toc-section-number">29.1</span> Sites on the sea bed</a></li>
<li><a href="cluster-analysis.html#dissimilarities-between-fruits"><span class="toc-section-number">29.2</span> Dissimilarities between fruits</a></li>
<li><a href="cluster-analysis.html#similarity-of-species"><span class="toc-section-number">29.3</span> Similarity of species</a></li>
<li><a href="cluster-analysis.html#rating-beer"><span class="toc-section-number">29.4</span> Rating beer</a></li>
<li><a href="cluster-analysis.html#clustering-the-swiss-bills"><span class="toc-section-number">29.5</span> Clustering the Swiss bills</a></li>
<li><a href="cluster-analysis.html#grouping-similar-cars"><span class="toc-section-number">29.6</span> Grouping similar cars</a></li>
<li><a href="cluster-analysis.html#running-jumping-and-throwing"><span class="toc-section-number">29.7</span> Running, jumping, and throwing</a></li>
<li><a href="cluster-analysis.html#bridges-in-pittsburgh"><span class="toc-section-number">29.8</span> Bridges in Pittsburgh</a></li>
<li><a href="cluster-analysis.html#clustering-the-australian-athletes"><span class="toc-section-number">29.9</span> Clustering the Australian athletes</a></li>
</ul></li>
<li><a href="drawing-maps-with-leaflet.html#drawing-maps-with-leaflet"><span class="toc-section-number">30</span> Drawing maps with Leaflet</a>
<ul>
<li><a href="drawing-maps-with-leaflet.html#the-brain-of-a-cat-revisited"><span class="toc-section-number">30.1</span> The brain of a cat, revisited</a></li>
<li><a href="drawing-maps-with-leaflet.html#making-a-map-of-wisconsin"><span class="toc-section-number">30.2</span> Making a map of Wisconsin</a></li>
</ul></li>
<li><a href="multidimensional-scaling.html#multidimensional-scaling"><span class="toc-section-number">31</span> Multidimensional Scaling</a>
<ul>
<li><a href="multidimensional-scaling.html#making-a-map-of-wisconsin-1"><span class="toc-section-number">31.1</span> Making a map of Wisconsin</a></li>
<li><a href="multidimensional-scaling.html#things-that-feel-similar-to-each-other"><span class="toc-section-number">31.2</span> Things that feel similar to each other</a></li>
<li><a href="multidimensional-scaling.html#confusing-letters"><span class="toc-section-number">31.3</span> Confusing letters</a></li>
<li><a href="multidimensional-scaling.html#more-beer-please"><span class="toc-section-number">31.4</span> More beer please</a></li>
<li><a href="multidimensional-scaling.html#feeling-similar-again"><span class="toc-section-number">31.5</span> Feeling similar, again</a></li>
</ul></li>
<li><a href="principal-components-and-factor-analysis.html#principal-components-and-factor-analysis"><span class="toc-section-number">32</span> Principal Components and Factor Analysis</a>
<ul>
<li><a href="principal-components-and-factor-analysis.html#the-weather-somewhere"><span class="toc-section-number">32.1</span> The weather, somewhere</a></li>
<li><a href="principal-components-and-factor-analysis.html#air-pollution"><span class="toc-section-number">32.2</span> Air pollution</a></li>
<li><a href="principal-components-and-factor-analysis.html#a-correlation-matrix"><span class="toc-section-number">32.3</span> A correlation matrix</a></li>
<li><a href="principal-components-and-factor-analysis.html#the-interpersonal-circumplex"><span class="toc-section-number">32.4</span> The Interpersonal Circumplex</a></li>
</ul></li>
<li><a href="frequency-table-analysis.html#frequency-table-analysis"><span class="toc-section-number">33</span> Frequency table analysis</a>
<ul>
<li><a href="frequency-table-analysis.html#college-plans"><span class="toc-section-number">33.1</span> College plans</a></li>
<li><a href="frequency-table-analysis.html#predicting-voting"><span class="toc-section-number">33.2</span> Predicting voting</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="functions" class="section level1" number="19">
<h1><span class="header-section-number">Chapter 19</span> Functions</h1>
<div class="sourceCode" id="cb1423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1423-1"><a href="functions.html#cb1423-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div id="making-some-r-functions" class="section level2" number="19.1">
<h2><span class="header-section-number">19.1</span> Making some R functions</h2>
<p>Let’s write some simple R functions to convert temperatures,
and later to play with text.</p>
<ol style="list-style-type: lower-alpha">
<li>A temperature in Celsius is converted to one in Kelvin by
adding 273.15. (A temperature of <span class="math inline">\(-273.15\)</span> Celsius, 0 Kelvin, is the “absolute zero”
temperature that nothing can be colder than.) Write a
function called <code>c_to_k</code> that converts an input Celsius
temperature to one in Kelvin, and test that it works.</li>
</ol>
<p>Solution</p>
<p>This is mostly an exercise in structuring your function
correctly. Let’s call the input <code>C</code> (uppercase C, since
lowercase c has a special meaning to R):</p>
<div class="sourceCode" id="cb1424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1424-1"><a href="functions.html#cb1424-1"></a>c_to_k &lt;-<span class="st"> </span><span class="cf">function</span>(C) {</span>
<span id="cb1424-2"><a href="functions.html#cb1424-2"></a>  C <span class="op">+</span><span class="st"> </span><span class="fl">273.15</span></span>
<span id="cb1424-3"><a href="functions.html#cb1424-3"></a>}</span>
<span id="cb1424-4"><a href="functions.html#cb1424-4"></a><span class="kw">c_to_k</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 273.15</code></pre>
<div class="sourceCode" id="cb1426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1426-1"><a href="functions.html#cb1426-1"></a><span class="kw">c_to_k</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 293.15</code></pre>
<p>This is the simplest way to do it: the last line of the function, if
calculated but not saved, is the value that gets returned to the
outside world. The checks suggest that it worked.</p>
<p>If you’re used to Python or similar, you might prefer to calculate the
value to be returned and then return it. You can do that in R too:</p>
<div class="sourceCode" id="cb1428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1428-1"><a href="functions.html#cb1428-1"></a>c_to_k &lt;-<span class="st"> </span><span class="cf">function</span>(C) {</span>
<span id="cb1428-2"><a href="functions.html#cb1428-2"></a>  K &lt;-<span class="st"> </span>C <span class="op">+</span><span class="st"> </span><span class="fl">273.15</span></span>
<span id="cb1428-3"><a href="functions.html#cb1428-3"></a>  <span class="kw">return</span>(K)</span>
<span id="cb1428-4"><a href="functions.html#cb1428-4"></a>}</span>
<span id="cb1428-5"><a href="functions.html#cb1428-5"></a><span class="kw">c_to_k</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 273.15</code></pre>
<div class="sourceCode" id="cb1430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1430-1"><a href="functions.html#cb1430-1"></a><span class="kw">c_to_k</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 293.15</code></pre>
<p>That works just as well, and for the rest of this question, you can go
either way.
<label for="tufte-mn-128" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-128" class="margin-toggle"><span class="marginnote">R style is to use the last line of the function for the return value, unless you are jumping out of the function before the end, in which case use <em>return</em>.</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Write a function to convert a Fahrenheit temperature to
Celsius. The way you do that is to subtract 32 and then multiply by
<span class="math inline">\(5/9\)</span>.</li>
</ol>
<p>Solution</p>
<p>On the model of the previous one, we should call this
<code>f_to_c</code>. I’m going to return the last line, but you can
save the calculated value and return that instead:</p>
<div class="sourceCode" id="cb1432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1432-1"><a href="functions.html#cb1432-1"></a>f_to_c &lt;-<span class="st"> </span><span class="cf">function</span>(F) {</span>
<span id="cb1432-2"><a href="functions.html#cb1432-2"></a>  (F <span class="op">-</span><span class="st"> </span><span class="dv">32</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span></span>
<span id="cb1432-3"><a href="functions.html#cb1432-3"></a>}</span>
<span id="cb1432-4"><a href="functions.html#cb1432-4"></a><span class="kw">f_to_c</span>(<span class="dv">32</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb1434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1434-1"><a href="functions.html#cb1434-1"></a><span class="kw">f_to_c</span>(<span class="dv">50</span>)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb1436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1436-1"><a href="functions.html#cb1436-1"></a><span class="kw">f_to_c</span>(<span class="dv">68</span>)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>Americans are very good at saying things like “temperatures in the 50s”,
which don’t mean much to me, so I like to have benchmarks to
work with: these are the Fahrenheit versions of 0, 10, and 20 Celsius.</p>
<p>Thus “in the 50s” means “between about 10 and 15 Celsius”.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li><em>Using the functions you already wrote</em>, write a function
to convert an input Fahrenheit temperature to Kelvin.</li>
</ol>
<p>Solution</p>
<p>This implies that you can piggy-back on the functions you just
wrote, which goes as below. First you convert the Fahrenheit to
Celsius, and then you convert <em>that</em> to Kelvin. (This is less
error-prone than trying to use algebra to get a formula for this
conversion and then implementing that):</p>
<div class="sourceCode" id="cb1438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1438-1"><a href="functions.html#cb1438-1"></a>f_to_k &lt;-<span class="st"> </span><span class="cf">function</span>(F) {</span>
<span id="cb1438-2"><a href="functions.html#cb1438-2"></a>  C &lt;-<span class="st"> </span><span class="kw">f_to_c</span>(F)</span>
<span id="cb1438-3"><a href="functions.html#cb1438-3"></a>  K &lt;-<span class="st"> </span><span class="kw">c_to_k</span>(C)</span>
<span id="cb1438-4"><a href="functions.html#cb1438-4"></a>  <span class="kw">return</span>(K)</span>
<span id="cb1438-5"><a href="functions.html#cb1438-5"></a>}</span>
<span id="cb1438-6"><a href="functions.html#cb1438-6"></a><span class="kw">f_to_k</span>(<span class="dv">32</span>)</span></code></pre></div>
<pre><code>## [1] 273.15</code></pre>
<div class="sourceCode" id="cb1440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1440-1"><a href="functions.html#cb1440-1"></a><span class="kw">f_to_k</span>(<span class="dv">68</span>)</span></code></pre></div>
<pre><code>## [1] 293.15</code></pre>
<p>These check because in Celsius they are 0 and 20 and we found the
Kelvin equivalents of those to be these values earlier.</p>
<p>I wrote this one with a <code>return</code> because I thought it made the
structure clearer: run one function, save the result, run another
function, save the result, then return what you’ve got.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Rewrite your Fahrenheit-to-Celsius convertor to take a
suitable default value and check that it works as a default.</li>
</ol>
<p>Solution</p>
<p>You can choose any default you like. I’ll take a default of 68
(what I would call “a nice day”):</p>
<div class="sourceCode" id="cb1442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1442-1"><a href="functions.html#cb1442-1"></a>f_to_c &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">F =</span> <span class="dv">68</span>) {</span>
<span id="cb1442-2"><a href="functions.html#cb1442-2"></a>  (F <span class="op">-</span><span class="st"> </span><span class="dv">32</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span></span>
<span id="cb1442-3"><a href="functions.html#cb1442-3"></a>}</span>
<span id="cb1442-4"><a href="functions.html#cb1442-4"></a><span class="kw">f_to_c</span>(<span class="dv">68</span>)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb1444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1444-1"><a href="functions.html#cb1444-1"></a><span class="kw">f_to_c</span>()</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>The change is in the top line of the function. You see the result: if
we run it without an input, we get the same answer as if the input had
been 68.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>What happens if you feed your Fahrenheit-to-Celsius convertor
a <em>vector</em> of Fahrenheit temperatures? What if you use it in a
<code>mutate</code>?</li>
</ol>
<p>Solution</p>
<p>Try it and see:</p>
<div class="sourceCode" id="cb1446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1446-1"><a href="functions.html#cb1446-1"></a>temps &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">30</span>, <span class="dv">80</span>, <span class="dv">10</span>)</span>
<span id="cb1446-2"><a href="functions.html#cb1446-2"></a>temps</span></code></pre></div>
<pre><code>## [1] 30 40 50 60 70 80</code></pre>
<div class="sourceCode" id="cb1448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1448-1"><a href="functions.html#cb1448-1"></a><span class="kw">f_to_c</span>(temps)</span></code></pre></div>
<pre><code>## [1] -1.111111  4.444444 10.000000 15.555556 21.111111
## [6] 26.666667</code></pre>
<p>Each of the Fahrenheit temperatures gets converted into a Celsius
one. This is perhaps more useful in a data frame, thus:</p>
<div class="sourceCode" id="cb1450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1450-1"><a href="functions.html#cb1450-1"></a><span class="kw">tibble</span>(<span class="dt">temps =</span> <span class="kw">seq</span>(<span class="dv">30</span>, <span class="dv">80</span>, <span class="dv">10</span>)) <span class="op">%&gt;%</span></span>
<span id="cb1450-2"><a href="functions.html#cb1450-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">celsius =</span> <span class="kw">f_to_c</span>(temps))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["temps"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["celsius"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"30","2":"-1.111111"},{"1":"40","2":"4.444444"},{"1":"50","2":"10.000000"},{"1":"60","2":"15.555556"},{"1":"70","2":"21.111111"},{"1":"80","2":"26.666667"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>All the temperatures are side-by-side with their equivalents.</p>
<p>Here’s another way to do the above:</p>
<div class="sourceCode" id="cb1451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1451-1"><a href="functions.html#cb1451-1"></a>temps &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">30</span>, <span class="dv">80</span>, <span class="dv">10</span>)</span>
<span id="cb1451-2"><a href="functions.html#cb1451-2"></a>temps <span class="op">%&gt;%</span></span>
<span id="cb1451-3"><a href="functions.html#cb1451-3"></a><span class="st">  </span><span class="kw">enframe</span>(<span class="dt">value =</span> <span class="st">&quot;fahrenheit&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1451-4"><a href="functions.html#cb1451-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">celsius =</span> <span class="kw">f_to_c</span>(temps))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["int"],"align":["right"]},{"label":["fahrenheit"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["celsius"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"30","3":"-1.111111"},{"1":"2","2":"40","3":"4.444444"},{"1":"3","2":"50","3":"10.000000"},{"1":"4","2":"60","3":"15.555556"},{"1":"5","2":"70","3":"21.111111"},{"1":"6","2":"80","3":"26.666667"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code>enframe</code> creates a two-column data frame out of a vector (like
<code>temps</code>). A vector can have “names”, in which case they’ll be
used as the <code>name</code> column; the values will go in a column
called <code>value</code> unless you rename it, as I did.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Write another function called <code>wrap</code> that takes two
arguments: a piece of text called <code>text</code>, which defaults to
<code>hello</code>, and another piece of text called <code>outside</code>,
which defaults to <code>*</code>. The function returns <code>text</code>
with the text <code>outside</code> placed before and after, so that
calling the function with the defaults should return
<code>*hello*</code>. To do this, you can use <code>str_c</code> from
<code>stringr</code> (loaded with the <code>tidyverse</code>) which places
its text arguments side by side and glues them together into one
piece of text. Test your function briefly.</li>
</ol>
<p>Solution</p>
<p>This:</p>
<div class="sourceCode" id="cb1452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1452-1"><a href="functions.html#cb1452-1"></a>wrap &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">text =</span> <span class="st">&quot;hello&quot;</span>, <span class="dt">outside =</span> <span class="st">&quot;*&quot;</span>) {</span>
<span id="cb1452-2"><a href="functions.html#cb1452-2"></a>  <span class="kw">str_c</span>(outside, text, outside)</span>
<span id="cb1452-3"><a href="functions.html#cb1452-3"></a>}</span></code></pre></div>
<p>I can run this with the defaults:</p>
<div class="sourceCode" id="cb1453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1453-1"><a href="functions.html#cb1453-1"></a><span class="kw">wrap</span>()</span></code></pre></div>
<pre><code>## [1] &quot;*hello*&quot;</code></pre>
<p>or with text of my choosing:</p>
<div class="sourceCode" id="cb1455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1455-1"><a href="functions.html#cb1455-1"></a><span class="kw">wrap</span>(<span class="st">&quot;goodbye&quot;</span>, <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;_goodbye_&quot;</code></pre>
<p>I think that’s what I meant by “test briefly”.</p>
<ol start="7" style="list-style-type: lower-alpha">
<li>What happens if you want to change the default
<code>outside</code> but use the default for <code>text</code>? How do you
make sure that happens? Explore.</li>
</ol>
<p>Solution</p>
<p>The obvious thing is this, which doesn’t work:</p>
<div class="sourceCode" id="cb1457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1457-1"><a href="functions.html#cb1457-1"></a><span class="kw">wrap</span>(<span class="st">&quot;!&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;*!*&quot;</code></pre>
<p>This takes <em><code>text</code></em> to be <code>!</code>, and <code>outside</code>
to be the default. How do we get <code>outside</code> to be <code>!</code>
instead? The key is to specify the input by name:</p>
<div class="sourceCode" id="cb1459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1459-1"><a href="functions.html#cb1459-1"></a><span class="kw">wrap</span>(<span class="dt">outside =</span> <span class="st">&quot;!&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;!hello!&quot;</code></pre>
<p>This correctly uses the default for <code>text</code>.</p>
<p>If you specify inputs without names, they are
taken to be in the order that they appear in the function
definition. As soon as they get out of order, which typically happens
by using the default for something early in the list, as we did here
for <code>text</code>, you have to specify names for anything that comes
after that. These are the names you put on the function’s top line.</p>
<p>You can always use names:</p>
<div class="sourceCode" id="cb1461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1461-1"><a href="functions.html#cb1461-1"></a><span class="kw">wrap</span>(<span class="dt">text =</span> <span class="st">&quot;thing&quot;</span>, <span class="dt">outside =</span> <span class="st">&quot;**&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;**thing**&quot;</code></pre>
<p>and if you use names, they don’t even have to be in order:</p>
<div class="sourceCode" id="cb1463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1463-1"><a href="functions.html#cb1463-1"></a><span class="kw">wrap</span>(<span class="dt">outside =</span> <span class="st">&quot;!?&quot;</span>, <span class="dt">text =</span> <span class="st">&quot;fred&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;!?fred!?&quot;</code></pre>
<ol start="8" style="list-style-type: lower-alpha">
<li>What happens if you feed your function <code>wrap</code> a vector
for either of its arguments? What about if you use it in a
<code>mutate</code>?</li>
</ol>
<p>Solution</p>
<p>Let’s try:</p>
<div class="sourceCode" id="cb1465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1465-1"><a href="functions.html#cb1465-1"></a>mytext &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb1465-2"><a href="functions.html#cb1465-2"></a><span class="kw">wrap</span>(<span class="dt">text =</span> mytext)</span></code></pre></div>
<pre><code>## [1] &quot;*a*&quot; &quot;*b*&quot; &quot;*c*&quot;</code></pre>
<div class="sourceCode" id="cb1467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1467-1"><a href="functions.html#cb1467-1"></a>myout &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;*&quot;</span>, <span class="st">&quot;!&quot;</span>)</span>
<span id="cb1467-2"><a href="functions.html#cb1467-2"></a><span class="kw">wrap</span>(<span class="dt">outside =</span> myout)</span></code></pre></div>
<pre><code>## [1] &quot;*hello*&quot; &quot;!hello!&quot;</code></pre>
<p>If one of the inputs is a vector, the other one gets “recycled” as
many times as the vector is long. What if they’re both vectors?</p>
<div class="sourceCode" id="cb1469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1469-1"><a href="functions.html#cb1469-1"></a>mytext2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb1469-2"><a href="functions.html#cb1469-2"></a><span class="kw">wrap</span>(mytext2, myout)</span></code></pre></div>
<pre><code>## [1] &quot;*a*&quot; &quot;!b!&quot; &quot;*c*&quot; &quot;!d!&quot;</code></pre>
<p>This uses the two inputs in parallel, repeating the short one as
needed. But this, though it works, gives a warning:</p>
<div class="sourceCode" id="cb1471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1471-1"><a href="functions.html#cb1471-1"></a><span class="kw">wrap</span>(mytext, myout)</span></code></pre></div>
<pre><code>## Warning in stri_c(..., sep = sep, collapse = collapse,
## ignore_null = TRUE): longer object length is not a multiple
## of shorter object length</code></pre>
<pre><code>## [1] &quot;*a*&quot; &quot;!b!&quot; &quot;*c*&quot;</code></pre>
<p>This is because the shorter vector (of length 2 here) doesn’t go
evenly into the longer one (length 3). It gives a warning because this
is probably not what you wanted.</p>
<p>The <code>mutate</code> thing is easier, because all the columns in a data
frame have to be the same length. <code>LETTERS</code> is a vector with
the uppercase letters in it:</p>
<div class="sourceCode" id="cb1474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1474-1"><a href="functions.html#cb1474-1"></a><span class="kw">tibble</span>(<span class="dt">mytext =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">myout =</span> <span class="kw">c</span>(<span class="st">&quot;*&quot;</span>, <span class="st">&quot;**&quot;</span>, <span class="st">&quot;!&quot;</span>, <span class="st">&quot;!!&quot;</span>, <span class="st">&quot;_&quot;</span>, <span class="st">&quot;__&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb1474-2"><a href="functions.html#cb1474-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">newthing =</span> <span class="kw">wrap</span>(mytext, myout))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mytext"],"name":[1],"type":["chr"],"align":["left"]},{"label":["myout"],"name":[2],"type":["chr"],"align":["left"]},{"label":["newthing"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"A","2":"*","3":"*A*"},{"1":"B","2":"**","3":"**B**"},{"1":"C","2":"!","3":"!C!"},{"1":"D","2":"!!","3":"!!D!!"},{"1":"E","2":"_","3":"_E_"},{"1":"F","2":"__","3":"__F__"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="the-collatz-sequence" class="section level2" number="19.2">
<h2><span class="header-section-number">19.2</span> The Collatz sequence</h2>
<p>The Collatz sequence is a sequence of integers <span class="math inline">\(x_1, x_2, \ldots\)</span> defined in a
deceptively simple way: if <span class="math inline">\(x_n\)</span> is the current term of the sequence,
then <span class="math inline">\(x_{n+1}\)</span> is defined as <span class="math inline">\(x_n/2\)</span> if <span class="math inline">\(x_n\)</span> is even, and <span class="math inline">\(3x_n+1\)</span> if
<span class="math inline">\(x_n\)</span> is odd.
We are interested in understanding how this sequence
behaves; for example, what happens to it as <span class="math inline">\(n\)</span> gets large, for
different choices of the first term <span class="math inline">\(x_1\)</span>? We will explore this
numerically with R; the ambitious among you might like to look into
the mathematics of it.</p>
<ol style="list-style-type: lower-alpha">
<li>What happens to the sequence when it reaches 4? What would be
a sensible way of defining where it ends? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>When the sequence reaches 4 (that is, when its current term is 4),
the next term is 2 and the one after that is 1. Then the following
term is 4 again (<span class="math inline">\((3 \times 1)+1\)</span>) and then it repeats
indefinitely, <span class="math inline">\(4, 2, 1, 4, 2, 1, \ldots\)</span>.
I think a sensible way to define where the sequence ends is to say
“when it reaches 1”, since if you start at 2 you’ll never reach
4 (so “when it reaches 4” won’t work), and it seems at least
plausible that it will hit the cycle 4, 2, 1 sometime.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Write an R function called <code>is_odd</code> that returns
<code>TRUE</code> if its input is an odd number and <code>FALSE</code> if it
is even (you can assume that the input is an integer and not a
decimal number). To do <em>that</em>, you can use the function <code>%%</code> where
<code>a %% b</code> is the remainder when <code>a</code> is divided by
<code>b</code>. To think about oddness or evenness, consider the
remainder when you divide by 2.</li>
</ol>
<p>Solution</p>
<p>Let’s try this out. For example, 5 is odd and 6 is even, so</p>
<div class="sourceCode" id="cb1475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1475-1"><a href="functions.html#cb1475-1"></a><span class="dv">5</span> <span class="op">%%</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb1477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1477-1"><a href="functions.html#cb1477-1"></a><span class="dv">6</span> <span class="op">%%</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>When a number is odd, its remainder on dividing by 2 is 1, and when
even, the remainder is 0. There is an additional shortcut here in that
1 is the numeric value of <code>TRUE</code> and 0 of <code>FALSE</code>, so
all we have to do is calculate the remainder on dividing by 2, turn it
into a <code>logical</code>, and return it:</p>
<div class="sourceCode" id="cb1479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1479-1"><a href="functions.html#cb1479-1"></a>is_odd &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1479-2"><a href="functions.html#cb1479-2"></a>  r &lt;-<span class="st"> </span>x <span class="op">%%</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb1479-3"><a href="functions.html#cb1479-3"></a>  <span class="kw">as.logical</span>(r)</span>
<span id="cb1479-4"><a href="functions.html#cb1479-4"></a>}</span></code></pre></div>
<p>You probably haven’t seen <code>as.logical</code> before, but it’s the
same idea as <code>as.numeric</code>: turn something that looks like a
<code>TRUE</code> or <code>FALSE</code> into something that actually
<em>is</em>.</p>
<p>We should test it:</p>
<div class="sourceCode" id="cb1480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1480-1"><a href="functions.html#cb1480-1"></a><span class="kw">is_odd</span>(<span class="dv">19</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1482-1"><a href="functions.html#cb1482-1"></a><span class="kw">is_odd</span>(<span class="dv">12</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb1484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1484-1"><a href="functions.html#cb1484-1"></a><span class="kw">is_odd</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>0 is usually considered an even number, so this is good.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Write an R function called
<code>hotpo1</code>
<label for="tufte-mn-129" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-129" class="margin-toggle"><span class="marginnote"><em>Hotpo</em> is short for half or triple-plus-one.</span>
that takes an
integer as input and returns the next number in the Collatz
sequence. To do this, use the function you just wrote that
determines whether a number is even or odd.</li>
</ol>
<p>Solution</p>
<p>The logic is “if the input is odd, return 3 times it plus 1, otherwise return half of it”.
The R structure is an
<code>if-then-else</code>:</p>
<div class="sourceCode" id="cb1486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1486-1"><a href="functions.html#cb1486-1"></a>hotpo1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1486-2"><a href="functions.html#cb1486-2"></a>  <span class="cf">if</span> (<span class="kw">is_odd</span>(x)) <span class="dv">3</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="cf">else</span> x <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb1486-3"><a href="functions.html#cb1486-3"></a>}</span></code></pre></div>
<p>In R, the condition that is tested goes in brackets, and then if the
value-if-true and the value-if-false are single statements, you just
type them. (If they are more complicated than that, you put them in
curly brackets.) Now you see the value of writing <code>is_odd</code>
earlier; this code almost looks like the English-language description
of the sequence. If we had not written <code>is_odd</code> before, the
condition would have looked something like</p>
<div class="sourceCode" id="cb1487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1487-1"><a href="functions.html#cb1487-1"></a><span class="cf">if</span> (x <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="dv">3</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="cf">else</span> x <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<p>which would have been a lot harder to read.</p>
<p>All right, let’s try that out:</p>
<div class="sourceCode" id="cb1488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1488-1"><a href="functions.html#cb1488-1"></a><span class="kw">hotpo1</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb1490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1490-1"><a href="functions.html#cb1490-1"></a><span class="kw">hotpo1</span>(<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 22</code></pre>
<div class="sourceCode" id="cb1492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1492-1"><a href="functions.html#cb1492-1"></a><span class="kw">hotpo1</span>(<span class="dv">24</span>)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<p>That looks all right so far.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Now write a function <code>hotpo</code> that will return the whole
Collatz sequence for an input <span class="math inline">\(x_1\)</span>. For this, assume that you will
eventually get to 1.</li>
</ol>
<p>Solution</p>
<p>This is a loop, but not a <code>for</code> loop (or something that we
could do <code>rowwise</code>), because we don’t know how many
times we have to go around. This is the kind of thing that we
should use a <code>while</code> loop for:
“keep going while a condition is true”.
In this case, we should keep going if we haven’t reached 1 yet. If
we haven’t reached 1, we should generate the next value of the
sequence and glue it onto what we have so far. To initialize the
sequence, we start with the input value. There is an R trick to
glue a value onto the sequence, which is to use <code>c</code> with a
vector and a value, and save it back into the vector:</p>
<div class="sourceCode" id="cb1494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1494-1"><a href="functions.html#cb1494-1"></a>hotpo &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1494-2"><a href="functions.html#cb1494-2"></a>  sequence &lt;-<span class="st"> </span>x</span>
<span id="cb1494-3"><a href="functions.html#cb1494-3"></a>  term &lt;-<span class="st"> </span>x</span>
<span id="cb1494-4"><a href="functions.html#cb1494-4"></a>  <span class="cf">while</span> (term <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb1494-5"><a href="functions.html#cb1494-5"></a>    term &lt;-<span class="st"> </span><span class="kw">hotpo1</span>(term)</span>
<span id="cb1494-6"><a href="functions.html#cb1494-6"></a>    sequence &lt;-<span class="st"> </span><span class="kw">c</span>(sequence, term)</span>
<span id="cb1494-7"><a href="functions.html#cb1494-7"></a>  }</span>
<span id="cb1494-8"><a href="functions.html#cb1494-8"></a>  sequence</span>
<span id="cb1494-9"><a href="functions.html#cb1494-9"></a>}</span></code></pre></div>
<p>I use <code>term</code> to hold the current term of the sequence, and
overwrite it with the next one (since I don’t need the old one any
more).</p>
<p>Does it work?</p>
<div class="sourceCode" id="cb1495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1495-1"><a href="functions.html#cb1495-1"></a><span class="kw">hotpo</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 4 2 1</code></pre>
<div class="sourceCode" id="cb1497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1497-1"><a href="functions.html#cb1497-1"></a><span class="kw">hotpo</span>(<span class="dv">12</span>)</span></code></pre></div>
<pre><code>##  [1] 12  6  3 10  5 16  8  4  2  1</code></pre>
<div class="sourceCode" id="cb1499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1499-1"><a href="functions.html#cb1499-1"></a><span class="kw">hotpo</span>(<span class="dv">97</span>)</span></code></pre></div>
<pre><code>##   [1]   97  292  146   73  220  110   55  166   83  250  125
##  [12]  376  188   94   47  142   71  214  107  322  161  484
##  [23]  242  121  364  182   91  274  137  412  206  103  310
##  [34]  155  466  233  700  350  175  526  263  790  395 1186
##  [45]  593 1780  890  445 1336  668  334  167  502  251  754
##  [56]  377 1132  566  283  850  425 1276  638  319  958  479
##  [67] 1438  719 2158 1079 3238 1619 4858 2429 7288 3644 1822
##  [78]  911 2734 1367 4102 2051 6154 3077 9232 4616 2308 1154
##  [89]  577 1732  866  433 1300  650  325  976  488  244  122
## [100]   61  184   92   46   23   70   35  106   53  160   80
## [111]   40   20   10    5   16    8    4    2    1</code></pre>
<p>97 is a wild ride, but it does eventually get to 1.</p>
<p>Extra: where I originally saw this, which was “Metamagical Themas”
by Douglas Hofstadter, he was illustrating the programming language
Lisp and the process of recursion, whereby you define a function in
terms of itself. This one is a natural for that, because the Collatz
sequence starting at <span class="math inline">\(x\)</span> is <span class="math inline">\(x\)</span> along with the Collatz sequence
starting at the next term. For example, if you start at 12, the next
term is 6, so that the Collatz sequence starting at 12 is 12 followed by
the Collatz sequence starting at 6. There is no dependence any further
back. You can do recursion in R also; there is no problem with a
function calling itself:</p>
<div class="sourceCode" id="cb1501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1501-1"><a href="functions.html#cb1501-1"></a>hotpo_rec &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1501-2"><a href="functions.html#cb1501-2"></a>  <span class="cf">if</span> (x <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="dv">1</span> <span class="cf">else</span> <span class="kw">c</span>(x, <span class="kw">hotpo_rec</span>(<span class="kw">hotpo1</span>(x)))</span>
<span id="cb1501-3"><a href="functions.html#cb1501-3"></a>}</span></code></pre></div>
<p>Recursive functions have two parts: a “base case” that says how you
know you are done (the 1 here), and a “recursion” that says how you
move to a simpler case, here working out the next term, getting the
whole sequence for that, and gluing the input onto the front. It seems
paradoxical that you define a function in terms of itself, but what
you are doing is calling a simpler sequence, in this case one that is
length one shorter than the sequence for the original input. Thus, we
hope,
<label for="tufte-mn-130" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-130" class="margin-toggle"><span class="marginnote">Nobody knows whether you <em>always</em> get to 1, but also nobody has ever found a case where you don’t. Collatz’s conjecture, that you will get to 1 eventually, is known to be true for all starting <span class="math inline">\(x_1\)</span> up to some absurdly large number, but not for <em>all</em> starting points.</span>
we will eventually reach 1.</p>
<p>Does it work?</p>
<div class="sourceCode" id="cb1502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1502-1"><a href="functions.html#cb1502-1"></a><span class="kw">hotpo_rec</span>(<span class="dv">12</span>)</span></code></pre></div>
<pre><code>##  [1] 12  6  3 10  5 16  8  4  2  1</code></pre>
<div class="sourceCode" id="cb1504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1504-1"><a href="functions.html#cb1504-1"></a><span class="kw">hotpo_rec</span>(<span class="dv">97</span>)</span></code></pre></div>
<pre><code>##   [1]   97  292  146   73  220  110   55  166   83  250  125
##  [12]  376  188   94   47  142   71  214  107  322  161  484
##  [23]  242  121  364  182   91  274  137  412  206  103  310
##  [34]  155  466  233  700  350  175  526  263  790  395 1186
##  [45]  593 1780  890  445 1336  668  334  167  502  251  754
##  [56]  377 1132  566  283  850  425 1276  638  319  958  479
##  [67] 1438  719 2158 1079 3238 1619 4858 2429 7288 3644 1822
##  [78]  911 2734 1367 4102 2051 6154 3077 9232 4616 2308 1154
##  [89]  577 1732  866  433 1300  650  325  976  488  244  122
## [100]   61  184   92   46   23   70   35  106   53  160   80
## [111]   40   20   10    5   16    8    4    2    1</code></pre>
<p>It does.</p>
<p>Recursive functions are often simple to understand, but they are not
always very efficient. They can take a lot of memory, because they
have to handle the intermediate calls to the function, which they have
to save to use later (in the case of <code>hotpo_rec(97)</code> there are a
lot of those). Recursive functions are often paired with a technique
called “memoization”, where each time you calculate the function’s
value, you <em>save</em> it in another array. The first thing you do in
the recursive function is to check whether you already have the
answer, in which case you just look it up and return it. It was a lot
of work here to calculate the sequence from 97, but if we had saved
the results, we would already have the answers for 292, 146, 73, 220
and so on, and getting those later would be a table lookup rather than
another recursive calculation.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Write two (very small) functions that take an entire sequence
as input and return (i) the length of the sequence and (ii) the
maximum value it attains.</li>
</ol>
<p>Solution</p>
<p>These are both one-liners. Call the input whatever you like:</p>
<div class="sourceCode" id="cb1506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1506-1"><a href="functions.html#cb1506-1"></a>hotpo_len &lt;-<span class="st"> </span><span class="cf">function</span>(sequence) <span class="kw">length</span>(sequence)</span>
<span id="cb1506-2"><a href="functions.html#cb1506-2"></a>hotpo_max &lt;-<span class="st"> </span><span class="cf">function</span>(sequence) <span class="kw">max</span>(sequence)</span></code></pre></div>
<p>Because they are one-liners, you don’t even need the curly brackets,
although there’s no problem if they are there.</p>
<p>Testing:</p>
<div class="sourceCode" id="cb1507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1507-1"><a href="functions.html#cb1507-1"></a><span class="kw">hotpo_len</span>(<span class="kw">hotpo</span>(<span class="dv">12</span>))</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb1509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1509-1"><a href="functions.html#cb1509-1"></a><span class="kw">hotpo_max</span>(<span class="kw">hotpo</span>(<span class="dv">97</span>))</span></code></pre></div>
<pre><code>## [1] 9232</code></pre>
<p>This checks with what we had before.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Make a data frame consisting of the values 11 through 20, and,
using <code>tidyverse</code> ideas, obtain a data frame containing the
Collatz sequences starting at each of those values, along with their
lengths and their maximum values. Which sequence is longest? Which
one goes up highest?</li>
</ol>
<p>Solution</p>
<p>This one uses <code>rowwise</code> ideas:
<label for="tufte-mn-131" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-131" class="margin-toggle"><span class="marginnote">I should have been more careful in my functions to make sure everything was integers, and, in particular, to do integer division by 2 because I knew that this division was going to come out even.</span></p>
<div class="sourceCode" id="cb1511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1511-1"><a href="functions.html#cb1511-1"></a><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">11</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span></span>
<span id="cb1511-2"><a href="functions.html#cb1511-2"></a><span class="st">  </span>rowwise <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1511-3"><a href="functions.html#cb1511-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sequence =</span> <span class="kw">list</span>(<span class="kw">hotpo</span>(x))) <span class="op">%&gt;%</span></span>
<span id="cb1511-4"><a href="functions.html#cb1511-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">length =</span> <span class="kw">hotpo_len</span>(sequence)) <span class="op">%&gt;%</span></span>
<span id="cb1511-5"><a href="functions.html#cb1511-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">high =</span> <span class="kw">hotpo_max</span>(sequence))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["int"],"align":["right"]},{"label":["sequence"],"name":[2],"type":["list"],"align":["right"]},{"label":["length"],"name":[3],"type":["int"],"align":["right"]},{"label":["high"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"11","2":"<dbl [15]>","3":"15","4":"52"},{"1":"12","2":"<dbl [10]>","3":"10","4":"16"},{"1":"13","2":"<dbl [10]>","3":"10","4":"40"},{"1":"14","2":"<dbl [18]>","3":"18","4":"52"},{"1":"15","2":"<dbl [18]>","3":"18","4":"160"},{"1":"16","2":"<dbl [5]>","3":"5","4":"16"},{"1":"17","2":"<dbl [13]>","3":"13","4":"52"},{"1":"18","2":"<dbl [21]>","3":"21","4":"52"},{"1":"19","2":"<dbl [21]>","3":"21","4":"88"},{"1":"20","2":"<dbl [8]>","3":"8","4":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>First, we obtain a list-column containing the sequences (which is why its calculation needs a <code>list</code> around it), then two
ordinary columns of their lengths and their maximum values.</p>
<p>The sequences for 18 and 19 are the longest, but the sequence for 15
goes up the highest.</p>

</div>
</div>
<p style="text-align: center;">
<a href="dates-and-times.html"><button class="btn btn-default">Previous</button></a>
<a href="the-bootstrap.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>

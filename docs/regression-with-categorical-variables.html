<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 18 Regression with categorical variables | Problems and Solutions in Applied Statistics" />
<meta property="og:type" content="book" />
<meta property="og:url" content="http://ritsokiguess.site/pasias" />

<meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
<meta name="github-repo" content="nxskok/pasias" />

<meta name="author" content="Ken Butler" />

<meta name="date" content="2021-04-26" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="/usr/share/javascript/mathjax/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics">

<title>Chapter 18 Regression with categorical variables | Problems and Solutions in Applied Statistics</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#introduction">Introduction</a><ul>
<li><a href="index.html#packages-used-somewhere-in-this-book">Packages used somewhere in this book</a></li>
</ul></li>
<li><a href="getting-used-to-r-and-r-studio.html#getting-used-to-r-and-r-studio"><span class="toc-section-number">1</span> Getting used to R and R Studio</a></li>
<li><a href="reading-in-data.html#reading-in-data"><span class="toc-section-number">2</span> Reading in data</a></li>
<li><a href="drawing-graphs.html#drawing-graphs"><span class="toc-section-number">3</span> Drawing graphs</a></li>
<li><a href="data-exploration.html#data-exploration"><span class="toc-section-number">4</span> Data exploration</a></li>
<li class="has-sub"><a href="working-with-dataframes.html#working-with-dataframes"><span class="toc-section-number">5</span> Working with dataframes</a><ul>
<li><a href="working-with-dataframes.html#tidying-the-jays-data"><span class="toc-section-number">5.1</span> Tidying the Jays data</a></li>
<li><a href="working-with-dataframes.html#cars"><span class="toc-section-number">5.2</span> Cars</a></li>
<li><a href="working-with-dataframes.html#tidying-the-jays-data-1"><span class="toc-section-number">5.3</span> Tidying the Jays data</a></li>
<li><a href="working-with-dataframes.html#cars-1"><span class="toc-section-number">5.4</span> Cars</a></li>
</ul></li>
<li><a href="one-sample-inference.html#one-sample-inference"><span class="toc-section-number">6</span> One-sample inference</a></li>
<li><a href="two-sample-inference.html#two-sample-inference"><span class="toc-section-number">7</span> Two-sample inference</a></li>
<li><a href="power-and-sample-size.html#power-and-sample-size"><span class="toc-section-number">8</span> Power and sample size</a></li>
<li><a href="the-sign-test.html#the-sign-test"><span class="toc-section-number">9</span> The sign test</a></li>
<li><a href="mood-median-test.html#mood-median-test"><span class="toc-section-number">10</span> Mood median test</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#matched-pairs-t-and-sign-test"><span class="toc-section-number">11</span> Matched pairs t and sign test</a></li>
<li class="has-sub"><a href="normal-quantile-plots.html#normal-quantile-plots"><span class="toc-section-number">12</span> Normal quantile plots</a><ul>
<li><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><span class="toc-section-number">12.1</span> Lengths of heliconia flowers</a></li>
<li><a href="normal-quantile-plots.html#ferritin-and-normality"><span class="toc-section-number">12.2</span> Ferritin and normality</a></li>
<li><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers-1"><span class="toc-section-number">12.3</span> Lengths of heliconia flowers</a></li>
<li><a href="normal-quantile-plots.html#ferritin-and-normality-1"><span class="toc-section-number">12.4</span> Ferritin and normality</a></li>
</ul></li>
<li><a href="analysis-of-variance.html#analysis-of-variance"><span class="toc-section-number">13</span> Analysis of variance</a></li>
<li><a href="writing-reports.html#writing-reports"><span class="toc-section-number">14</span> Writing reports</a></li>
<li><a href="tidying-data.html#tidying-data"><span class="toc-section-number">15</span> Tidying data</a></li>
<li><a href="simple-regression.html#simple-regression"><span class="toc-section-number">16</span> Simple regression</a></li>
<li><a href="multiple-regression.html#multiple-regression"><span class="toc-section-number">17</span> Multiple regression</a></li>
<li class="has-sub"><a href="regression-with-categorical-variables.html#regression-with-categorical-variables"><span class="toc-section-number">18</span> Regression with categorical variables</a><ul>
<li><a href="regression-with-categorical-variables.html#crickets-revisited"><span class="toc-section-number">18.1</span> Crickets revisited</a></li>
<li><a href="regression-with-categorical-variables.html#pulse-rates-and-marching"><span class="toc-section-number">18.2</span> Pulse rates and marching</a></li>
<li><a href="regression-with-categorical-variables.html#crickets-revisited-1"><span class="toc-section-number">18.3</span> Crickets revisited</a></li>
<li><a href="regression-with-categorical-variables.html#pulse-rates-and-marching-1"><span class="toc-section-number">18.4</span> Pulse rates and marching</a></li>
</ul></li>
<li><a href="dates-and-times.html#dates-and-times"><span class="toc-section-number">19</span> Dates and times</a></li>
<li><a href="functions.html#functions"><span class="toc-section-number">20</span> Functions</a></li>
<li class="has-sub"><a href="vector-and-matrix-algebra.html#vector-and-matrix-algebra"><span class="toc-section-number">21</span> Vector and matrix algebra</a><ul>
<li><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again"><span class="toc-section-number">21.1</span> Heights and foot lengths again</a></li>
<li><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again-1"><span class="toc-section-number">21.2</span> Heights and foot lengths again</a></li>
</ul></li>
<li><a href="the-bootstrap.html#the-bootstrap"><span class="toc-section-number">22</span> The Bootstrap</a></li>
<li><a href="bayesian-statistics-with-stan.html#bayesian-statistics-with-stan"><span class="toc-section-number">23</span> Bayesian Statistics with Stan</a></li>
<li><a href="logistic-regression.html#logistic-regression"><span class="toc-section-number">24</span> Logistic regression</a></li>
<li><a href="logistic-regression-with-ordinal-response.html#logistic-regression-with-ordinal-response"><span class="toc-section-number">25</span> Logistic regression with ordinal response</a></li>
<li><a href="logistic-regression-with-nominal-response.html#logistic-regression-with-nominal-response"><span class="toc-section-number">26</span> Logistic regression with nominal response</a></li>
<li><a href="survival-analysis.html#survival-analysis"><span class="toc-section-number">27</span> Survival analysis</a></li>
<li><a href="analysis-of-variance-revisited.html#analysis-of-variance-revisited"><span class="toc-section-number">28</span> Analysis of variance revisited</a></li>
<li><a href="analysis-of-covariance.html#analysis-of-covariance"><span class="toc-section-number">29</span> Analysis of covariance</a></li>
<li><a href="multivariate-analysis-of-variance.html#multivariate-analysis-of-variance"><span class="toc-section-number">30</span> Multivariate analysis of variance</a></li>
<li><a href="repeated-measures.html#repeated-measures"><span class="toc-section-number">31</span> Repeated measures</a></li>
<li><a href="discriminant-analysis.html#discriminant-analysis"><span class="toc-section-number">32</span> Discriminant analysis</a></li>
<li><a href="hierarchical-cluster-analysis.html#hierarchical-cluster-analysis"><span class="toc-section-number">33</span> Hierarchical cluster analysis</a></li>
<li><a href="k-means-cluster-analysis.html#k-means-cluster-analysis"><span class="toc-section-number">34</span> K-means cluster analysis</a></li>
<li><a href="drawing-maps-with-leaflet.html#drawing-maps-with-leaflet"><span class="toc-section-number">35</span> Drawing maps with Leaflet</a></li>
<li><a href="multidimensional-scaling.html#multidimensional-scaling"><span class="toc-section-number">36</span> Multidimensional Scaling</a></li>
<li class="has-sub"><a href="principal-components.html#principal-components"><span class="toc-section-number">37</span> Principal Components</a><ul>
<li><a href="principal-components.html#the-weather-somewhere"><span class="toc-section-number">37.1</span> The weather, somewhere</a></li>
<li><a href="principal-components.html#the-weather-somewhere-1"><span class="toc-section-number">37.2</span> The weather, somewhere</a></li>
</ul></li>
<li><a href="factor-analysis.html#factor-analysis"><span class="toc-section-number">38</span> Factor Analysis</a></li>
<li><a href="frequency-table-analysis.html#frequency-table-analysis"><span class="toc-section-number">39</span> Frequency table analysis</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="regression-with-categorical-variables" class="section level1">
<h1><span class="header-section-number">Chapter 18</span> Regression with categorical variables</h1>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="crickets-revisited" class="section level2">
<h2><span class="header-section-number">18.1</span> Crickets revisited</h2>
<p>This is a continuation of the crickets problem that you
may have seen before (minus the data tidying).</p>
<p>Male tree crickets produce “mating songs” by rubbing their wings
together to produce a chirping sound. It is hypothesized that female
tree crickets identify males of the correct species by how fast (in
chirps per second) the male’s mating song is. This is called the
“pulse rate”. Some data for two species of crickets are in
<a href="http://ritsokiguess.site/datafiles/crickets2.csv">link</a> as a CSV
file. The columns are species (text), temperature, and pulse
rate (numbers). This is the tidied version of the data set that the
previous version of this question had you create.
The research question is whether males
of the different species have different average pulse rates. It is
also of interest to see whether temperature has an effect, and if
so, what.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read the data into R and display what you have.</p></li>
<li><p>Do a two-sample <span class="math inline">\(t\)</span>-test to see whether the mean pulse rates
differ between species. What do you conclude?</p></li>
<li><p>Can you do that two-sample <span class="math inline">\(t\)</span>-test as a regression?</p></li>
<li><p>The analysis in the last part did not use temperature,
however. Is it possible that temperature also has an effect? To
assess this, draw a scatterplot of pulse rate against temperature,
with the points distinguished, somehow, by the species they are
from.<label for="tufte-sn-5" class="margin-toggle sidenote-number">5</label><input type="checkbox" id="tufte-sn-5" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">5</span> This was the actual reason I thought of this question originally: I wanted you to do this.</span></p></li>
<li><p>What does the plot tell you that the <span class="math inline">\(t\)</span>-test doesn’t? How
would you describe differences in pulse rates between species now?</p></li>
<li><p>Fit a regression predicting pulse rate from species and
temperature. Compare the P-value for species in this regression to
the one from the <span class="math inline">\(t\)</span>-test. What does that tell you?</p></li>
<li><p>Make suitable residual plots for the regression
<code>pulse.1</code>.</p></li>
</ol>
</div>
<div id="pulse-rates-and-marching" class="section level2">
<h2><span class="header-section-number">18.2</span> Pulse rates and marching</h2>
<p>Forty students, some male and some female, measured their resting pulse rates. Then they marched in place for one minute and measured their pulse rate again.
Our aim is to use regression to predict the pulse rate after the marching from the pulse rate before, and to see whether that is different for males and females. The data is in .</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in and display (some of) the data.</p></li>
<li><p>Make a suitable graph using all three variables, adding appropriate regression line(s) to the plot.</p></li>
<li><p>Explain briefly but carefully how any effects of pulse rate before on pulse rate after, and also of sex on pulse rate after, show up on your plot. (If either explanatory variable has no effect, explain how you know.)</p></li>
<li><p>Run a regression predicting pulse rate after from the other two variables. Display the output.</p></li>
<li><p>Looking at your graph, does the significance (or lack of) of each of your two explanatory variables surprise you? Explain briefly.</p></li>
<li><p>What does the numerical value of the Estimate for <code>Sex</code> in your regression output mean, in the context of this data set? Explain briefly.</p></li>
</ol>
<p>My solutions follow:</p>
</div>
<div id="crickets-revisited-1" class="section level2">
<h2><span class="header-section-number">18.3</span> Crickets revisited</h2>
<p>This is a continuation of the crickets problem that you
may have seen before (minus the data tidying).</p>
<p>Male tree crickets produce “mating songs” by rubbing their wings
together to produce a chirping sound. It is hypothesized that female
tree crickets identify males of the correct species by how fast (in
chirps per second) the male’s mating song is. This is called the
“pulse rate”. Some data for two species of crickets are in
<a href="http://ritsokiguess.site/datafiles/crickets2.csv">link</a> as a CSV
file. The columns are species (text), temperature, and pulse
rate (numbers). This is the tidied version of the data set that the
previous version of this question had you create.
The research question is whether males
of the different species have different average pulse rates. It is
also of interest to see whether temperature has an effect, and if
so, what.</p>
<ol style="list-style-type: lower-alpha">
<li>Read the data into R and display what you have.</li>
</ol>
<p>Solution</p>
<p>Nothing terribly surprising here:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/crickets2.csv&quot;</span></a>
<a class="sourceLine" id="cb51-2" title="2">crickets &lt;-<span class="st"> </span><span class="kw">read_csv</span>(my_url)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   species = col_character(),
##   temperature = col_double(),
##   pulse_rate = col_double()
## )</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">crickets</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["chr"],"align":["left"]},{"label":["temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["pulse_rate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"exclamationis","2":"20.8","3":"67.9"},{"1":"exclamationis","2":"20.8","3":"65.1"},{"1":"exclamationis","2":"24.0","3":"77.3"},{"1":"exclamationis","2":"24.0","3":"78.7"},{"1":"exclamationis","2":"24.0","3":"79.4"},{"1":"exclamationis","2":"24.0","3":"80.4"},{"1":"exclamationis","2":"26.2","3":"85.8"},{"1":"exclamationis","2":"26.2","3":"86.6"},{"1":"exclamationis","2":"26.2","3":"87.5"},{"1":"exclamationis","2":"26.2","3":"89.1"},{"1":"exclamationis","2":"28.4","3":"98.6"},{"1":"exclamationis","2":"29.0","3":"100.8"},{"1":"exclamationis","2":"30.4","3":"99.3"},{"1":"exclamationis","2":"30.4","3":"101.7"},{"1":"niveus","2":"17.2","3":"44.3"},{"1":"niveus","2":"18.3","3":"47.2"},{"1":"niveus","2":"18.3","3":"47.6"},{"1":"niveus","2":"18.3","3":"49.6"},{"1":"niveus","2":"18.9","3":"50.3"},{"1":"niveus","2":"18.9","3":"51.8"},{"1":"niveus","2":"20.4","3":"60.0"},{"1":"niveus","2":"21.0","3":"58.5"},{"1":"niveus","2":"21.0","3":"58.9"},{"1":"niveus","2":"22.1","3":"60.7"},{"1":"niveus","2":"23.5","3":"69.8"},{"1":"niveus","2":"24.2","3":"70.9"},{"1":"niveus","2":"25.9","3":"76.2"},{"1":"niveus","2":"26.5","3":"76.1"},{"1":"niveus","2":"26.5","3":"77.0"},{"1":"niveus","2":"26.5","3":"77.7"},{"1":"niveus","2":"28.6","3":"84.7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>31 crickets, which is what I remember. What species are there?</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">crickets <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(species)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"exclamationis","2":"14"},{"1":"niveus","2":"17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>That looks good. We proceed.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Do a two-sample <span class="math inline">\(t\)</span>-test to see whether the mean pulse rates
differ between species. What do you conclude?</li>
</ol>
<p>Solution</p>
<p>Drag your mind way back to this:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">t.test</span>(pulse_rate <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> crickets)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  pulse_rate by species
## t = 5.2236, df = 28.719, p-value = 1.401e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  14.08583 32.22677
## sample estimates:
## mean in group exclamationis        mean in group niveus 
##                    85.58571                    62.42941</code></pre>
<p>There is strong evidence of a difference in means (a P-value around
0.00001), and the confidence interval says that the mean chirp rate is
higher for <em>exclamationis</em>. That is, not just for the crickets
that were observed here, but for <em>all</em> crickets of these two
species.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Can you do that two-sample <span class="math inline">\(t\)</span>-test as a regression?</li>
</ol>
<p>Solution</p>
<p>Hang onto the “pulse rate depends on species” idea and try
that in <code>lm</code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">pulse<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(pulse_rate <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> crickets)</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">summary</span>(pulse<span class="fl">.0</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse_rate ~ species, data = crickets)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.486  -9.458  -1.729  13.342  22.271 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     85.586      3.316  25.807  &lt; 2e-16 ***
## speciesniveus  -23.156      4.478  -5.171 1.58e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.41 on 29 degrees of freedom
## Multiple R-squared:  0.4797, Adjusted R-squared:  0.4617 
## F-statistic: 26.74 on 1 and 29 DF,  p-value: 1.579e-05</code></pre>
<p>I had to use “model 0” for this since I already have a
<code>pulse.1</code> below and I didn’t want to go down and renumber
everything.</p>
<p>Look along the <code>speciesniveus</code> line. Ignoring the fact that it
is negative, the <span class="math inline">\(t\)</span>-statistic is almost the same as before (5.17 vs.<br />
5.22) and so is the P-value (<span class="math inline">\(1.4 \times 10^{-5}\)</span> vs. <span class="math inline">\(1.6 \times 10^{-5}\)</span>).</p>
<p>Why aren’t they exactly the same? Regression is assuming equal
variances everywhere (that is, within the two <code>species</code>), and
before, we did the Welch-Satterthwaite test that does not assume equal
variances. What if we do the pooled <span class="math inline">\(t\)</span>-test instead?</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">t.test</span>(pulse_rate <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> crickets, <span class="dt">var.equal =</span> T)</a></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  pulse_rate by species
## t = 5.1706, df = 29, p-value = 1.579e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  13.99690 32.31571
## sample estimates:
## mean in group exclamationis        mean in group niveus 
##                    85.58571                    62.42941</code></pre>
<p>Now the regression and the <span class="math inline">\(t\)</span>-test <em>do</em> give exactly the same
answers. We’ll think about that equal-spreads assumption again later.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>The analysis in the last part did not use temperature,
however. Is it possible that temperature also has an effect? To
assess this, draw a scatterplot of pulse rate against temperature,
with the points distinguished, somehow, by the species they are
from.<label for="tufte-sn-6" class="margin-toggle sidenote-number">6</label><input type="checkbox" id="tufte-sn-6" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">6</span> This was the actual reason I thought of this question originally: I wanted you to do this.</span></li>
</ol>
<p>Solution</p>
<p>One of the wonderful things about <code>ggplot</code> is that doing
the obvious thing works:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">ggplot</span>(crickets, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pulse_rate, <span class="dt">colour =</span> species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-56-1.png" width="672"  /></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>What does the plot tell you that the <span class="math inline">\(t\)</span>-test doesn’t? How
would you describe differences in pulse rates between species now?</li>
</ol>
<p>Solution</p>
<p>The plot tells you that (for both species) as temperature goes
up, pulse rate goes up as well. <em>Allowing for that</em>, the
difference in pulse rates between the two species is even
clearer than it was before. To see an example, pick a
temperature, and note that the mean pulse rate at that
temperature seems to be at least 10 higher for
<em>exclamationis</em>, with a high degree of consistency.
The <span class="math inline">\(t\)</span>-test mixed up all the pulse rates at all the different
temperatures. Even though the conclusion was clear enough, it
could be clearer if we incorporated temperature into the analysis.
There was also a potential source of unfairness in that the
<em>exclamationis</em> crickets tended to be observed at higher
temperatures than <em>niveus</em> crickets; since pulse rates
increase with temperature, the apparent difference in pulse
rates between the species might have been explainable by one
species being observed mainly in higher temperatures. This was
<em>utterly invisible</em> to us when we did the <span class="math inline">\(t\)</span>-test, but it
shows the importance of accounting for all the relevant
variables when you do your analysis.<label for="tufte-sn-7" class="margin-toggle sidenote-number">7</label><input type="checkbox" id="tufte-sn-7" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">7</span> And it shows the value of looking at relevant plots.</span> If the species had been
observed at opposite temperatures, we might have
concluded<label for="tufte-sn-8" class="margin-toggle sidenote-number">8</label><input type="checkbox" id="tufte-sn-8" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">8</span> Mistakenly.</span>
that <em>niveus</em> have the
higher pulse rates on average. I come back to this later when I
discuss the confidence interval for species difference that
comes out of the regression model with temperature.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Fit a regression predicting pulse rate from species and
temperature. Compare the P-value for species in this regression to
the one from the <span class="math inline">\(t\)</span>-test. What does that tell you?</li>
</ol>
<p>Solution</p>
<p>This is actually a so-called “analysis of covariance model”,
which properly belongs in D29, but it’s really just a regression:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">pulse<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(pulse_rate <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>temperature, <span class="dt">data =</span> crickets)</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">summary</span>(pulse<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse_rate ~ species + temperature, data = crickets)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.0128 -1.1296 -0.3912  0.9650  3.7800 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -7.21091    2.55094  -2.827  0.00858 ** 
## speciesniveus -10.06529    0.73526 -13.689 6.27e-14 ***
## temperature     3.60275    0.09729  37.032  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.786 on 28 degrees of freedom
## Multiple R-squared:  0.9896, Adjusted R-squared:  0.9888 
## F-statistic:  1331 on 2 and 28 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The P-value for species is now <span class="math inline">\(6.27\times 10^{-14}\)</span> or
0.00000000000006, which is even less than the P-value of 0.00001 that
came out of the <span class="math inline">\(t\)</span>-test. That is to say, when you know temperature,
you can be even more sure of your conclusion that there is a
difference between the species.</p>
<p>The R-squared for this regression is almost 99%, which says that if
you know both temperature and species, you can predict the pulse rate
almost exactly.</p>
<p>In the regression output, the slope for species is about <span class="math inline">\(-10\)</span>. It is
labelled <code>speciesniveus</code>. Since species is categorical,
<code>lm</code> uses the first category, <em>exclamationis</em>, as the
baseline and expresses each other species relative to that. Since the
slope is about <span class="math inline">\(-10\)</span>, it says that at any given temperature, the mean
pulse rate for <em>niveus</em> is about 10 less than for
<em>exclamationis</em>. This is pretty much what the scatterplot told
us.</p>
<p>We can go a little further here:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">confint</span>(pulse<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##                    2.5 %    97.5 %
## (Intercept)   -12.436265 -1.985547
## speciesniveus -11.571408 -8.559175
## temperature     3.403467  3.802038</code></pre>
<p>The second line says that the pulse rate for <em>niveus</em> is
between about 8.5 and 11.5 less than for <em>exclamationis</em>, at
any given temperature (comparing the two species at the same
temperature as each other, but that temperature could be
anything). This is a lot shorter than the CI that came out of the
<span class="math inline">\(t\)</span>-test, that went from 14 to 32. This is because we are now
accounting for temperature, which also makes a difference. (In the
<span class="math inline">\(t\)</span>-test, the temperatures were all mixed up). What we also see is
that the <span class="math inline">\(t\)</span>-interval is shifted up compared to the one from the
regression. This is because the <span class="math inline">\(t\)</span>-interval conflates<label for="tufte-sn-9" class="margin-toggle sidenote-number">9</label><input type="checkbox" id="tufte-sn-9" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">9</span> Mixes up.</span>
two things: the <em>exclamationis</em> crickets do have a
higher pulse rate, but they were also observed at higher temperatures,
which makes it look as if their pulse rates are more
higher<label for="tufte-sn-10" class="margin-toggle sidenote-number">10</label><input type="checkbox" id="tufte-sn-10" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">10</span> This is actually grammatically correct.</span> than they
really are, when you account for temperature.</p>
<p>This particular model constrains the slope with temperature to be the
same for both species (just the intercepts differ). If you want to
allow the slopes to differ between species, you add an interaction
between temperature and species:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">pulse<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(pulse_rate <span class="op">~</span><span class="st"> </span>species <span class="op">*</span><span class="st"> </span>temperature, <span class="dt">data =</span> crickets)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">summary</span>(pulse<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pulse_rate ~ species * temperature, data = crickets)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7031 -1.3417 -0.1235  0.8100  3.6330 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               -11.0408     4.1515  -2.659    0.013 *  
## speciesniveus              -4.3484     4.9617  -0.876    0.389    
## temperature                 3.7514     0.1601  23.429   &lt;2e-16 ***
## speciesniveus:temperature  -0.2340     0.2009  -1.165    0.254    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.775 on 27 degrees of freedom
## Multiple R-squared:  0.9901, Adjusted R-squared:  0.989 
## F-statistic: 898.9 on 3 and 27 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>To see whether adding the interaction term added anything to the
prediction,<label for="tufte-sn-11" class="margin-toggle sidenote-number">11</label><input type="checkbox" id="tufte-sn-11" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">11</span> Though it’s hard to imagine being able to improve on an R-squared of 99%.</span>
compare the model with and without using <code>anova</code>:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">anova</span>(pulse<span class="fl">.1</span>, pulse<span class="fl">.2</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"28","2":"89.34987","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"27","2":"85.07409","3":"1","4":"4.275779","5":"1.357006","6":"0.2542464","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>There’s no significant improvement by adding the interaction, so
there’s no evidence that having different slopes for each species is
necessary. This is the same interpretation as any <code>anova</code> for
comparing two regressions: the two models are not significantly
different in fit, so go with the simpler one, that is, the one without
the interaction.</p>
<p>Note that <code>anova</code> gave the same P-value as did the
<span class="math inline">\(t\)</span>-test for the slope coefficient for the interaction in
<code>summary</code>, 0.254 in both cases. This is because there were only
two species and therefore only one slope coefficient was required to
distinguish them. If there had been three species, we would have had
to look at the <code>anova</code> output to hunt for a difference among
species, since there would have been two slope coefficients, each with
its own P-value.<label for="tufte-sn-12" class="margin-toggle sidenote-number">12</label><input type="checkbox" id="tufte-sn-12" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">12</span> This wouldn’t have told us about the overall effect of species.</span></p>
<p>If you haven’t seen interactions before, don’t worry about this. The
idea behind it is that we are testing whether we needed lines with
different slopes and we concluded that we don’t. Don’t worry so much
about the mechanism behind <code>pulse.2</code>; just worry about how it
somehow provides a way of modelling two different slopes, one for each
species, which we can then test to see whether it helps.</p>
<p>The upshot is that we do not need different slopes; the model
<code>pulse.1</code> with the same slope for each species describes what
is going on.</p>
<p><code>ggplot</code> makes it almost laughably easy to add regression lines
for each species to our plot, thus:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">ggplot</span>(crickets, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pulse_rate, <span class="dt">colour =</span> species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="pasias_files/figure-html/unnamed-chunk-61-1.png" width="672"  /></p>
<p>The lines are almost exactly parallel, so having the same slope for
each species makes perfect sense.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Make suitable residual plots for the regression
<code>pulse.1</code>.</li>
</ol>
<p>Solution</p>
<p>First, the plot of residuals against fitted values (after all,
it <em>is</em> a regression):</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">ggplot</span>(pulse<span class="fl">.1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .resid)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-62-1.png" width="672"  /></p>
<p>This looks nice and random.</p>
<p>Now, we plot the residuals against the explanatory variables. There
are two, temperature and species, but the latter is categorical. We’ll
have some extra issues around species, but before we get to that, we
have to remember that the data and the output from the regression are
in different places when we plot them. There are different ways to get
around that. Perhaps the simplest is to use <code>pulse.1</code> as our
“default” data frame and then get <code>temperature</code> from the
right place:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">ggplot</span>(pulse<span class="fl">.1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> crickets<span class="op">$</span>temperature, <span class="dt">y =</span> .resid)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-63-1.png" width="672"  /></p>
<p>I don’t see anything untoward there.</p>
<p>Species. We want to compare the residuals for the two species, which
is categorical. Since the residuals are quantitative, this suggests a
boxplot. Remembering to get species from the right place again, that
goes like this:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">ggplot</span>(pulse<span class="fl">.1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> crickets<span class="op">$</span>species, <span class="dt">y =</span> .resid)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-64-1.png" width="672"  /></p>
<p>For the residuals, the median should be zero within each group, and
the two groups should be approximately normal with mean 0 and about
the same spread. Same spread looks OK, since the boxes are almost
exactly the same height, but the normality is not quite there, since
both distributions are a little bit skewed to the right. That would
also explain why the median residual in each group is a little bit
less than zero, because the mathematics requires the overall
<em>mean</em> residual to be zero, and the right-skewness would make the
mean higher than the median.</p>
<p>Is that non-normality really problematic? Well, I could look at the
normal quantile plot of all the residuals together:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">ggplot</span>(pulse<span class="fl">.1</span>, <span class="kw">aes</span>(<span class="dt">sample =</span> .resid)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-65-1.png" width="672"  /></p>
<p>There’s a little weirdness at the top, and a tiny indication of a
curve (that would suggest a little right-skewedness), but not really
much to worry about. If that third-highest residual were a bit
lower (say, 3 rather than 3.5) and maybe if the lowest residual was a
bit lower, I don’t think we’d have anything to complain about at all.</p>
<p>So, I’m not worried.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="pulse-rates-and-marching-1" class="section level2">
<h2><span class="header-section-number">18.4</span> Pulse rates and marching</h2>
<p>Forty students, some male and some female, measured their resting pulse rates. Then they marched in place for one minute and measured their pulse rate again.
Our aim is to use regression to predict the pulse rate after the marching from the pulse rate before, and to see whether that is different for males and females. The data is in .</p>
<ol style="list-style-type: lower-alpha">
<li>Read in and display (some of) the data.</li>
</ol>
<p>Solution</p>
<p>As usual:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/pulsemarch.csv&quot;</span></a>
<a class="sourceLine" id="cb75-2" title="2">march &lt;-<span class="st"> </span><span class="kw">read_csv</span>(my_url)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   Sex = col_character(),
##   Before = col_double(),
##   After = col_double()
## )</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">march</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Before"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["After"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Female","2":"72","3":"84"},{"1":"Male","2":"60","3":"72"},{"1":"Female","2":"68","3":"80"},{"1":"Male","2":"70","3":"72"},{"1":"Male","2":"68","3":"80"},{"1":"Male","2":"61","3":"75"},{"1":"Male","2":"80","3":"84"},{"1":"Male","2":"72","3":"76"},{"1":"Female","2":"64","3":"80"},{"1":"Female","2":"62","3":"92"},{"1":"Male","2":"60","3":"76"},{"1":"Female","2":"96","3":"100"},{"1":"Female","2":"64","3":"72"},{"1":"Female","2":"76","3":"88"},{"1":"Male","2":"55","3":"64"},{"1":"Male","2":"60","3":"68"},{"1":"Female","2":"46","3":"64"},{"1":"Female","2":"56","3":"64"},{"1":"Male","2":"88","3":"100"},{"1":"Male","2":"80","3":"88"},{"1":"Male","2":"66","3":"68"},{"1":"Female","2":"80","3":"104"},{"1":"Male","2":"68","3":"80"},{"1":"Male","2":"80","3":"88"},{"1":"Male","2":"76","3":"84"},{"1":"Female","2":"70","3":"80"},{"1":"Male","2":"59","3":"80"},{"1":"Male","2":"68","3":"76"},{"1":"Female","2":"64","3":"68"},{"1":"Male","2":"74","3":"84"},{"1":"Male","2":"84","3":"88"},{"1":"Male","2":"72","3":"80"},{"1":"Male","2":"60","3":"72"},{"1":"Male","2":"75","3":"88"},{"1":"Male","2":"76","3":"72"},{"1":"Female","2":"76","3":"96"},{"1":"Female","2":"64","3":"68"},{"1":"Female","2":"64","3":"68"},{"1":"Male","2":"60","3":"60"},{"1":"Female","2":"76","3":"104"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Make a suitable graph using all three variables, adding appropriate regression line(s) to the plot.</li>
</ol>
<p>Solution</p>
<p>Two quantitative and one categorical says scatterplot, with colour distinguishing the categories (two here). <code>geom_smooth</code> adds a regression line to the plot for each <code>Sex</code>, which is what we want. I used <code>se=F</code> to remove the grey envelopes from the plot (because I thought they confused the issue):</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">ggplot</span>(march, <span class="kw">aes</span>(<span class="dt">x=</span>Before, <span class="dt">y=</span>After, <span class="dt">colour=</span>Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span>F)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="pasias_files/figure-html/unnamed-chunk-67-1.png" width="672"  /></p>
<p>Having only one regression line is not so good because that only shows that pulse rate after goes up with pulse rate before, but not if and how the sexes differ.</p>
<p>Extra: I took a shortcut of the process here, to make the question shorter. In practice, what you’d do is to put smooth trends on the plot first:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">ggplot</span>(march, <span class="kw">aes</span>(<span class="dt">x=</span>Before, <span class="dt">y=</span>After, <span class="dt">colour=</span>Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F)</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="pasias_files/figure-html/unnamed-chunk-68-1.png" width="672"  /></p>
<p>The red trend looks curved, but if you look carefully, pretty much all of<label for="tufte-sn-13" class="margin-toggle sidenote-number">13</label><input type="checkbox" id="tufte-sn-13" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">13</span> My mind just jumped to a former German soccer player by the name of Klaus Allofs.</span> the evidence for the curve comes from that point on the right with pulse rate before over 90 and pulse rate after around 100. If it weren’t for that, the red trend would be pretty close to linear. As you’ll recall, a decision about the kind of trend based on <em>one</em> observation is a pretty flimsy decision.</p>
<p><em>Then</em>, having seen that the trends are not obviously curved, you would draw the plot with the straight lines. (Fitting separate <em>curves</em> is a whole different story that I didn’t want to get into.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Explain briefly but carefully how any effects of pulse rate before on pulse rate after, and also of sex on pulse rate after, show up on your plot. (If either explanatory variable has no effect, explain how you know.)</li>
</ol>
<p>Solution</p>
<p>There is an upward trend, so
if the pulse rate before is higher, so is the pulse rate after. This is true for both males and females. (Or, holding <code>Sex</code> fixed, that is, comparing two people of the same sex.)</p>
<p>The red line is always above the blue line, so at any given <code>Before</code> pulse rate, the <code>After</code> pulse rate for a female is predicted to be higher than that for a male.</p>
<p>Note that you have to be careful: when talking about the effect of each explanatory variable, you have to <em>hold the other one constant</em> (in general, hold all the other ones constant). If you can word that in a way that makes sense in the context of the data you are looking at, so much the better.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Run a regression predicting pulse rate after from the other two variables. Display the output.</li>
</ol>
<p>Solution</p>
<p>Thus:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">march<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(After<span class="op">~</span>Before<span class="op">+</span>Sex, <span class="dt">data=</span>march)</a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">summary</span>(march<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = After ~ Before + Sex, data = march)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.8653  -4.6319  -0.4271   3.3856  16.0047 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  19.8003     7.9217   2.499   0.0170 *  
## Before        0.9064     0.1127   8.046  1.2e-09 ***
## SexMale      -4.8191     2.2358  -2.155   0.0377 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.918 on 37 degrees of freedom
## Multiple R-squared:  0.6468, Adjusted R-squared:  0.6277 
## F-statistic: 33.87 on 2 and 37 DF,  p-value: 4.355e-09</code></pre>
<p>Extra: if you want “all the other variables except the response” as explanatory, there is also this shortcut:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">march<span class="fl">.1</span>a &lt;-<span class="st"> </span><span class="kw">lm</span>(After<span class="op">~</span>., <span class="dt">data=</span>march)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">summary</span>(march<span class="fl">.1</span>a)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = After ~ ., data = march)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.8653  -4.6319  -0.4271   3.3856  16.0047 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  19.8003     7.9217   2.499   0.0170 *  
## SexMale      -4.8191     2.2358  -2.155   0.0377 *  
## Before        0.9064     0.1127   8.046  1.2e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.918 on 37 degrees of freedom
## Multiple R-squared:  0.6468, Adjusted R-squared:  0.6277 
## F-statistic: 33.87 on 2 and 37 DF,  p-value: 4.355e-09</code></pre>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Looking at your graph, does the significance (or lack of) of each of your two explanatory variables surprise you? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>We noted a clear upward trend before, for both sexes, so there is no surprise that the <code>Before</code> pulse rate is significant.</p>
<p>The red dots (females) on the graph seemed to be on average above the blue ones (males), at least for similar before pulse rates. (This is not completely convincing, so you are entitled to be surprised also; note that the P-value, while significant, is not <em>that</em> small).</p>
<p>Extra: comparing the <em>lines</em> is less convincing, because how do we get a feel for whether these lines are more different than chance? One deceiving way to (fail to) get a feel for this is to re-draw our plot but with the grey envelopes:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">ggplot</span>(march, <span class="kw">aes</span>(<span class="dt">x=</span>Before, <span class="dt">y=</span>After, <span class="dt">colour=</span>Sex)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="pasias_files/figure-html/unnamed-chunk-71-1.png" width="672"  /></p>
<p>The grey envelopes overlap substantially, which would make you think the lines are <em>not</em> significantly different. But, this is not the right way to compare the lines. It is a similar problem to that of comparing two <em>means</em> (that we would normally do with a two-sample test of some kind) by working out the two <em>one</em>-sample confidence intervals, and seeing whether they overlap. If they <em>do not</em>, then you can be sure that the means differ, but if they do overlap, then you cannot say anything about whether the means differ: maybe they do, maybe they don’t. This one is analogous; the grey envelopes overlap, so maybe the lines differ, maybe they don’t. Looking at the grey envelopes in this case gives you <em>no</em> insight about whether males and females differ.</p>
<p><a href="https://www.cscu.cornell.edu/news/statnews/stnews73.pdf">Here</a> is a short discussion of this issue (in the context of comparing two means).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>What does the numerical value of the Estimate for <code>Sex</code> in your regression output mean, in the context of this data set? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The estimate is labelled <code>SexMale</code>, and its value is <span class="math inline">\(-4.8\)</span>.</p>
<p><code>Sex</code> is a categorical variable, so it has a baseline category, which is the first one, <code>Female</code>. The Estimate <code>SexMale</code> shows how males compare to the baseline (females), at a fixed <code>Before</code> pulse rate.
This value is <span class="math inline">\(-4.8\)</span>, so, at any <code>Before</code> pulse rate, the male <code>After</code> pulse rate is predicted to be 4.8 <em>less</em> than the female one.</p>
<p>I think you have to mention the value <span class="math inline">\(-4.8\)</span>, so that you can talk intelligently about what it means for these data.</p>
<p>Extra: the implication of our model is that the predicted difference is the <em>same</em> all the way along. You might have your doubts about that; you might think the lines are closer together on the left and further apart on the right. Another way to think about this is whether the lines are <em>parallel</em>: that is, whether they have the same slope. I’m inclined to think they do; the data points are fairly scattered, and I think the slopes would have to be a lot more different to be significantly different. But you don’t have to take my word for it: we can test this by adding an <strong>interaction term</strong> to the model. You might have seen this in ANOVA, where you are assessing the effect of one factor at different levels of the other. This is more or less the same idea. Note the <code>*</code> rather than the <code>+</code> in the model formula:<label for="tufte-sn-14" class="margin-toggle sidenote-number">14</label><input type="checkbox" id="tufte-sn-14" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">14</span> To be precise, the * means “the main effects and the interaction together”; if you want to talk about just the interaction term, you denote it by <code>:</code>; note the <code>Before:SexMale</code> term in the summary table.</span></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">march<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(After<span class="op">~</span>Before<span class="op">*</span>Sex, <span class="dt">data=</span>march)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">summary</span>(march<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = After ~ Before * Sex, data = march)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.2831  -4.3638  -0.3965   3.4077  16.6188 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     13.4390    11.1416   1.206    0.236    
## Before           0.9991     0.1604   6.230 3.43e-07 ***
## SexMale          7.9470    15.8095   0.503    0.618    
## Before:SexMale  -0.1846     0.2263  -0.816    0.420    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.949 on 36 degrees of freedom
## Multiple R-squared:  0.6532, Adjusted R-squared:  0.6243 
## F-statistic:  22.6 on 3 and 36 DF,  p-value: 2.11e-08</code></pre>
<p>The <code>Before:SexMale</code> term tests the interaction, and you see it is nowhere near significant. There is no justification for having lines with different slopes for males and females.</p>
<p>We were lucky here in that <code>Sex</code> has only two levels, so looking at the <code>summary</code> gave us what we wanted. If we had had an <code>Other</code> category for <code>Sex</code>, for people who don’t identify with either male or female, there would be two Estimates in the <code>summary</code> table, one comparing Male with Female, and one comparing Other with Female.<label for="tufte-sn-15" class="margin-toggle sidenote-number">15</label><input type="checkbox" id="tufte-sn-15" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">15</span> Female is the baseline, so everything gets compared with that, whether you like it or not.</span>
But maybe the significant difference is Male vs. Other, and we would never see it.</p>
<p>To look for <em>any</em> effect of a categorical variable, the right way is to use <code>drop1</code>, to see which variables, including categorical ones, can be removed as a whole, thus:<label for="tufte-sn-16" class="margin-toggle sidenote-number">16</label><input type="checkbox" id="tufte-sn-16" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">16</span> The <code>test</code> piece says to do an <span class="math inline">\(F\)</span>-test, which is different from without the quotes, which would mean not to do any tests, <code>F</code> without quotes meaning <code>FALSE</code>.</span></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">drop1</span>(march<span class="fl">.2</span>, <span class="dt">test=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"1738.512","4":"158.8762","5":"NA","6":"NA","_rn_":"<none>"},{"1":"1","2":"32.13734","3":"1770.649","4":"157.6089","5":"0.6654795","6":"0.4199971","_rn_":"Before:Sex"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>This <em>only</em> lists things that can be removed, in this case the interaction. It is not significant, so out it comes (resulting in our model <code>march.1</code>):</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">drop1</span>(march<span class="fl">.1</span>, <span class="dt">test=</span><span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"1770.649","4":"157.6089","5":"NA","6":"NA","_rn_":"<none>"},{"1":"1","2":"3097.976","3":"4868.625","4":"196.0675","5":"64.736188","6":"1.203225e-09","_rn_":"Before"},{"1":"1","2":"222.337","3":"1992.986","4":"160.3404","5":"4.646017","6":"3.770029e-02","_rn_":"Sex"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Both remaining explanatory variables are significant, so we need to keep them both.</p>
<p>Our categorical explanatory variable has only two levels, so <code>drop1</code> and <code>summary</code> give the exact same P-values.</p>
<p>Extra 2:</p>
<p>Let’s go back and look at our data set again:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">march</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Before"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["After"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Female","2":"72","3":"84"},{"1":"Male","2":"60","3":"72"},{"1":"Female","2":"68","3":"80"},{"1":"Male","2":"70","3":"72"},{"1":"Male","2":"68","3":"80"},{"1":"Male","2":"61","3":"75"},{"1":"Male","2":"80","3":"84"},{"1":"Male","2":"72","3":"76"},{"1":"Female","2":"64","3":"80"},{"1":"Female","2":"62","3":"92"},{"1":"Male","2":"60","3":"76"},{"1":"Female","2":"96","3":"100"},{"1":"Female","2":"64","3":"72"},{"1":"Female","2":"76","3":"88"},{"1":"Male","2":"55","3":"64"},{"1":"Male","2":"60","3":"68"},{"1":"Female","2":"46","3":"64"},{"1":"Female","2":"56","3":"64"},{"1":"Male","2":"88","3":"100"},{"1":"Male","2":"80","3":"88"},{"1":"Male","2":"66","3":"68"},{"1":"Female","2":"80","3":"104"},{"1":"Male","2":"68","3":"80"},{"1":"Male","2":"80","3":"88"},{"1":"Male","2":"76","3":"84"},{"1":"Female","2":"70","3":"80"},{"1":"Male","2":"59","3":"80"},{"1":"Male","2":"68","3":"76"},{"1":"Female","2":"64","3":"68"},{"1":"Male","2":"74","3":"84"},{"1":"Male","2":"84","3":"88"},{"1":"Male","2":"72","3":"80"},{"1":"Male","2":"60","3":"72"},{"1":"Male","2":"75","3":"88"},{"1":"Male","2":"76","3":"72"},{"1":"Female","2":"76","3":"96"},{"1":"Female","2":"64","3":"68"},{"1":"Female","2":"64","3":"68"},{"1":"Male","2":"60","3":"60"},{"1":"Female","2":"76","3":"104"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>You might have been thinking, when we started, that these are before and after measurements <em>on the same people</em>, and so what we have here is matched pairs. So we do, but it’s not the kind of matched pairs we are accustomed to. Let’s begin by taking differences, getting rid of the <code>Before</code> and <code>After</code> columns, and see what we have left:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">march <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">mutate</span>(<span class="dt">difference=</span>After<span class="op">-</span>Before) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="kw">select</span>(<span class="op">-</span>After, <span class="op">-</span>Before) -&gt;<span class="st"> </span>march_paired</a>
<a class="sourceLine" id="cb93-4" title="4">march_paired</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["difference"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Female","2":"12"},{"1":"Male","2":"12"},{"1":"Female","2":"12"},{"1":"Male","2":"2"},{"1":"Male","2":"12"},{"1":"Male","2":"14"},{"1":"Male","2":"4"},{"1":"Male","2":"4"},{"1":"Female","2":"16"},{"1":"Female","2":"30"},{"1":"Male","2":"16"},{"1":"Female","2":"4"},{"1":"Female","2":"8"},{"1":"Female","2":"12"},{"1":"Male","2":"9"},{"1":"Male","2":"8"},{"1":"Female","2":"18"},{"1":"Female","2":"8"},{"1":"Male","2":"12"},{"1":"Male","2":"8"},{"1":"Male","2":"2"},{"1":"Female","2":"24"},{"1":"Male","2":"12"},{"1":"Male","2":"8"},{"1":"Male","2":"8"},{"1":"Female","2":"10"},{"1":"Male","2":"21"},{"1":"Male","2":"8"},{"1":"Female","2":"4"},{"1":"Male","2":"10"},{"1":"Male","2":"4"},{"1":"Male","2":"8"},{"1":"Male","2":"12"},{"1":"Male","2":"13"},{"1":"Male","2":"-4"},{"1":"Female","2":"20"},{"1":"Female","2":"4"},{"1":"Female","2":"4"},{"1":"Male","2":"0"},{"1":"Female","2":"28"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In matched pairs, we are used to having <em>one</em> column of differences, and we test that for a mean or median of zero, to express no difference between before and after (or whatever it was). But now, we have an extra column <code>Sex</code>. We are not interested here in whether the differences average out to zero;<label for="tufte-sn-17" class="margin-toggle sidenote-number">17</label><input type="checkbox" id="tufte-sn-17" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">17</span> I think it’s a given that pulse rates will be higher after exercise than before.</span> we care more about whether the differences differ (!) between males and females. That is to say, we have a two-sample matched pairs test!</p>
<p>At this point, your head ought to be hurting!</p>
<p>However, at this point what we are saying is that <em>if</em> you believe that the difference is a good way to summarize the effect of the exercise, then we have one measurement for each person, independent because different people’s measurements will be independent. It doesn’t matter where they came from. We have measurements on two groups, so some kind of two-sample test will be good. Which kind? Let’s look at a graph, a good one now being a boxplot:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">ggplot</span>(march_paired, <span class="kw">aes</span>(<span class="dt">x=</span>Sex, <span class="dt">y=</span>difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-77-1.png" width="672"  /></p>
<p>Or, if you like, a facetted normal quantile plot:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">ggplot</span>(march_paired, <span class="kw">aes</span>(<span class="dt">sample=</span>difference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb95-3" title="3"><span class="kw">facet_wrap</span>(<span class="op">~</span>Sex)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-78-1.png" width="672"  /></p>
<p>It seems to me that these are normal enough for a <span class="math inline">\(t\)</span>-test, given the sample sizes (feel free to disagree):</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">march_paired <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(Sex)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Female","2":"16"},{"1":"Male","2":"24"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The spreads look a bit different, so I think I would prefer the Welch test here:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">t.test</span>(difference<span class="op">~</span>Sex, <span class="dt">data=</span>march_paired)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  difference by Sex
## t = 2.0307, df = 23.296, p-value = 0.05386
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.08848652  9.92181986
## sample estimates:
## mean in group Female   mean in group Male 
##            13.375000             8.458333</code></pre>
<p>This time, there is not quite a significant difference between males and females. (The P-value is just the other side of 0.05.) Though the conclusion is different, the P-values are fairly similar.</p>
<p>Which test is better? I think treating it as matched pairs is assuming that the differences after minus before are the things to be looking at. This assumes that the after measurements are the before measurement plus a something that depends on treatment, but <em>not</em> on the before measurement. This would fail, for example, if all the after measurements are two times the before ones (so that the difference would be bigger if the before score was bigger).
The regression approach is more flexible, because <em>any</em> linear relationship is taken care of. A matched-pairs model of this kind is a special case of the regression model but with the slope set to be 1. In our regression, the slope is less than 1, but not by much.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>

</div>
</div>
<p style="text-align: center;">
<a href="multiple-regression.html"><button class="btn btn-default">Previous</button></a>
<a href="dates-and-times.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>

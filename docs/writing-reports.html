<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Writing reports | Problems and Solutions in Applied Statistics</title>
  <meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Writing reports | Problems and Solutions in Applied Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://ritsokiguess.site/pasias" />
  
  <meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="github-repo" content="nxskok/pasias" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Writing reports | Problems and Solutions in Applied Statistics" />
  
  <meta name="twitter:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  

<meta name="author" content="Ken Butler" />


<meta name="date" content="2021-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysis-of-variance.html"/>
<link rel="next" href="learning-to-code-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Problems and Solutions in Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages-used-somewhere-in-this-book"><i class="fa fa-check"></i>Packages used somewhere in this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>1</b> Getting used to R and R Studio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#running-r-studio-on-jupyterhub"><i class="fa fa-check"></i><b>1.1</b> Running R Studio on Jupyterhub</a></li>
<li class="chapter" data-level="1.2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><i class="fa fa-check"></i><b>1.2</b> Getting an R Studio Cloud account</a></li>
<li class="chapter" data-level="1.3" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a></li>
<li class="chapter" data-level="1.4" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><i class="fa fa-check"></i><b>1.4</b> Reading data from a file</a></li>
<li class="chapter" data-level="1.5" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-files-different-ways"><i class="fa fa-check"></i><b>1.5</b> Reading files different ways</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-in-data.html"><a href="reading-in-data.html"><i class="fa fa-check"></i><b>2</b> Reading in data</a></li>
<li class="chapter" data-level="3" data-path="drawing-graphs.html"><a href="drawing-graphs.html"><i class="fa fa-check"></i><b>3</b> Drawing graphs</a></li>
<li class="chapter" data-level="4" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>4</b> Data exploration</a></li>
<li class="chapter" data-level="5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>5</b> Working with dataframes</a></li>
<li class="chapter" data-level="6" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>6</b> One-sample inference</a></li>
<li class="chapter" data-level="7" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>7</b> Two-sample inference</a></li>
<li class="chapter" data-level="8" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>8</b> Power and sample size</a></li>
<li class="chapter" data-level="9" data-path="the-sign-test.html"><a href="the-sign-test.html"><i class="fa fa-check"></i><b>9</b> The sign test</a></li>
<li class="chapter" data-level="10" data-path="mood-median-test.html"><a href="mood-median-test.html"><i class="fa fa-check"></i><b>10</b> Mood median test</a></li>
<li class="chapter" data-level="11" data-path="matched-pairs-t-and-sign-test.html"><a href="matched-pairs-t-and-sign-test.html"><i class="fa fa-check"></i><b>11</b> Matched pairs t and sign test</a></li>
<li class="chapter" data-level="12" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html"><i class="fa fa-check"></i><b>12</b> Normal quantile plots</a><ul>
<li class="chapter" data-level="12.1" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><i class="fa fa-check"></i><b>12.1</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.2" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality"><i class="fa fa-check"></i><b>12.2</b> Ferritin and normality</a></li>
<li class="chapter" data-level="12.3" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers-1"><i class="fa fa-check"></i><b>12.3</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.4" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality-1"><i class="fa fa-check"></i><b>12.4</b> Ferritin and normality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>13</b> Analysis of variance</a></li>
<li class="chapter" data-level="14" data-path="writing-reports.html"><a href="writing-reports.html"><i class="fa fa-check"></i><b>14</b> Writing reports</a><ul>
<li class="chapter" data-level="14.1" data-path="writing-reports.html"><a href="writing-reports.html#atomic-weight-of-carbon"><i class="fa fa-check"></i><b>14.1</b> Atomic weight of carbon</a></li>
<li class="chapter" data-level="14.2" data-path="writing-reports.html"><a href="writing-reports.html#sparrowhawks"><i class="fa fa-check"></i><b>14.2</b> Sparrowhawks</a></li>
<li class="chapter" data-level="14.3" data-path="writing-reports.html"><a href="writing-reports.html#learning-to-code"><i class="fa fa-check"></i><b>14.3</b> Learning to code</a></li>
<li class="chapter" data-level="14.4" data-path="writing-reports.html"><a href="writing-reports.html#treating-dandruff"><i class="fa fa-check"></i><b>14.4</b> Treating dandruff</a></li>
<li class="chapter" data-level="14.5" data-path="writing-reports.html"><a href="writing-reports.html#atomic-weight-of-carbon-1"><i class="fa fa-check"></i><b>14.5</b> Atomic weight of carbon</a></li>
<li class="chapter" data-level="14.6" data-path="writing-reports.html"><a href="writing-reports.html#sparrowhawks-1"><i class="fa fa-check"></i><b>14.6</b> Sparrowhawks</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="learning-to-code-1.html"><a href="learning-to-code-1.html"><i class="fa fa-check"></i><b>15</b> Learning to code</a><ul>
<li class="chapter" data-level="15.1" data-path="learning-to-code-1.html"><a href="learning-to-code-1.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="learning-to-code-1.html"><a href="learning-to-code-1.html#data-and-pre-processing"><i class="fa fa-check"></i><b>15.2</b> Data and pre-processing</a></li>
<li class="chapter" data-level="15.3" data-path="learning-to-code-1.html"><a href="learning-to-code-1.html#analysis"><i class="fa fa-check"></i><b>15.3</b> Analysis</a></li>
<li class="chapter" data-level="15.4" data-path="learning-to-code-1.html"><a href="learning-to-code-1.html#conclusions-see-note-9"><i class="fa fa-check"></i><b>15.4</b> Conclusions (see note 9)</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="treating-dandruff-1.html"><a href="treating-dandruff-1.html"><i class="fa fa-check"></i><b>16</b> Treating dandruff</a><ul>
<li class="chapter" data-level="16.1" data-path="treating-dandruff-1.html"><a href="treating-dandruff-1.html#introduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="treating-dandruff-1.html"><a href="treating-dandruff-1.html#exploratory-analysis"><i class="fa fa-check"></i><b>16.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="16.3" data-path="treating-dandruff-1.html"><a href="treating-dandruff-1.html#analysis-of-variance-1"><i class="fa fa-check"></i><b>16.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="16.4" data-path="treating-dandruff-1.html"><a href="treating-dandruff-1.html#assessment-of-assumptions"><i class="fa fa-check"></i><b>16.4</b> Assessment of Assumptions</a></li>
<li class="chapter" data-level="16.5" data-path="treating-dandruff-1.html"><a href="treating-dandruff-1.html#conclusions"><i class="fa fa-check"></i><b>16.5</b> Conclusions</a></li>
<li class="chapter" data-level="16.6" data-path="treating-dandruff-1.html"><a href="treating-dandruff-1.html#end"><i class="fa fa-check"></i><b>16.6</b> End</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>17</b> Tidying data</a></li>
<li class="chapter" data-level="18" data-path="simple-regression.html"><a href="simple-regression.html"><i class="fa fa-check"></i><b>18</b> Simple regression</a></li>
<li class="chapter" data-level="19" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>19</b> Multiple regression</a></li>
<li class="chapter" data-level="20" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html"><i class="fa fa-check"></i><b>20</b> Regression with categorical variables</a><ul>
<li class="chapter" data-level="20.1" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited"><i class="fa fa-check"></i><b>20.1</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.2" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching"><i class="fa fa-check"></i><b>20.2</b> Pulse rates and marching</a></li>
<li class="chapter" data-level="20.3" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited-1"><i class="fa fa-check"></i><b>20.3</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.4" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching-1"><i class="fa fa-check"></i><b>20.4</b> Pulse rates and marching</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>21</b> Dates and times</a></li>
<li class="chapter" data-level="22" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>22</b> Functions</a></li>
<li class="chapter" data-level="23" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html"><i class="fa fa-check"></i><b>23</b> Vector and matrix algebra</a><ul>
<li class="chapter" data-level="23.1" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again"><i class="fa fa-check"></i><b>23.1</b> Heights and foot lengths again</a></li>
<li class="chapter" data-level="23.2" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again-1"><i class="fa fa-check"></i><b>23.2</b> Heights and foot lengths again</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>24</b> The Bootstrap</a></li>
<li class="chapter" data-level="25" data-path="bayesian-statistics-with-stan.html"><a href="bayesian-statistics-with-stan.html"><i class="fa fa-check"></i><b>25</b> Bayesian Statistics with Stan</a></li>
<li class="chapter" data-level="26" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>26</b> Logistic regression</a></li>
<li class="chapter" data-level="27" data-path="logistic-regression-with-ordinal-response.html"><a href="logistic-regression-with-ordinal-response.html"><i class="fa fa-check"></i><b>27</b> Logistic regression with ordinal response</a></li>
<li class="chapter" data-level="28" data-path="logistic-regression-with-nominal-response.html"><a href="logistic-regression-with-nominal-response.html"><i class="fa fa-check"></i><b>28</b> Logistic regression with nominal response</a></li>
<li class="chapter" data-level="29" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>29</b> Survival analysis</a></li>
<li class="chapter" data-level="30" data-path="analysis-of-variance-revisited.html"><a href="analysis-of-variance-revisited.html"><i class="fa fa-check"></i><b>30</b> Analysis of variance revisited</a></li>
<li class="chapter" data-level="31" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>31</b> Analysis of covariance</a></li>
<li class="chapter" data-level="32" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>32</b> Multivariate analysis of variance</a></li>
<li class="chapter" data-level="33" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i><b>33</b> Repeated measures</a></li>
<li class="chapter" data-level="34" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>34</b> Discriminant analysis</a></li>
<li class="chapter" data-level="35" data-path="hierarchical-cluster-analysis.html"><a href="hierarchical-cluster-analysis.html"><i class="fa fa-check"></i><b>35</b> Hierarchical cluster analysis</a></li>
<li class="chapter" data-level="36" data-path="k-means-cluster-analysis.html"><a href="k-means-cluster-analysis.html"><i class="fa fa-check"></i><b>36</b> K-means cluster analysis</a></li>
<li class="chapter" data-level="37" data-path="drawing-maps-with-leaflet.html"><a href="drawing-maps-with-leaflet.html"><i class="fa fa-check"></i><b>37</b> Drawing maps with Leaflet</a></li>
<li class="chapter" data-level="38" data-path="multidimensional-scaling.html"><a href="multidimensional-scaling.html"><i class="fa fa-check"></i><b>38</b> Multidimensional Scaling</a></li>
<li class="chapter" data-level="39" data-path="principal-components.html"><a href="principal-components.html"><i class="fa fa-check"></i><b>39</b> Principal Components</a><ul>
<li class="chapter" data-level="39.1" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere"><i class="fa fa-check"></i><b>39.1</b> The weather, somewhere</a></li>
<li class="chapter" data-level="39.2" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere-1"><i class="fa fa-check"></i><b>39.2</b> The weather, somewhere</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>40</b> Factor Analysis</a></li>
<li class="chapter" data-level="41" data-path="frequency-table-analysis.html"><a href="frequency-table-analysis.html"><i class="fa fa-check"></i><b>41</b> Frequency table analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Problems and Solutions in Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="writing-reports" class="section level1">
<h1><span class="header-section-number">Chapter 14</span> Writing reports</h1>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="atomic-weight-of-carbon" class="section level2">
<h2><span class="header-section-number">14.1</span> Atomic weight of carbon</h2>
<p>The atomic weight of the chemical element
carbon is 12. Two methods of measuring the atomic weight of samples of
carbon were compared. The results are shown in
<a href="http://ritsokiguess.site/datafiles/carbon.txt">link</a>. The methods
are labelled 1 and 2. The first task is to find out whether the two
methods have different “typical” measures (mean or median, as
appropriate) of the atomic weight of carbon.</p>
<p>For this question, compose a report in R Markdown. (R Markdown is
what you use in an R Notebook, but you can also have a separate R
Markdown document from which you can produce HTML, Word etc. output.)
See part (a) for how to get this started.</p>
<p>Your report should
read like an actual report, not just the answers to some questions
that I set you. To help with that, write some text that links the
parts of the report together smoothly, so that it reads as a coherent
whole. The grader had 3 discretionary marks to award for the overall
quality of your writing. The scale for this was:</p>
<ul>
<li><p>3 points: excellent writing. The report flows smoothly, is easy
to read, and contains everything it should (and nothing it
shouldn’t).</p></li>
<li><p>2 points: satisfactory writing. Not the easiest to read, but
says what it should, and it looks at least somewhat like a report
rather than a string of answers to questions.</p></li>
<li><p>1 point: writing that is hard to read or to understand. If you
get this (or 0), you should consider what you need to do to improve
when you write your project.</p></li>
<li><p>0 points: you answered the questions, but you did almost nothing
to make it read like a report.</p></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li><p>Create a new R Markdown document. To do this, in R Studio, select File,
New File, R Markdown. Type the report title and your name in the
boxes, and leave the output on the default HTML. Click OK.</p></li>
<li><p>Write an introduction that explains the purpose of this
study and the data collected in your own words.</p></li>
<li><p>Begin an appropriately-titled new section in your report,
read the data into R and display the results.</p></li>
<li><p>Make an appropriate plot to compare the measurements
obtained by the two methods. You might need to do something about
the two methods being given as numbers even though they are really
only identifiers. (If you do, your report ought to say what you did
and why.)</p></li>
<li><p>Comment briefly on what you see in your plot.</p></li>
<li><p>Carry out the most appropriate <span class="math inline">\(t\)</span>-test. (You might like to
begin another new section in your report here.)</p></li>
<li><p>Do the most appropriate test you know that does not assume
normally-distributed data.</p></li>
<li><p>Discuss the results of your tests and what they say about
the two methods for measuring the atomic weight of carbon. If it
seems appropriate, put the discussion into a section called
Conclusions.</p></li>
</ol>
</div>
<div id="sparrowhawks" class="section level2">
<h2><span class="header-section-number">14.2</span> Sparrowhawks</h2>
<p>(This is a report-writing question, but it also uses some regression techniques from later in the course.)</p>
<p>One of nature’s patterns is the relationship
between the percentage of adult birds in a colony that return from the
previous year, and the number of new adults that join the colony. Data
for 13 colonies of sparrowhawks can be found at
<a href="http://ritsokiguess.site/datafiles/sparrowhawk.txt">link</a>. The
columns are the percentage of adults returning from the previous year,
and the number of new adults that join the colony.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Create a new R Markdown report, give it a suitable title, and
ask for HTML output. Answer the questions that follow in your
report. At any stage, you can Knit HTML
to see how the report looks so far.</p></li>
<li><p>Read in the data and display the first few values. Add some text saying how many rows of data
there are.</p></li>
<li><p>Create a new section entitled “Exploratory analysis”, and
create a scatterplot for predicting number of new adults from the
percentage of returning adults. Describe what you see, adding some
suitable text to your report.</p></li>
<li><p>Obtain the correlation between the two variables. Is this
consistent with the scatterplot? Explain briefly. (The R function
you need is <code>cor</code>. You can feed it a data frame.)</p></li>
<li><p>Obtain the regression line for predicting the number of new
adults from the percentage of returning adults.</p></li>
<li><p>What are the intercept and slope of your regression line? Is
the slope significant? What does that mean, in the context of the data?</p></li>
<li><p>Create a scatterplot of the data with the regression line on it.</p></li>
<li><p>For short-lived birds, the association between these two
variables is positive: changes in weather and food supply cause the
populations of new and returning birds to increase together. For
long-lived territorial birds, however, the association is negative
because returning birds claim their territories in the colony and do
not leave room for new recruits. Which type of species is the
sparrowhawk? Add a short Conclusions section to your report with
discussion of this issue.</p></li>
</ol>
</div>
<div id="learning-to-code" class="section level2">
<h2><span class="header-section-number">14.3</span> Learning to code</h2>
<p>A programming course, Comp Sci 101, can be taken either in-person, by attending a class at fixed days and times, or online, by doing sessions that can be taken at times the student chooses. The course coordinator wants to know whether students taking the course in these two different ways learn a different amount, as measured by their scores on the final exam for the course. This example comes from the before-times, so the final exam was taken in person by all students. The final exam was out of 45 marks. A total of 18 students took part in the study. Each student was allowed to choose the section they preferred. The data are in <a href="http://ritsokiguess.site/datafiles/proggo.csv">http://ritsokiguess.site/datafiles/proggo.csv</a>.</p>
<p>Write a report of a complete and appropriate analysis of these data. Your report should include a description of the data in your own words, any necessary pre-processing steps, appropriate graphs, statistical analysis, assessment of assumptions for your preferred analysis, and a statement of conclusions. Imagine that your report will be read by the department Chair, who does not know about this study, and who still remembers some of their first-year Statistics course.</p>
<p>(My example report is in a later chapter, the one called Learning to Code.)</p>
</div>
<div id="treating-dandruff" class="section level2">
<h2><span class="header-section-number">14.4</span> Treating dandruff</h2>
<p>According to the <a href="https://www.mayoclinic.org/diseases-conditions/dandruff/symptoms-causes/syc-20353850">Mayo Clinic</a>, dandruff is “a common condition that causes the skin on the scalp to flake. It isn’t contagious or serious. But it can be embarrassing and difficult to treat.” Shampoos often claim to be effective in treating dandruff. In a study, four shampoos were compared:</p>
<ul>
<li><code>PyrI</code>: 1% pyrithione zinc shampoo</li>
<li><code>PyrII</code>: the same as <code>PyrI</code> but with instructions to shampoo two times at each wash. The labels for these are <code>Pyr</code> with a Roman numeral I or II attached.</li>
<li><code>Keto</code>: 2% ketoconazole shampoo</li>
<li><code>Placebo</code>: a placebo shampoo</li>
</ul>
<p>Each subject was randomly assigned to a shampoo. After six weeks of treatment, eight sections of the scalp were examined for each subject. Each section of the scalp was given a score that measured the amount of flaking on a scale of 0-10, less flaking being better. The response variable, called <code>Flaking</code>, was the sum of these eight scores, and is a whole number for each subject.</p>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/dandruff.txt">http://ritsokiguess.site/datafiles/dandruff.txt</a>,
with the data values separated by <em>tabs</em>.</p>
<p>Your task is to write a report on your analysis of this data set, and to make a recommendation for the best shampoo(s) out of the four studied here. The target audience for your report is the principal investigator of the study described above, who knows a lot about shampoo, but not so much about statistics. (They took a course some time ago that covered the material you’ve seen in this course so far, at about the level of STAB22 or STA 220.)
Some things you might want to consider, in no particular order (you need to think about where and if to include these things):</p>
<ul>
<li>an Introduction, written in your own words as much as possible</li>
<li>a Conclusion that summarizes what you found</li>
<li>a suitable and complete piece of statistical inference</li>
<li>a numerical summary of the data</li>
<li>graph(s) of the data</li>
<li>an assessment of the assumptions of your analysis</li>
<li>citation of external sources</li>
<li>anything else that you can make the case for including</li>
</ul>
<p>In R Markdown (the text of an R Notebook), you can use <code>##</code> to make a heading (you can experiment with more or fewer <code>#</code> symbols).</p>
<p>Your aim is to produce a report, suitable for the intended audience, with all the important elements and no irrelevant ones, that is well-written and easy to follow. There is credit for good writing. For this report, you should include your code in with your report. (In a real report, you would probably show the output and not the code, but we are interested in your code here as well.)</p>
<p>(My example report is in a later chapter.)</p>
<p>My solutions follow. The example reports on coding and treating dandruff are separate chapters.</p>
</div>
<div id="atomic-weight-of-carbon-1" class="section level2">
<h2><span class="header-section-number">14.5</span> Atomic weight of carbon</h2>
<p>The atomic weight of the chemical element
carbon is 12. Two methods of measuring the atomic weight of samples of
carbon were compared. The results are shown in
<a href="http://ritsokiguess.site/datafiles/carbon.txt">link</a>. The methods
are labelled 1 and 2. The first task is to find out whether the two
methods have different “typical” measures (mean or median, as
appropriate) of the atomic weight of carbon.</p>
<p>For this question, compose a report in R Markdown. (R Markdown is
what you use in an R Notebook, but you can also have a separate R
Markdown document from which you can produce HTML, Word etc. output.)
See part (a) for how to get this started.</p>
<p>Your report should
read like an actual report, not just the answers to some questions
that I set you. To help with that, write some text that links the
parts of the report together smoothly, so that it reads as a coherent
whole. The grader had 3 discretionary marks to award for the overall
quality of your writing. The scale for this was:</p>
<ul>
<li><p>3 points: excellent writing. The report flows smoothly, is easy
to read, and contains everything it should (and nothing it
shouldn’t).</p></li>
<li><p>2 points: satisfactory writing. Not the easiest to read, but
says what it should, and it looks at least somewhat like a report
rather than a string of answers to questions.</p></li>
<li><p>1 point: writing that is hard to read or to understand. If you
get this (or 0), you should consider what you need to do to improve
when you write your project.</p></li>
<li><p>0 points: you answered the questions, but you did almost nothing
to make it read like a report.</p></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>Create a new R Markdown document. To do this, in R Studio, select File,
New File, R Markdown. Type the report title and your name in the
boxes, and leave the output on the default HTML. Click OK.</li>
</ol>
<p>Solution</p>
<p>You’ll
see the title and your name in a section at the top of the document,
and below that you’ll see a template document, as you would for an R
Notebook. The difference is that where you are used to seeing
Preview, it now says “knit”, but this has the same effect of
producing the formatted version of your report.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Write an introduction that explains the purpose of this
study and the data collected in your own words.</li>
</ol>
<p>Solution</p>
<p>Something like this:</p>
<blockquote>
<p>This study is intended to compare two different methods
(labelled 1 and 2) for measuring the atomic weight of carbon
(which is known in actual fact to be 12). Fifteen samples of
carbon were used; ten of these were assessed using method 1 and
the remaining five using method 2. The primary interest in this
particular study is to see whether there is a difference in the
mean or median atomic weight as measured by the two methods.</p>
</blockquote>
<p>Before that, start a new section like this:
<code>## Introduction</code>.
Also, get used to expressing your understanding in your words,
not mine. (Using my words, in my courses, is likely to be
worth very little.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Begin an appropriately-titled new section in your report,
read the data into R and display the results.</li>
</ol>
<p>Solution</p>
<p>Values separated by spaces:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/carbon.txt&quot;</span></a>
<a class="sourceLine" id="cb67-2" title="2">carbon &lt;-<span class="st"> </span><span class="kw">read_delim</span>(my_url, <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   method = col_double(),
##   weight = col_double()
## )</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">carbon</a></code></pre></div>
<pre><code>## # A tibble: 15 x 2
##    method weight
##     &lt;dbl&gt;  &lt;dbl&gt;
##  1      1   12.0
##  2      1   12.0
##  3      1   12.0
##  4      1   12.0
##  5      1   12.0
##  6      1   12.0
##  7      1   12.0
##  8      1   12.0
##  9      1   12.0
## 10      1   12.0
## 11      2   12.0
## 12      2   12.0
## 13      2   12.0
## 14      2   12.0
## 15      2   12.0</code></pre>
<p>I would expect you to include, without being told to include it, some
text in your report indicating that you have sensible data: two
methods labelled 1 and 2 as promised, and a bunch<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
of atomic
weights close to the nominal figure of 12.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Make an appropriate plot to compare the measurements
obtained by the two methods. You might need to do something about
the two methods being given as numbers even though they are really
only identifiers. (If you do, your report ought to say what you did
and why.)</li>
</ol>
<p>Solution</p>
<p>The appropriate plot, with a categorical method and quantitative
weight, is something like a boxplot. If you’re not careful,
<code>method</code> will get treated as a quantitative variable,
which you don’t want; the easiest way around that, for a boxplot
at least, is to turn it into a factor like this:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">ggplot</span>(carbon, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(method), <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="pasias_files/figure-html/seewerin-1.png" width="672" /></p>
<p>If you insist, you could do a faceted histogram (above and below, for preference):</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">ggplot</span>(carbon, <span class="kw">aes</span>(<span class="dt">x =</span> weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>method, <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/schuomarcher-1.png" width="672" /></p>
<p>There are really not enough data values for a histogram to be of much
help, so I don’t like this as much.</p>
<p>If you are thinking ahead (we are going to be doing a <span class="math inline">\(t\)</span>-test), then
you’ll realize that normality is the kind of thing we’re looking for,
in which case normal quantile plots would be the thing. However, we
might have to be rather forgiving for method 2 since there are only 5
observations:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">ggplot</span>(carbon, <span class="kw">aes</span>(<span class="dt">sample =</span> weight)) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-2" title="2"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>method)</a></code></pre></div>
<p><img src="pasias_files/figure-html/mulichs-1.png" width="672" /></p>
<p>I don’t mind these coming out side by side, though I would rather have
them squarer.</p>
<p>I would say, boxplots are the best, normal quantile plots are also
acceptable, but expect to lose something for histograms because they
offer only a rather crude comparison in this case.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Comment briefly on what you see in your plot.</li>
</ol>
<p>Solution</p>
<p>In boxplots, if that’s what you drew, there are several things
that deserve comment: the medians, the spreads and the
shapes. The median for method 1 is a little bit lower than for
method 2 (the means are probably more different, given the
shapes of the boxes). The spread for method 2 is a lot
bigger. (Looking forward, that suggests a Welch-Satterthwaite
rather than a pooled test.) As for shape, the method 2
measurements seem more or less symmetric (the whiskers are equal
anyway, even if the position of the median in the box isn’t),
but the method 1 measurements have a low outlier.
The histograms are hard to compare. Try to say something about
centre and spread and shape. I think the method 2 histogram has
a slightly higher centre and definitely bigger spread. On my
histogram for method 1, the distribution looks skewed left.
If you did normal quantile plots, say something sensible about
normality for each of the two methods. For method 1, I would say
the low value is an outlier and the rest of the values look
pretty straight. Up to you whether you think there is a curve on
the plot (which would indicate skewness, but then that highest
value is too high: it would be bunched up with the other values
below 12.01 if there were really skewness).
For method 2, it’s really hard to say anything since there are
only five values. Given where the line goes, there isn’t much
you can say to doubt normality. Perhaps the best you can say
here is that in a sample of size 5, it’s difficult to assess
normality at all.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Carry out the most appropriate <span class="math inline">\(t\)</span>-test. (You might like to
begin another new section in your report here.)</li>
</ol>
<p>Solution</p>
<p>This would be the Welch-Satterthwaite version of the two-sample
<span class="math inline">\(t\)</span>-test, since the two groups do appear to have different spreads:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">t.test</span>(weight <span class="op">~</span><span class="st"> </span>method, <span class="dt">data =</span> carbon)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  weight by method
## t = -1.817, df = 5.4808, p-value = 0.1238
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.027777288  0.004417288
## sample estimates:
## mean in group 1 mean in group 2 
##        12.00260        12.01428</code></pre>
<p>Imagining that this is a report that would go to your boss, you ought
to defend your choice of the Welch-Satterthwaite test (as I did
above), and not just do the default <span class="math inline">\(t\)</span>-test without comment.</p>
<p>If, in your discussion above, you thought the spreads were equal
enough, then you should do the pooled <span class="math inline">\(t\)</span>-test here, which goes like this:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">t.test</span>(weight <span class="op">~</span><span class="st"> </span>method, <span class="dt">data =</span> carbon, <span class="dt">var.equal =</span> T)</a></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  weight by method
## t = -2.1616, df = 13, p-value = 0.04989
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.335341e-02 -6.588810e-06
## sample estimates:
## mean in group 1 mean in group 2 
##        12.00260        12.01428</code></pre>
<p>The point here is that you should do the right test based on your
conclusion. Being consistent is the most important thing. (In this
case, note that the P-values are very different. We’ll get to that
shortly.)</p>
<p>If we were doing this in SAS, as we see later, we’d get a test at the
bottom of the output that compares the two variances. I feel that it’s
just as good to eyeball the spreads and make a call about whether they
are “reasonably close”. Or even, to always do the
Welch-Satterthwaite test on the basis that it is pretty good even if
the two populations have the same variance. (If this last point of
view is one that you share, you ought to say something about that when
you do your <span class="math inline">\(t\)</span>-test.)</p>
<p>Extra: I guess this is a good place to say something about tests for comparing
variances, given that you might be pondering that. There are
several that I can think of, that R can do, of which I mention two.</p>
<p>The first is the <span class="math inline">\(F\)</span>-test for variances that you might have learned in
B57 (that is the basis for the ANOVA <span class="math inline">\(F\)</span>-test):</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">var.test</span>(weight <span class="op">~</span><span class="st"> </span>method, <span class="dt">data =</span> carbon)</a></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  weight by method
## F = 0.35768, num df = 9, denom df = 4, p-value = 0.1845
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.04016811 1.68758230
## sample estimates:
## ratio of variances 
##          0.3576842</code></pre>
<p>This, unfortunately, is rather dependent on the data in the two groups
being approximately normal. Since we are talking variances rather than
means, there is no Central Limit Theorem to rescue us for large
samples (quite aside from the fact that these samples are <em>not</em>
large). Since the ANOVA <span class="math inline">\(F\)</span>-test is based on the same theory, this is
why normality is also more important in ANOVA than it is in a <span class="math inline">\(t\)</span>-test.</p>
<p>The second is Levene’s test. This doesn’t depend on normality (at
least, not nearly so much), so I like it better in general:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">leveneTest</span>(weight <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(method), <span class="dt">data =</span> carbon)</a></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  1  0.9887 0.3382
##       13</code></pre>
<p>Levene’s test takes a different approach: first the absolute
differences from the group medians are calculated, and then an ANOVA
is run on the absolute differences. If, say, one of the groups has a
larger spread than the other(s), its absolute differences from the
median will tend to be bigger.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
As for what we conclude here, well, neither of the variance tests show
any significance at all, so from that point of view there is no
evidence against using the pooled <span class="math inline">\(t\)</span>-test. Having said that, the
samples are small, and so it would be difficult to <em>prove</em> that
the two methods have different variance, even if they actually
did.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p>Things are never as clear-cut as you would like. In the end, it all
comes down to making a call and defending it.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Do the most appropriate test you know that does not assume
normally-distributed data.</li>
</ol>
<p>Solution</p>
<p>That would be Mood’s median test. Since I didn’t say anything
about building it yourself, feel free to use <code>smmr</code>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">median_test</span>(carbon, weight, method)</a></code></pre></div>
<pre><code>## $table
##      above
## group above below
##     1     3     6
##     2     4     1
## 
## $test
##        what      value
## 1 statistic 2.80000000
## 2        df 1.00000000
## 3   P-value 0.09426431</code></pre>
<p>As an aside, if you have run into a non-parametric test such as
Mann-Whitney or Kruskal-Wallis that applies in this situation, be
careful about using it here, because they have additional assumptions
that you may not want to trust. Mann-Whitney started life as a test for
“equal distributions.”<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> This
means that the null is equal location <em>and</em> equal spread, and if
you reject the null, one of those has failed. But here, we suspect that
equal spread will fail, so that the Mann-Whitney test may end up
rejecting <em>whether or not</em> the medians are different, so it won’t
answer the question you want an answer to. Mood’s median test doesn’t
have that problem; all it’s saying if the null is true is that the
medians are equal; the spreads could be anything at all.</p>
<p>The same kind of issues apply to the signed-rank test vs. the sign
test. In the case of the signed-rank test, the extra assumption is of
a symmetric distribution — to my mind, if you don’t believe
normality, you probably don’t have much confidence in symmetry
either. That’s why I like the sign test and Mood’s median test: in the
situation where you don’t want to be dealing with assumptions, these
tests don’t make you worry about that.</p>
<p>Another comment that you don’t need to make is based on the
not-quite-significance of the Mood test. The P-value is less than 0.10
but not less than 0.05, so it doesn’t quite reach significance by the
usual standard. But if you look up at the table, the frequencies seem
rather unbalanced: 6 out of the remaining 9 weights in group 1 are
below the overall median, but 4 out of 5 weights in group 2 are
above. This seems as if it ought to be significant, but bear in mind
that the sample sizes are small, and thus Mood’s median test needs
<em>very</em> unbalanced frequencies, which we don’t quite have here.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" style="list-style-type: lower-alpha">
<li>Discuss the results of your tests and what they say about
the two methods for measuring the atomic weight of carbon. If it
seems appropriate, put the discussion into a section called
Conclusions.</li>
</ol>
<p>Solution</p>
<p>Begin by pulling out the P-values for your preferred test(s) and
say what they mean. The P-value for the Welch-Satterthwaite
<span class="math inline">\(t\)</span>-test is 0.1238, which indicates no difference in mean atomic
weights between the two methods. The Mood median test gives a
similarly non-significant 0.0943, indicating no difference in
the <em>median</em> weights. If you think both tests are
plausible, then give both P-values and do a compare-and-contrast
with them; if you think that one of the tests is clearly
preferable, then say so (and why) and focus on that test’s
results.</p>
<p>If you thought the pooled test was the right one, then you’ll
have a bit more discussion to do, since its P-value is 0.0499,
and at <span class="math inline">\(\alpha=0.05\)</span> this test disagrees with the others. If you
are comparing this test with the Mood test, you ought to make
some kind of reasoned recommendation about which test to
believe.</p>
<p>As ever, be consistent in your reasoning.</p>
<p>Extra: this dataset, where I found it, was actually being used to
illustrate a case where the pooled and the Welch-Satterthwaite
tests disagreed. The authors of the original paper that used
this dataset (a 1987 paper by Best and Rayner;<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
the data come from 1924!) point out that the
pooled <span class="math inline">\(t\)</span>-test can be especially misleading when the smaller
sample is also the one with the larger variance. This is what
happened here.</p>
<p>In the Best and Rayner paper, the Mood (or the Mann-Whitney) test was
not being considered, but I think it’s good practice to draw a
picture and make a call about which test is appropriate.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="sparrowhawks-1" class="section level2">
<h2><span class="header-section-number">14.6</span> Sparrowhawks</h2>
<p>(This is a report-writing question, but it also uses some regression techniques from later in the course.)</p>
<p>One of nature’s patterns is the relationship
between the percentage of adult birds in a colony that return from the
previous year, and the number of new adults that join the colony. Data
for 13 colonies of sparrowhawks can be found at
<a href="http://ritsokiguess.site/datafiles/sparrowhawk.txt">link</a>. The
columns are the percentage of adults returning from the previous year,
and the number of new adults that join the colony.</p>
<ol style="list-style-type: lower-alpha">
<li>Create a new R Markdown report, give it a suitable title, and
ask for HTML output. Answer the questions that follow in your
report. At any stage, you can Knit HTML
to see how the report looks so far.</li>
</ol>
<p>Solution</p>
<p>In R Studio, select File, New File, R Markdown. Fill in the Title,
Author and leave the Default Output Format at HTML. You’ll see a
template report with the document info at the top. This is my document info:</p>
<p><img src="sh0.png" /></p>
<p>This is known in the jargon as a “YAML block.”<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>
Below that is the template R Markdown document, which you can delete now or later.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Read in the data and display the first few values. Add some text saying how many rows of data
there are.</li>
</ol>
<p>Solution</p>
<p>Read the data into a data frame. In your
report, add some text like “we read in the data”, perhaps
after a section heading like “The data”. Then add a <em>code chunk</em>
by selecting Chunks and Insert Chunk, or by pressing
control-alt-I. So far you have something like this.</p>
<p><img src="sh1.png" /></p>
<p>Inside the code chunk, that is, in the bit between the
backtick characters, put R code, just as you would type it at
the Console or put in an R notebook. In this case, that would be
the following code, minus the message that comes out of
<code>read_delim</code>:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb84-2" title="2">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/sparrowhawk.txt&quot;</span></a>
<a class="sourceLine" id="cb84-3" title="3">sparrowhawks &lt;-<span class="st"> </span><span class="kw">read_delim</span>(my_url, <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   returning = col_double(),
##   newadults = col_double()
## )</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">sparrowhawks</a></code></pre></div>
<p>For you, it looks like this:</p>
<p><img src="sh2.png" /></p>
<p>We don’t know how many rows of data there are yet, so I’ve left a
“placeholder” for it, when we figure it out.
The file is annoyingly called <code>sparrowhawk.txt</code>,
singular. Sorry about that.
If you knit this (click on “Knit HTML” next to the ball of wool,
or press control-shift-K), it should run, and you’ll see a viewer
pop up with the HTML output. Now you can see how many rows there
are, and you can go back and edit the R Markdown and put in 13 in
place of the x’s, and knit again.
You might be worried about how hard R is working with all this
knitting. Don’t worry about that. R can take it.
Mine looked like this:</p>
<p><img src="waluj.png" /></p>
<p>There is a better way of adding values that come from the output,
which I mention here in case you are interested (if you are not,
feel free to skip this). What you do is to make what is called an
“inline code chunk”. Where you want a number to appear in the
text, you have some R Markdown that looks like this:</p>
<p><img src="sh3.png" /></p>
<p>The piece inside the backticks is the letter <code>r</code>, a space,
and then one line of R code. The one line of code will be run, and
all of the stuff within the backticks will be replaced in the
output by the result of running the R code, in this case the
number 13. Typically, you are extracting a number from the data,
like the number of rows or a mean of something. If it’s a decimal
number, it will come out with a lot of decimal places unless you
explicitly <code>round</code> it.
OK, let me try it: the data frame has 13
rows altogether. I didn’t type that number; it was calculated from
the data frame. Woo hoo!</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Create a new section entitled “Exploratory analysis”, and
create a scatterplot for predicting number of new adults from the
percentage of returning adults. Describe what you see, adding some
suitable text to your report.</li>
</ol>
<p>Solution</p>
<p>The R code you add should look like this, with the results shown
(when you knit the report again):</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">ggplot</span>(sparrowhawks, <span class="kw">aes</span>(<span class="dt">x =</span> returning, <span class="dt">y =</span> newadults)) <span class="op">+</span></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="pasias_files/figure-html/sparrowhawk-2-1.png" width="672" /></p>
<p><br></p>
<p>The piece of report that I added looks like this:</p>
<p><img src="sh4.png" /></p>
<p>Note (i) that you have to do nothing special to get the plot to
appear, and (ii) that I put “smaller” in italics, and you see
how.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Obtain the correlation between the two variables. Is this
consistent with the scatterplot? Explain briefly. (The R function
you need is <code>cor</code>. You can feed it a data frame.)</li>
</ol>
<p>Solution</p>
<p>The appropriate R code is this, in another code chunk:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">with</span>(sparrowhawks, <span class="kw">cor</span>(newadults, returning))</a></code></pre></div>
<pre><code>## [1] -0.7484673</code></pre>
<p>Or you can ask for the correlations of the whole data frame:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">cor</span>(sparrowhawks)</a></code></pre></div>
<pre><code>##            returning  newadults
## returning  1.0000000 -0.7484673
## newadults -0.7484673  1.0000000</code></pre>
<p>This latter is a “correlation matrix” with a correlation between each
column and each other column. Obviously the correlation between a
column and itself is 1, and that is <em>not</em> the one we want.</p>
<p>I added this to the report (still in the Exploratory Analysis
section, since it seems to belong there):</p>
<p><img src="sh5.png" /></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Obtain the regression line for predicting the number of new
adults from the percentage of returning adults.</li>
</ol>
<p>Solution</p>
<p>This R code, in another code chunk:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">newadults<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(newadults <span class="op">~</span><span class="st"> </span>returning, <span class="dt">data =</span> sparrowhawks)</a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">summary</span>(newadults<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = newadults ~ returning, data = sparrowhawks)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.8687 -1.2532  0.0508  2.0508  5.3071 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 31.93426    4.83762   6.601 3.86e-05 ***
## returning   -0.30402    0.08122  -3.743  0.00325 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.667 on 11 degrees of freedom
## Multiple R-squared:  0.5602, Adjusted R-squared:  0.5202 
## F-statistic: 14.01 on 1 and 11 DF,  p-value: 0.003248</code></pre>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>What are the intercept and slope of your regression line? Is
the slope significant? What does that mean, in the context of the data?</li>
</ol>
<p>Solution</p>
<p>See the output in the previous part. That’s what we need to talk about.
I added this to the report. I thought we deserved a new section here:</p>
<p><img src="sh6.png" /></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Create a scatterplot of the data with the regression line on it.</li>
</ol>
<p>Solution</p>
<p>This code. Using <code>geom_smooth</code> with
<code>method="lm"</code>
will add the regression line to the plot:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">ggplot</span>(sparrowhawks, <span class="kw">aes</span>(<span class="dt">x =</span> returning, <span class="dt">y =</span> newadults)) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="pasias_files/figure-html/sparrowhawk-6-1.png" width="672" /></p>
<p>I added a bit of text to the report, which I will show in a moment.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" style="list-style-type: lower-alpha">
<li>For short-lived birds, the association between these two
variables is positive: changes in weather and food supply cause the
populations of new and returning birds to increase together. For
long-lived territorial birds, however, the association is negative
because returning birds claim their territories in the colony and do
not leave room for new recruits. Which type of species is the
sparrowhawk? Add a short Conclusions section to your report with
discussion of this issue.</li>
</ol>
<p>Solution</p>
<p>My addition to the report looks like this:</p>
<p><img src="sh7.png" /></p>
<p>I think that rounds off the report nicely.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>It’s probably better in a report to use language a bit more formal than <em>a bunch</em>. Something like <em>a number</em> would be better.<a href="writing-reports.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>The use of absolute differences, and the median, downplays the influence of outliers. The assumption here is that the absolute differences from the medians are approximately normal, which seems a less big assumption than assuming the actual data are approximately normal.<a href="writing-reports.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>This is coming back to the <em>power</em> of something like Levene’s test; the power of any test is not going to be very big if the sample sizes are small.<a href="writing-reports.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>The test goes back to the 1940s.<a href="writing-reports.html#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Best, D. J., and J. C. W. Rayner. “Welch’s Approximate Solution for the Behrens–Fisher Problem.” Technometrics 29, no. 2 (May 1, 1987): 205–10. <a href="doi:10.1080/00401706.1987.10488211" class="uri">doi:10.1080/00401706.1987.10488211</a>. The data set is near the end.<a href="writing-reports.html#fnref6" class="footnote-back">↩</a></p></li>
<li id="fn7"><p>YAML stands for <em>Yet Another Markup Language</em>, but we’re only using it in this course as the top bit of an R Markdown document.<a href="writing-reports.html#fnref7" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysis-of-variance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="learning-to-code-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["pasias.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

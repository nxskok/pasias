<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Problems and Solutions in Applied Statistics" />
<meta property="og:type" content="book" />
<meta property="og:url" content="<a href="http://ritsokiguess.site/pasias" class="uri">http://ritsokiguess.site/pasias</a>" />

<meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
<meta name="github-repo" content="nxskok/pasias" />

<meta name="author" content="Ken Butler" />

<meta name="date" content="2018-10-09" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics">

<title>Problems and Solutions in Applied Statistics</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li class="has-sub"><a href="getting-used-to-r-and-r-studio.html#getting-used-to-r-and-r-studio"><span class="toc-section-number">2</span> Getting used to R and R Studio</a><ul>
<li><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><span class="toc-section-number">2.1</span> Getting an R Studio Cloud account</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#getting-started"><span class="toc-section-number">2.2</span> Getting started</a></li>
<li><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><span class="toc-section-number">2.3</span> Reading data from a file</a></li>
</ul></li>
<li class="has-sub"><a href="reading-in-data-and-drawing-some-graphs.html#reading-in-data-and-drawing-some-graphs"><span class="toc-section-number">3</span> Reading in data and drawing some graphs</a><ul>
<li><a href="reading-in-data-and-drawing-some-graphs.html#orange-juice"><span class="toc-section-number">3.1</span> Orange juice</a></li>
<li><a href="reading-in-data-and-drawing-some-graphs.html#making-soap"><span class="toc-section-number">3.2</span> Making soap</a></li>
<li><a href="reading-in-data-and-drawing-some-graphs.html#handling-shipments"><span class="toc-section-number">3.3</span> Handling shipments</a></li>
</ul></li>
<li class="has-sub"><a href="data-exploration.html#data-exploration"><span class="toc-section-number">4</span> Data exploration</a><ul>
<li><a href="data-exploration.html#north-carolina-births"><span class="toc-section-number">4.1</span> North Carolina births</a></li>
<li><a href="data-exploration.html#more-about-the-nc-births"><span class="toc-section-number">4.2</span> More about the NC births</a></li>
<li><a href="data-exploration.html#nenana-alaska"><span class="toc-section-number">4.3</span> Nenana, Alaska</a></li>
<li><a href="data-exploration.html#computerized-accounting"><span class="toc-section-number">4.4</span> Computerized accounting</a></li>
</ul></li>
<li class="has-sub"><a href="one-sample-inference.html#one-sample-inference"><span class="toc-section-number">5</span> One-sample inference</a><ul>
<li><a href="one-sample-inference.html#hunter-gatherers-in-australia"><span class="toc-section-number">5.1</span> Hunter-gatherers in Australia</a></li>
<li><a href="one-sample-inference.html#length-of-gestation-in-north-carolina"><span class="toc-section-number">5.2</span> Length of gestation in North Carolina</a></li>
<li><a href="one-sample-inference.html#inferring-ice-break-up-in-nenana"><span class="toc-section-number">5.3</span> Inferring ice break-up in Nenana</a></li>
</ul></li>
<li class="has-sub"><a href="two-sample-inference.html#two-sample-inference"><span class="toc-section-number">6</span> Two-sample inference</a><ul>
<li><a href="two-sample-inference.html#children-and-electronic-devices"><span class="toc-section-number">6.1</span> Children and electronic devices</a></li>
<li><a href="two-sample-inference.html#parking-close-to-the-curb"><span class="toc-section-number">6.2</span> Parking close to the curb</a></li>
</ul></li>
<li class="has-sub"><a href="power-and-sample-size.html#power-and-sample-size"><span class="toc-section-number">7</span> Power and sample size</a><ul>
<li><a href="power-and-sample-size.html#simulating-power"><span class="toc-section-number">7.1</span> Simulating power</a></li>
<li><a href="power-and-sample-size.html#calculating-power-and-sample-size-for-estimating-mean"><span class="toc-section-number">7.2</span> Calculating power and sample size for estimating mean</a></li>
<li><a href="power-and-sample-size.html#simulating-power-for-proportions"><span class="toc-section-number">7.3</span> Simulating power for proportions</a></li>
</ul></li>
<li class="has-sub"><a href="the-sign-test-and-moods-median-test.html#the-sign-test-and-moods-median-test"><span class="toc-section-number">8</span> The sign test and Mood’s median test</a><ul>
<li><a href="the-sign-test-and-moods-median-test.html#running-a-maze"><span class="toc-section-number">8.1</span> Running a maze</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#chocolate-chips"><span class="toc-section-number">8.2</span> Chocolate chips</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#the-power-of-the-sign-test"><span class="toc-section-number">8.3</span> The power of the sign test</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#sugar-in-breakfast-cereals"><span class="toc-section-number">8.4</span> Sugar in breakfast cereals</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#fear-of-math"><span class="toc-section-number">8.5</span> Fear of math</a></li>
<li><a href="the-sign-test-and-moods-median-test.html#medical-instructions"><span class="toc-section-number">8.6</span> Medical instructions</a></li>
</ul></li>
<li class="has-sub"><a href="matched-pairs-t-and-sign-test.html#matched-pairs-t-and-sign-test"><span class="toc-section-number">9</span> Matched pairs t and sign test</a><ul>
<li><a href="matched-pairs-t-and-sign-test.html#measuring-body-fat"><span class="toc-section-number">9.1</span> Measuring body fat</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#throwing-baseballs-and-softballs"><span class="toc-section-number">9.2</span> Throwing baseballs and softballs</a></li>
<li><a href="matched-pairs-t-and-sign-test.html#changes-in-salary"><span class="toc-section-number">9.3</span> Changes in salary</a></li>
</ul></li>
<li class="has-sub"><a href="normal-quantile-plots.html#normal-quantile-plots"><span class="toc-section-number">10</span> Normal quantile plots</a><ul>
<li><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><span class="toc-section-number">10.1</span> Lengths of heliconia flowers</a></li>
<li><a href="normal-quantile-plots.html#ferritin-and-normality"><span class="toc-section-number">10.2</span> Ferritin and normality</a></li>
</ul></li>
<li class="has-sub"><a href="analysis-of-variance.html#analysis-of-variance"><span class="toc-section-number">11</span> Analysis of variance</a><ul>
<li><a href="analysis-of-variance.html#movie-ratings-and-lengths"><span class="toc-section-number">11.1</span> Movie ratings and lengths</a></li>
<li><a href="analysis-of-variance.html#deer-and-how-much-they-eat"><span class="toc-section-number">11.2</span> Deer and how much they eat</a></li>
<li><a href="analysis-of-variance.html#movie-ratings-again"><span class="toc-section-number">11.3</span> Movie ratings again</a></li>
<li><a href="analysis-of-variance.html#atomic-weight-of-carbon"><span class="toc-section-number">11.4</span> Atomic weight of carbon</a></li>
</ul></li>
<li class="has-sub"><a href="tidying-and-selecting-data.html#tidying-and-selecting-data"><span class="toc-section-number">12</span> Tidying and selecting data</a><ul>
<li><a href="tidying-and-selecting-data.html#tidying-the-jays-data"><span class="toc-section-number">12.1</span> Tidying the Jays data</a></li>
<li><a href="tidying-and-selecting-data.html#ethanol-and-sleep-time-in-rats"><span class="toc-section-number">12.2</span> Ethanol and sleep time in rats</a></li>
<li><a href="tidying-and-selecting-data.html#growth-of-tomatoes"><span class="toc-section-number">12.3</span> Growth of tomatoes</a></li>
<li><a href="tidying-and-selecting-data.html#pain-relief-in-migraine-headaches-again"><span class="toc-section-number">12.4</span> Pain relief in migraine headaches (again)</a></li>
<li><a href="tidying-and-selecting-data.html#location-species-and-disease-in-plants"><span class="toc-section-number">12.5</span> Location, species and disease in plants</a></li>
<li><a href="tidying-and-selecting-data.html#kens-cars"><span class="toc-section-number">12.6</span> Ken’s cars</a></li>
<li><a href="tidying-and-selecting-data.html#number-1-songs"><span class="toc-section-number">12.7</span> Number 1 songs</a></li>
</ul></li>
<li class="has-sub"><a href="regression.html#regression"><span class="toc-section-number">13</span> Regression</a><ul>
<li><a href="regression.html#facebook-friends-and-grey-matter"><span class="toc-section-number">13.1</span> Facebook friends and grey matter</a></li>
<li><a href="regression.html#endogenous-nitrogen-excretion-in-carp"><span class="toc-section-number">13.2</span> Endogenous nitrogen excretion in carp</a></li>
<li><a href="regression.html#sparrowhawks"><span class="toc-section-number">13.3</span> Sparrowhawks</a></li>
<li><a href="regression.html#salaries-of-social-workers"><span class="toc-section-number">13.4</span> Salaries of social workers</a></li>
<li><a href="regression.html#predicting-volume-of-wood-in-pine-trees"><span class="toc-section-number">13.5</span> Predicting volume of wood in pine trees</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="matched-pairs-t-and-sign-test" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Matched pairs t and sign test</h1>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb500-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" data-line-number="1"><span class="kw">library</span>(smmr)</a></code></pre></div>
<div id="measuring-body-fat" class="section level2">
<h2><span class="header-section-number">9.1</span> Measuring body fat</h2>
<p>Athletes are concerned with measuring their body fat
percentage. Two different methods are available: one using ultrasound,
and the other using X-ray technology. We are interested in whether
there is a difference in the mean body fat percentage as measured by
these two methods, and if so, how big that difference is. Data on 16
athletes are at
<a href="http://www.utsc.utoronto.ca/~butler/c32/bodyfat.txt" class="uri">http://www.utsc.utoronto.ca/~butler/c32/bodyfat.txt</a>.</p>
<ol style="list-style-type: lower-alpha">
<li>Explain briefly why a matched pairs analysis is more
suitable for these data than a two-independent-samples analysis
(using a two-sample <span class="math inline">\(t\)</span>-test). You might find that looking at the
data (clicking on the link) helps you figure this out.</li>
</ol>
<p>Solution</p>
<p>The data file looks like this:
<code>timinput{bodyf</code>t.txt}
The data are two measurements for each of the 16 athletes: that
is, each athlete had their body fat percentage measured using
<em>both</em> of the two methods.
Extra: a two-sample <span class="math inline">\(t\)</span> approach would be reasonable if one set of 16
athletes had been measured by X-ray and <em>another different</em>
set of 16 athletes had been measured by ultrasound. (That is, if
there had been 32 athletes in total, with each one randomly
assigned to <em>one</em> of the measurement methods.) But that’s not
what happened. It is easy to measure one athlete’s body fat
percentage using both of the two methods, so a matched pairs
design is easy to implement (as well as being better). If you use
two independent samples (each athlete doing only one measurement
method), you introduce an extra source of variability: athletes
differ one from another in body fat, as well as differing possibly
by measurement method. If you use a matched-pairs design, you
remove the athlete-to-athlete differences, leaving only the
differences due to measurement method.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Read in the data and check that you have a sensible number of
rows and columns.</li>
</ol>
<p>Solution</p>
<p>This kind of thing. Since you looked at the data (didn’t you?),
you’ll know that the values are separated by single spaces:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb505-1" data-line-number="1">myurl=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/c32/bodyfat.txt&quot;</span></a>
<a class="sourceLine" id="cb505-2" data-line-number="2">bodyfat=<span class="kw">read_delim</span>(myurl,<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   athlete = col_integer(),
##   xray = col_double(),
##   ultrasound = col_double()
## )</code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb507-1" data-line-number="1">bodyfat  </a></code></pre></div>
<pre><code>## # A tibble: 16 x 3
##    athlete  xray ultrasound
##      &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;
##  1       1  5          4.75
##  2       2  7          3.75
##  3       3  9.25       9   
##  4       4 12         11.8 
##  5       5 17.2       17   
##  6       6 29.5       27.5 
##  7       7  5.5        6.5 
##  8       8  6          6.75
##  9       9  8          8.75
## 10      10  8.5        9.5 
## 11      11  9.25       9.5 
## 12      12 11         12   
## 13      13 12         12.2 
## 14      14 14         15.5 
## 15      15 17         18   
## 16      16 18         18.2</code></pre>
<p>16 rows (athletes) and 3 columns, one for each measurement
method and one labelling the athletes. All good.</p>
<p>Since 16 is not too much bigger than 10, I got the whole data frame
here. (At least, I think that’s the reason I got more than 10 rows.)
In an R Notebook, you’ll see the first ten rows as normal, with a
button to click to see the other six.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Carry out a suitable test to determine whether the means are
the same or different. (At this point, obtain the R output including a P-value.)</li>
</ol>
<p>Solution</p>
<p>Feed the two columns into <code>t.test</code> along with
<code>paired=T</code>. This is a two-sided test, so we don’t have to
take any special steps for that. Note that we’re back to the
“old-fashioned” version of <code>t.test</code> that <em>does not</em>
allow <code>data=</code>, so we have to go the <code>with</code> way:</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb509-1" data-line-number="1"><span class="kw">with</span>(bodyfat,<span class="kw">t.test</span>(xray,ultrasound,<span class="dt">paired=</span>T))</a></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  xray and ultrasound
## t = -0.30801, df = 15, p-value = 0.7623
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.7425068  0.5550068
## sample estimates:
## mean of the differences 
##                -0.09375</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>What do you conclude from the test?</li>
</ol>
<p>Solution</p>
<p>The P-value of 0.7623 is not at all small, so there is no way we can
reject the null hypothesis.
<label for="tufte-mn-25" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-25" class="margin-toggle"><span class="marginnote">My hat stays on my head.</span> There
is no evidence of a difference in means; we can act as if the two
methods produce the same mean body fat percentage.
That is to say, on this evidence we can use either method, whichever
one is cheaper or more convenient.
Extra: an informal way of seeing whether this is reasonable is to see how
often the first value of the pair is larger, and how often the
second. If the null hypothesis is true, there should be about a
50–50 split, but if false, there should be a very uneven
split. Here that would go like this:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" data-line-number="1"><span class="kw">with</span>(bodyfat,<span class="kw">table</span>(xray<span class="op">&gt;</span>ultrasound))</a></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    10     6</code></pre>
<p>or like this:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb513-1" data-line-number="1">bodyfat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(xray<span class="op">&gt;</span>ultrasound)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   `xray &gt; ultrasound`     n
##   &lt;lgl&gt;               &lt;int&gt;
## 1 FALSE                  10
## 2 TRUE                    6</code></pre>
<p>6 times the X-ray value was bigger, and 10 times the ultrasound value
was. A pretty even split, so it’s not surprising that we failed to
reject the null. (You might recognize this as an informal version of
the sign test.)</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Obtain a 95% confidence interval for the population mean
difference. How is the interval consistent with your test?</li>
</ol>
<p>Solution</p>
<p>You don’t even need to do any more coding: the test was two-sided,
so just pick the confidence interval off the output above: <span class="math inline">\(-0.74\)</span>
to 0.56.
The interval includes both positive and negative values (or, 0 is
inside the interval), so the difference could go either way. This is
entirely consistent with not being able to reject the null.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Calculate the differences, and make a normal quantile plot of
them. Is there any evidence that normality of differences fails?
Explain briefly. (If we haven’t gotten to normal quantile plots in
class when you read this, make a different plot to assess this issue.)</li>
</ol>
<p>Solution</p>
<p>The smoothest
<label for="tufte-mn-26" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-26" class="margin-toggle"><span class="marginnote">I learned yesterday that the Welsh word for <em>ironing</em> is <em>smwddio</em>, which seems weird until you say it out loud: it sounds like <em>smoothio</em>.</span>
way to do this is to
use a pipeline: use a <code>mutate</code> to create the column of
differences, and then pipe that into <code>ggplot</code>, omitting the
data frame that would normally go first (the input data frame here
is the new one with the differences in it, which doesn’t have a
name). I’ll make a normal quantile plot in a moment, but if we
haven’t talked about that yet, the plot to make is a histogram:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" data-line-number="1">bodyfat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">diff=</span>xray<span class="op">-</span>ultrasound) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb515-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>diff))<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">6</span>)</a></code></pre></div>
<p><img src="08-matched-pairs-sign_files/figure-html/unnamed-chunk-6-1.png" width="672"  /></p>
<p>I don’t know whether you’d call that “approximately normal” or
not. We are in kind of a double-bind with this one: the sample size is
small, so normality matters, but with a small sample, the data might
not look very normal. It’s kind of skewed right, but most of the
evidence for the skewness is contained in those two observations with
difference 2 and above, which is pretty flimsy evidence for
anything. (In the normal quantile plot below, the suggestion is that
those two observations really are a bit too large. It’s easier to tell
there.)</p>
<p>Below, I’m repeating the calculation of the differences, which is
inefficient. If I’m going to draw two graphs of the differences, the
right way is to calculate the differences , then use that new data frame twice. But you’re probably only
going to draw either the histogram or the normal quantile plot, not
both, so you can use the appropriate one of my two bits of code. The
normal quantile plot:</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" data-line-number="1">bodyfat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">diff=</span>xray<span class="op">-</span>ultrasound) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb516-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample=</span>diff))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="08-matched-pairs-sign_files/figure-html/unnamed-chunk-7-1.png" width="672"  />
This is showing a little evidence of skewness or outliers (depending
on your point of view: either is good). The lowest and highest values
are both too high, and the pattern of points on the plot is kind of
curved (which would be evidence of skewness). Or you could say that
the two highest values are too high, with the other values being more
or less in line (that would be evidence of outliers at the upper
end). I like outliers better than skewness, since those bottom-end
points are not far off the line. I would also accept “no substantial problems”,
if you can make the case that those two highest points are
not too far off the line. With only 16 observations as we have here,
even truly normal data would stray off the line a bit.</p>
<p>As ever, your explanation is more important than your conclusion. Can
you justify what you think?</p>
<p>If you took your differences the other way around, as
<code>ultrasound</code> minus <code>xray</code>, your plot will also be the
other way around, with the “outliers” at the bottom. That’s good
too.</p>
<p>Where this is going (which I didn’t ask you) is whether or not we
trust the result of the matched pairs test. I would say that the test
is so far from being significant, and the failure of normality is not
gross, that it is hard to imagine <em>any</em> alternative test coming
up with a significant result. So I would be happy to trust this paired
<span class="math inline">\(t\)</span>-test.</p>
</div>
<div id="throwing-baseballs-and-softballs" class="section level2">
<h2><span class="header-section-number">9.2</span> Throwing baseballs and softballs</h2>
<p>Can students throw a baseball farther than a softball? A
statistics class, containing 24 students, went out to a football field
to try to answer this question. Each student warmed up and then threw
each type of ball as far as they could. The order of ball types was
randomized: some students threw the baseball first, and some threw the
softball first. (A softball is bigger than a baseball, so we might
expect that a softball would be harder to throw a long way than a
baseball.) The data are in
<a href="http://www.utsc.utoronto.ca/~butler/c32/throw.txt" class="uri">http://www.utsc.utoronto.ca/~butler/c32/throw.txt</a> in three
columns: the first is a number identifying the student, the second is
the distance thrown with the baseball (in yards) and the third is the
distance thrown with the softball (also in yards).</p>
<ol style="list-style-type: lower-alpha">
<li>Read the data into R. You’ll need to supply some names
to the columns.</li>
</ol>
<p>Solution</p>
<p>This kind of thing:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" data-line-number="1">myurl=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/c32/throw.txt&quot;</span></a>
<a class="sourceLine" id="cb517-2" data-line-number="2">throws=<span class="kw">read_delim</span>(myurl,<span class="st">&quot; &quot;</span>,<span class="dt">col_names=</span><span class="kw">c</span>(<span class="st">&quot;student&quot;</span>,<span class="st">&quot;baseball&quot;</span>,<span class="st">&quot;softball&quot;</span>))</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   student = col_integer(),
##   baseball = col_integer(),
##   softball = col_integer()
## )</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" data-line-number="1">throws</a></code></pre></div>
<pre><code>## # A tibble: 24 x 3
##    student baseball softball
##      &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
##  1       1       65       57
##  2       2       90       58
##  3       3       75       66
##  4       4       73       61
##  5       5       79       65
##  6       6       68       56
##  7       7       58       53
##  8       8       41       41
##  9       9       56       44
## 10      10       70       65
## # ... with 14 more rows</code></pre>
<p>This is one of those times where we have to tell R what names to give
the columns. Or you can put <code>col_names=F</code> and leave the
columns called <code>X1, X2, X3</code> or whatever they end up as.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Calculate a column of differences, baseball minus softball,
<em>in</em> the data frame.</li>
</ol>
<p>Solution</p>
<p>Add it to the data frame using <code>mutate</code>. Use the
right-arrow assignment to create what I called
<code>throws2</code> below, or put something like
<code>throws2=</code> on the beginning of the line. Your choice.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" data-line-number="1">throws <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">diff=</span>baseball<span class="op">-</span>softball) -&gt;</a>
<a class="sourceLine" id="cb521-2" data-line-number="2">throws2</a></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Carry out a sign test in R, testing the null hypothesis
that the median difference is zero, against the alternative that
it is greater than zero. Obtain a P-value. Your option whether you use
<code>smmr</code> or not.</li>
</ol>
<p>Solution</p>
<p>I think using <code>smmr</code> is way easier, so I’ll do that
first. There is even a shortcut in that the null median defaults to
zero, which is exactly what we want here:</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb522-1" data-line-number="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb522-2" data-line-number="2"><span class="kw">sign_test</span>(throws2,diff)</a></code></pre></div>
<pre><code>## $above_below
## below above 
##     2    21 
## 
## $p_values
##   alternative      p_value
## 1       lower 9.999971e-01
## 2       upper 3.302097e-05
## 3   two-sided 6.604195e-05</code></pre>
<p>We want, this time, the upper-tailed one-sided test, since we want to
prove that students can throw a baseball a <em>longer</em> distance
than a softball. Thus the P-value we want is 0.000033.</p>
<p>To build it yourself, you know the steps by now.
First step is to count how many differences are greater and less than zero:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" data-line-number="1"><span class="kw">table</span>(throws2<span class="op">$</span>diff<span class="op">&gt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##     3    21</code></pre>
<p>or</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb526-1" data-line-number="1"><span class="kw">table</span>(throws2<span class="op">$</span>diff<span class="op">&lt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    22     2</code></pre>
<p>or, since we have things in a data frame,</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" data-line-number="1">throws2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(diff<span class="op">&gt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   `diff &gt; 0`     n
##   &lt;lgl&gt;      &lt;int&gt;
## 1 FALSE          3
## 2 TRUE          21</code></pre>
<p>or count those less than zero. I’d take any of those.</p>
<p>Note that these are <em>not all the same</em>. One of the differences is
in fact exactly zero. The technically right thing to do with the zero
difference is to throw it away (leaving 23 differences with 2 negative
and 21 positive). I would take that, or 2 or 3 negative differences
out of 24 (depending on whether you count “greater than zero” or
“less than zero”). We hope that this won’t make a material
difference to the P-value; it’ll make some difference, but won’t (we
hope) change the conclusion about whether to reject.</p>
<p>Second step is to get a P-value for whichever one of those you got,
from the appropriate binomial distribution.</p>
<p>The P-value is the probability of getting 21 (or 22) positive
differences out of 24 (or 23) or more, since this is the end of the
distribution we should be at if the alternative hypothesis is correct.
Thus any of these will get you a defensible P-value:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb530-1" data-line-number="1"><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">21</span><span class="op">:</span><span class="dv">23</span>,<span class="dv">23</span>,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## [1] 3.302097e-05</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb532-1" data-line-number="1"><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">22</span><span class="op">:</span><span class="dv">24</span>,<span class="dv">24</span>,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## [1] 1.7941e-05</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" data-line-number="1"><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">21</span><span class="op">:</span><span class="dv">24</span>,<span class="dv">24</span>,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## [1] 0.0001385808</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb536-1" data-line-number="1"><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">23</span>,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## [1] 3.302097e-05</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" data-line-number="1"><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">24</span>,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## [1] 1.7941e-05</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" data-line-number="1"><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">24</span>,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## [1] 0.0001385808</code></pre>
<p>The first and fourth of those are the same as <code>smmr</code> (throwing
away the exactly-median value).</p>
<p>As we hoped, there is no <em>material</em> difference here: there is no
doubt with any of these possibilities that we will reject a median
difference of zero in favour of a median difference greater than
zero.</p>
</div>
<div id="changes-in-salary" class="section level2">
<h2><span class="header-section-number">9.3</span> Changes in salary</h2>
<p>A company is growing and would like to attract more
employees. The company would like to advertise that salaries there are
increasing. To do this, the company randomly samples 20 employees that
have been working there since January 2016, and for each of these
employees, records their salary in January 2016 and January 2017. The
data, with salaries in thousands of dollars, are in
<a href="https://www.utsc.utoronto.ca/~butler/c32/salaryinc.txt" class="uri">https://www.utsc.utoronto.ca/~butler/c32/salaryinc.txt</a>.</p>
<p>(a)[2] Read the data into R and demonstrate that you have two
salaries for each of 20 employees.</p>
<p>Solution</p>
<p>Looking at the file, we see that the values are separated by
exactly one space:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" data-line-number="1">my_url=<span class="st">&quot;https://www.utsc.utoronto.ca/~butler/c32/salaryinc.txt&quot;</span></a>
<a class="sourceLine" id="cb542-2" data-line-number="2">salaries=<span class="kw">read_delim</span>(my_url,<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   employee = col_character(),
##   jan2016 = col_double(),
##   jan2017 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb544-1" data-line-number="1">salaries</a></code></pre></div>
<pre><code>## # A tibble: 20 x 3
##    employee jan2016 jan2017
##    &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1 A           36      39.5
##  2 B           41.2    47  
##  3 C           40      45  
##  4 D           42.8    49  
##  5 E           51      57.8
##  6 F           50.5    54  
##  7 G           56      62  
##  8 I           57.8    69.9
##  9 J           62      66.8
## 10 K           65.5    71  
## 11 L           66      72  
## 12 M           68.9    74  
## 13 N           71      80  
## 14 O           72.3    79  
## 15 P           74.6    80  
## 16 Q           77      83.1
## 17 R           79.9    82.5
## 18 S           81      92  
## 19 T           83.2    85  
## 20 U           90     101</code></pre>
<p>There are 20 employees (rows), and two columns of salaries: for each
employee in the data set, their salary in January 2016 and in January
2017 (thus, two salaries for each employee).</p>
<p>(b)[2] To compare the salaries, explain briefly why a
matched-pairs test would be better than a two-sample test.</p>
<p>Solution</p>
<p>A matched-pairs test would be better because we have two
observations (salaries) for each subject (employee). A two-sample
test would be appropriate if we had two separate sets of
employees, one set with their salaries recorded in 2016 and the
other with their salaries recorded in 2017. That is not what we
have here.
You can go after this either way: why a matched-pairs approach is
appropriate, or why a two-sample approach is not (or a bit of both).</p>
<p>(c)[4] Make a suitable graph to assess the assumptions for a
matched-pairs <span class="math inline">\(t\)</span>-test. What does your graph tell you?</p>
<p>Solution</p>
<p>This requires thought first before you do any coding (and this is
the reason for this one being four points). What has to be at
least approximately normally distributed is the set of
<em>differences</em>, salary at one time point minus the salary at
the other, for each employee. The individual salaries don’t have
to be normally distributed at all.
We don’t have the differences here, so we have to calculate them
first. The smoothest way is to make a pipeline:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb546-1" data-line-number="1">salaries <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb546-2" data-line-number="2"><span class="kw">mutate</span>(<span class="dt">diff=</span>jan2017<span class="op">-</span>jan2016) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb546-3" data-line-number="3"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample=</span>diff))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="08-matched-pairs-sign_files/figure-html/unnamed-chunk-17-1.png" width="672"  /></p>
<p>A couple of coding notes: (i) you can take the differences 2016 minus
2017 if you like (then they will tend to be negative), (ii)
<code>ggplot</code> used in a pipeline like this does <em>not</em> have a
data frame first (the data frame used is the nameless output from the
<code>mutate</code>, with the differences in it).</p>
<p>Also, there’s no problem doing the <code>mutate</code>, saving that, and
then feeding the saved data frame into <code>ggplot</code>. If you find
that clearer, go for it.</p>
<p>As for what I see: I think those points get a bit far from the
line at the high and low ends: the high values are too high and the
low values are too low, which is to say that we have outliers at both
ends, or the distribution has long tails (either way of saying it is
good).</p>
<p>The important conclusion here is whether these differences are normal
<em>enough</em> to trust a matched pairs <span class="math inline">\(t\)</span>-test here. We have a sample
of size 20, so the central limit theorem will help us some, but you
can reasonably say that these tails are too long and that we should
not trust a matched-pairs <span class="math inline">\(t\)</span>-test.</p>
<p>I actually wanted you to practice doing a matched-pairs <span class="math inline">\(t\)</span>-test
anyway, hence my comment in the next part, but the result is probably
not <em>so</em> trustworthy.</p>
<p>(d)[3] Carry out a suitable matched-pairs <span class="math inline">\(t\)</span>-test on these data. (If you
thought in the previous part that this was the wrong thing to do, do
it anyway for the purposes of this assignment.) What do you conclude?</p>
<p>Solution</p>
<p>The company is trying to prove that salaries are <em>increasing</em>
over time, so we need a one-sided alternative.
Following through the procedure, even though you may not trust it much:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" data-line-number="1"><span class="kw">with</span>(salaries, <span class="kw">t.test</span>(jan2016, jan2017, <span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>, <span class="dt">paired=</span>T))</a></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  jan2016 and jan2017
## t = -10.092, df = 19, p-value = 2.271e-09
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##       -Inf -5.125252
## sample estimates:
## mean of the differences 
##                  -6.185</code></pre>
<p>You could also have the years the other way around, in which case the
alternative has to be the other way around as well:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" data-line-number="1"><span class="kw">with</span>(salaries, <span class="kw">t.test</span>(jan2017, jan2016, <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>, <span class="dt">paired=</span>T))</a></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  jan2017 and jan2016
## t = 10.092, df = 19, p-value = 2.271e-09
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  5.125252      Inf
## sample estimates:
## mean of the differences 
##                   6.185</code></pre>
<p>Or, if you saved the data frame with the differences in it, do a
one-sample test on those, again making sure that you get the
<code>alternative</code> right. I didn’t save it, so I’m calculating the
differences again:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" data-line-number="1">salaries <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb551-2" data-line-number="2"><span class="kw">mutate</span>(<span class="dt">diff=</span>jan2017<span class="op">-</span>jan2016) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb551-3" data-line-number="3"><span class="kw">with</span>(.,<span class="kw">t.test</span>(diff, <span class="dt">mu=</span><span class="dv">0</span>, <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>))</a></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  diff
## t = 10.092, df = 19, p-value = 2.271e-09
## alternative hypothesis: true mean is greater than 0
## 95 percent confidence interval:
##  5.125252      Inf
## sample estimates:
## mean of x 
##     6.185</code></pre>
<p>Whichever way you do it, the P-value is the same <span class="math inline">\(2.271 \times 10^{-9}\)</span>, which is a whole lot less than 0.05, so there is no doubt at
all that salaries are increasing.</p>
<p>(Your intuition ought to have expected something like this, because
everyone’s 2017 salary appears to be greater than their 2016 salary.)</p>
<p>Extra: you might be feeling that we ought to be doing a matched-pairs
sign test, which you could do this way:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb553-1" data-line-number="1"><span class="kw">library</span>(smmr)</a>
<a class="sourceLine" id="cb553-2" data-line-number="2">salaries <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb553-3" data-line-number="3"><span class="kw">mutate</span>(<span class="dt">diff=</span>jan2017<span class="op">-</span>jan2016) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb553-4" data-line-number="4"><span class="kw">sign_test</span>(diff,<span class="dv">0</span>)</a></code></pre></div>
<pre><code>## $above_below
## below above 
##     0    20 
## 
## $p_values
##   alternative      p_value
## 1       lower 1.000000e+00
## 2       upper 9.536743e-07
## 3   two-sided 1.907349e-06</code></pre>
<p>and then take the “upper” P-value, which is in the same ballpark as
the one from the <span class="math inline">\(t\)</span>-test. So the salaries really are increasing,
whether you believe the <span class="math inline">\(t\)</span>-test or not. And note that .</p>
<p>(Again, the “missing” data frame in <code>sign_test</code> is the nameless
one with the differences in it.)</p>
<p>(e)[2] The company would like to estimate  salaries are increasing, on average. Obtain some output that
will enable the company to assess this, and tell the CEO which piece
of the output they should look at.</p>
<p>Solution</p>
<p>A confidence interval. 95% is fine. As before, we have to run
<code>t.test</code> again because we ran a one-sided test and a
confidence interval for us is two-sided:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb555-1" data-line-number="1"><span class="kw">with</span>(salaries, <span class="kw">t.test</span>(jan2017, jan2016, <span class="dt">paired=</span>T))</a></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  jan2017 and jan2016
## t = 10.092, df = 19, p-value = 4.542e-09
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  4.902231 7.467769
## sample estimates:
## mean of the differences 
##                   6.185</code></pre>
<p>Between about $5,000 and about $7,500. This is what to tell the CEO.</p>
<p>% Body fat revisited</p>
<p>Athletes are concerned with measuring their body fat
percentage. Two different methods are available: one using ultrasound,
and the other using X-ray technology. We are interested in whether
there is a difference in the mean body fat percentage as measured by
these two methods, and if so, how big that difference is. Data on 16
athletes are at
<a href="http://www.utsc.utoronto.ca/~butler/c32/bodyfat.txt" class="uri">http://www.utsc.utoronto.ca/~butler/c32/bodyfat.txt</a>.</p>
<p>We saw this data set before.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data again.</li>
</ol>
<p>Solution</p>
<p>This kind of thing. Since you looked at the data (didn’t you?),
you’ll know that the values are separated by single spaces:</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" data-line-number="1">myurl=<span class="st">&quot;http://www.utsc.utoronto.ca/~butler/c32/bodyfat.txt&quot;</span></a>
<a class="sourceLine" id="cb557-2" data-line-number="2">bodyfat=<span class="kw">read_delim</span>(myurl,<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   athlete = col_integer(),
##   xray = col_double(),
##   ultrasound = col_double()
## )</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" data-line-number="1">bodyfat  </a></code></pre></div>
<pre><code>## # A tibble: 16 x 3
##    athlete  xray ultrasound
##      &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;
##  1       1  5          4.75
##  2       2  7          3.75
##  3       3  9.25       9   
##  4       4 12         11.8 
##  5       5 17.2       17   
##  6       6 29.5       27.5 
##  7       7  5.5        6.5 
##  8       8  6          6.75
##  9       9  8          8.75
## 10      10  8.5        9.5 
## 11      11  9.25       9.5 
## 12      12 11         12   
## 13      13 12         12.2 
## 14      14 14         15.5 
## 15      15 17         18   
## 16      16 18         18.2</code></pre>
<p>%%%</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Calculate the differences, and make a normal quantile plot of
them. Is there any evidence that normality of differences fails?
Explain briefly.</li>
</ol>
<p>Solution</p>
<p>This is a good place to look ahead. We’ll need the differences in two
places, most likely: first for the normal quantile plot, and second
for the matched-pairs sign test. So we should calculate and save them first:</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" data-line-number="1">bodyfat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">diff=</span>xray<span class="op">-</span>ultrasound) -&gt;<span class="st"> </span>bodyfat2</a></code></pre></div>
<p>I seem to be using a 2 on the end to name my
dataframe-with-differences, but you can use whatever name you like.</p>
<p>Then, not forgetting to use the data frame that we just made:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" data-line-number="1"><span class="kw">ggplot</span>(bodyfat2,<span class="kw">aes</span>(<span class="dt">sample=</span>diff))<span class="op">+</span><span class="kw">stat_qq</span>()<span class="op">+</span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="08-matched-pairs-sign_files/figure-html/unnamed-chunk-25-1.png" width="672"  />
This is showing a little evidence of skewness or outliers (depending
on your point of view: either is good). The lowest and highest values
are both too high, and the pattern of points on the plot is kind of
curved (which would be evidence of skewness). Or you could say that
the two highest values are too high, with the other values being more
or less in line (that would be evidence of outliers at the upper
end). I like outliers better than skewness, since those bottom-end
points are not far off the line. I would also accept ``no substantial
problems’’, if you can make the case that those two highest points are
not too far off the line. With only 16 observations as we have here,
even truly normal data would stray off the line a bit.</p>
<p>As ever, your explanation is more important than your conclusion. Can
you justify what you think?</p>
<p>If you took your differences the other way around, as
<code>ultrasound</code> minus <code>xray</code>, your plot will also be the
other way around, with the “outliers” at the bottom. That’s good
too.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Previously, we did a matched-pairs <span class="math inline">\(t\)</span>-test for these data. In
the light of your normal quantile plot, do you think that was a good
idea? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>We are looking for the differences to be approximately normal,
bearing in mind that we have a sample of size 16, which is not
that large. Say what you think here; the points, if I were giving
any here, would be for the way in which you support it.
The comment I made before when we did a matched-pairs <span class="math inline">\(t\)</span>-test
was that the P-value was so large and non-significant that it was
hard to imagine any other test giving a significant
result. Another way of saying that is that I considered these
differences to be “normal enough”, given the circumstances.
You might very well take a different view. You could say that
these differences are clearly not normal, and that the sample size
of 16 is not large enough to get any substantial help from the
Central Limit Theorem. From that point of view, running the
<span class="math inline">\(t\)</span>-test is clearly not advisable.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Use the sign test appropriately to compare the two methods for
measuring body fat. (Use <code>smmr</code> if you wish.) What do you
conclude, as ever in the context of the data?</li>
</ol>
<p>Solution</p>
<p>That means using a sign test to test the null hypothesis that the
median difference is zero, against the alternative that it is not
zero. (I don’t see anything here to indicate that we are looking only
for positive or only for negative differences, so I think two-sided is
right. You need some reason to do a one-sided test, and there isn’t
one here.)</p>
<p>Remembering again to use the data frame that has the differences in it:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" data-line-number="1"><span class="kw">sign_test</span>(bodyfat2, diff, <span class="dv">0</span>)</a></code></pre></div>
<pre><code>## $above_below
## below above 
##    10     6 
## 
## $p_values
##   alternative   p_value
## 1       lower 0.2272491
## 2       upper 0.8949432
## 3   two-sided 0.4544983</code></pre>
<p>The two-sided P-value is 0.4545, so we are nowhere near rejecting the
null hypothesis that the median difference is zero. There is no
evidence that the two methods for measuring body fat show any
difference on average.</p>
<p>The table of aboves and belows says that there were 6 positive
differences and 10 negative ones. This is not far from an even split,
so the lack of significance is entirely what we would expect.</p>
<p>Extra: this is the same conclusion that we drew the last time we
looked at these data (with a matched-pairs <span class="math inline">\(t\)</span>-test). That supports
what I said then, which is that the <span class="math inline">\(t\)</span>-test was so far from being
significant, that it could be very wrong without changing the
conclusion. That is what seems to have happened.</p>

</div>
</div>
<p style="text-align: center;">
<a href="the-sign-test-and-moods-median-test.html"><button class="btn btn-default">Previous</button></a>
<a href="normal-quantile-plots.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 40 Factor Analysis | Problems and Solutions in Applied Statistics</title>
  <meta name="description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 40 Factor Analysis | Problems and Solutions in Applied Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://ritsokiguess.site/pasias" />
  
  <meta property="og:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  <meta name="github-repo" content="nxskok/pasias" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 40 Factor Analysis | Problems and Solutions in Applied Statistics" />
  
  <meta name="twitter:description" content="A set of problems and solutions, in R, on various parts of applied statistics" />
  

<meta name="author" content="Ken Butler" />


<meta name="date" content="2021-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="principal-components.html"/>
<link rel="next" href="frequency-table-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Problems and Solutions in Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages-used-somewhere-in-this-book"><i class="fa fa-check"></i>Packages used somewhere in this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>1</b> Getting used to R and R Studio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#running-r-studio-on-jupyterhub"><i class="fa fa-check"></i><b>1.1</b> Running R Studio on Jupyterhub</a></li>
<li class="chapter" data-level="1.2" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-an-r-studio-cloud-account"><i class="fa fa-check"></i><b>1.2</b> Getting an R Studio Cloud account</a></li>
<li class="chapter" data-level="1.3" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a></li>
<li class="chapter" data-level="1.4" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-data-from-a-file"><i class="fa fa-check"></i><b>1.4</b> Reading data from a file</a></li>
<li class="chapter" data-level="1.5" data-path="getting-used-to-r-and-r-studio.html"><a href="getting-used-to-r-and-r-studio.html#reading-files-different-ways"><i class="fa fa-check"></i><b>1.5</b> Reading files different ways</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-in-data.html"><a href="reading-in-data.html"><i class="fa fa-check"></i><b>2</b> Reading in data</a></li>
<li class="chapter" data-level="3" data-path="drawing-graphs.html"><a href="drawing-graphs.html"><i class="fa fa-check"></i><b>3</b> Drawing graphs</a></li>
<li class="chapter" data-level="4" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>4</b> Data exploration</a></li>
<li class="chapter" data-level="5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>5</b> Working with dataframes</a></li>
<li class="chapter" data-level="6" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>6</b> One-sample inference</a></li>
<li class="chapter" data-level="7" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>7</b> Two-sample inference</a></li>
<li class="chapter" data-level="8" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>8</b> Power and sample size</a></li>
<li class="chapter" data-level="9" data-path="the-sign-test.html"><a href="the-sign-test.html"><i class="fa fa-check"></i><b>9</b> The sign test</a></li>
<li class="chapter" data-level="10" data-path="mood-median-test.html"><a href="mood-median-test.html"><i class="fa fa-check"></i><b>10</b> Mood median test</a></li>
<li class="chapter" data-level="11" data-path="matched-pairs-t-and-sign-test.html"><a href="matched-pairs-t-and-sign-test.html"><i class="fa fa-check"></i><b>11</b> Matched pairs t and sign test</a></li>
<li class="chapter" data-level="12" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html"><i class="fa fa-check"></i><b>12</b> Normal quantile plots</a><ul>
<li class="chapter" data-level="12.1" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers"><i class="fa fa-check"></i><b>12.1</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.2" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality"><i class="fa fa-check"></i><b>12.2</b> Ferritin and normality</a></li>
<li class="chapter" data-level="12.3" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#lengths-of-heliconia-flowers-1"><i class="fa fa-check"></i><b>12.3</b> Lengths of heliconia flowers</a></li>
<li class="chapter" data-level="12.4" data-path="normal-quantile-plots.html"><a href="normal-quantile-plots.html#ferritin-and-normality-1"><i class="fa fa-check"></i><b>12.4</b> Ferritin and normality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>13</b> Analysis of variance</a></li>
<li class="chapter" data-level="14" data-path="writing-reports.html"><a href="writing-reports.html"><i class="fa fa-check"></i><b>14</b> Writing reports</a></li>
<li class="chapter" data-level="15" data-path="learning-to-code.html"><a href="learning-to-code.html"><i class="fa fa-check"></i><b>15</b> Learning to code</a><ul>
<li class="chapter" data-level="15.1" data-path="learning-to-code.html"><a href="learning-to-code.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="learning-to-code.html"><a href="learning-to-code.html#data-and-pre-processing"><i class="fa fa-check"></i><b>15.2</b> Data and pre-processing</a></li>
<li class="chapter" data-level="15.3" data-path="learning-to-code.html"><a href="learning-to-code.html#analysis"><i class="fa fa-check"></i><b>15.3</b> Analysis</a></li>
<li class="chapter" data-level="15.4" data-path="learning-to-code.html"><a href="learning-to-code.html#conclusions-see-note-9"><i class="fa fa-check"></i><b>15.4</b> Conclusions (see note 9)</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="treating-dandruff.html"><a href="treating-dandruff.html"><i class="fa fa-check"></i><b>16</b> Treating dandruff</a><ul>
<li class="chapter" data-level="16.1" data-path="treating-dandruff.html"><a href="treating-dandruff.html#introduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="treating-dandruff.html"><a href="treating-dandruff.html#exploratory-analysis"><i class="fa fa-check"></i><b>16.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="16.3" data-path="treating-dandruff.html"><a href="treating-dandruff.html#analysis-of-variance-1"><i class="fa fa-check"></i><b>16.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="16.4" data-path="treating-dandruff.html"><a href="treating-dandruff.html#assessment-of-assumptions"><i class="fa fa-check"></i><b>16.4</b> Assessment of Assumptions</a></li>
<li class="chapter" data-level="16.5" data-path="treating-dandruff.html"><a href="treating-dandruff.html#conclusions"><i class="fa fa-check"></i><b>16.5</b> Conclusions</a></li>
<li class="chapter" data-level="16.6" data-path="treating-dandruff.html"><a href="treating-dandruff.html#end"><i class="fa fa-check"></i><b>16.6</b> End</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>17</b> Tidying data</a></li>
<li class="chapter" data-level="18" data-path="simple-regression.html"><a href="simple-regression.html"><i class="fa fa-check"></i><b>18</b> Simple regression</a></li>
<li class="chapter" data-level="19" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>19</b> Multiple regression</a></li>
<li class="chapter" data-level="20" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html"><i class="fa fa-check"></i><b>20</b> Regression with categorical variables</a><ul>
<li class="chapter" data-level="20.1" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited"><i class="fa fa-check"></i><b>20.1</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.2" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching"><i class="fa fa-check"></i><b>20.2</b> Pulse rates and marching</a></li>
<li class="chapter" data-level="20.3" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#crickets-revisited-1"><i class="fa fa-check"></i><b>20.3</b> Crickets revisited</a></li>
<li class="chapter" data-level="20.4" data-path="regression-with-categorical-variables.html"><a href="regression-with-categorical-variables.html#pulse-rates-and-marching-1"><i class="fa fa-check"></i><b>20.4</b> Pulse rates and marching</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>21</b> Dates and times</a></li>
<li class="chapter" data-level="22" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>22</b> Functions</a></li>
<li class="chapter" data-level="23" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html"><i class="fa fa-check"></i><b>23</b> Vector and matrix algebra</a><ul>
<li class="chapter" data-level="23.1" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again"><i class="fa fa-check"></i><b>23.1</b> Heights and foot lengths again</a></li>
<li class="chapter" data-level="23.2" data-path="vector-and-matrix-algebra.html"><a href="vector-and-matrix-algebra.html#heights-and-foot-lengths-again-1"><i class="fa fa-check"></i><b>23.2</b> Heights and foot lengths again</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>24</b> The Bootstrap</a></li>
<li class="chapter" data-level="25" data-path="bayesian-statistics-with-stan.html"><a href="bayesian-statistics-with-stan.html"><i class="fa fa-check"></i><b>25</b> Bayesian Statistics with Stan</a></li>
<li class="chapter" data-level="26" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>26</b> Logistic regression</a></li>
<li class="chapter" data-level="27" data-path="logistic-regression-with-ordinal-response.html"><a href="logistic-regression-with-ordinal-response.html"><i class="fa fa-check"></i><b>27</b> Logistic regression with ordinal response</a></li>
<li class="chapter" data-level="28" data-path="logistic-regression-with-nominal-response.html"><a href="logistic-regression-with-nominal-response.html"><i class="fa fa-check"></i><b>28</b> Logistic regression with nominal response</a></li>
<li class="chapter" data-level="29" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>29</b> Survival analysis</a></li>
<li class="chapter" data-level="30" data-path="analysis-of-variance-revisited.html"><a href="analysis-of-variance-revisited.html"><i class="fa fa-check"></i><b>30</b> Analysis of variance revisited</a></li>
<li class="chapter" data-level="31" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>31</b> Analysis of covariance</a></li>
<li class="chapter" data-level="32" data-path="multivariate-analysis-of-variance.html"><a href="multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>32</b> Multivariate analysis of variance</a></li>
<li class="chapter" data-level="33" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i><b>33</b> Repeated measures</a></li>
<li class="chapter" data-level="34" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>34</b> Discriminant analysis</a></li>
<li class="chapter" data-level="35" data-path="hierarchical-cluster-analysis.html"><a href="hierarchical-cluster-analysis.html"><i class="fa fa-check"></i><b>35</b> Hierarchical cluster analysis</a></li>
<li class="chapter" data-level="36" data-path="k-means-cluster-analysis.html"><a href="k-means-cluster-analysis.html"><i class="fa fa-check"></i><b>36</b> K-means cluster analysis</a></li>
<li class="chapter" data-level="37" data-path="drawing-maps-with-leaflet.html"><a href="drawing-maps-with-leaflet.html"><i class="fa fa-check"></i><b>37</b> Drawing maps with Leaflet</a></li>
<li class="chapter" data-level="38" data-path="multidimensional-scaling.html"><a href="multidimensional-scaling.html"><i class="fa fa-check"></i><b>38</b> Multidimensional Scaling</a></li>
<li class="chapter" data-level="39" data-path="principal-components.html"><a href="principal-components.html"><i class="fa fa-check"></i><b>39</b> Principal Components</a><ul>
<li class="chapter" data-level="39.1" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere"><i class="fa fa-check"></i><b>39.1</b> The weather, somewhere</a></li>
<li class="chapter" data-level="39.2" data-path="principal-components.html"><a href="principal-components.html#the-weather-somewhere-1"><i class="fa fa-check"></i><b>39.2</b> The weather, somewhere</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>40</b> Factor Analysis</a><ul>
<li class="chapter" data-level="40.1" data-path="factor-analysis.html"><a href="factor-analysis.html#the-interpersonal-circumplex"><i class="fa fa-check"></i><b>40.1</b> The Interpersonal Circumplex</a></li>
<li class="chapter" data-level="40.2" data-path="factor-analysis.html"><a href="factor-analysis.html#a-correlation-matrix"><i class="fa fa-check"></i><b>40.2</b> A correlation matrix</a></li>
<li class="chapter" data-level="40.3" data-path="factor-analysis.html"><a href="factor-analysis.html#air-pollution"><i class="fa fa-check"></i><b>40.3</b> Air pollution</a></li>
<li class="chapter" data-level="40.4" data-path="factor-analysis.html"><a href="factor-analysis.html#the-interpersonal-circumplex-1"><i class="fa fa-check"></i><b>40.4</b> The Interpersonal Circumplex</a></li>
<li class="chapter" data-level="40.5" data-path="factor-analysis.html"><a href="factor-analysis.html#a-correlation-matrix-1"><i class="fa fa-check"></i><b>40.5</b> A correlation matrix</a></li>
<li class="chapter" data-level="40.6" data-path="factor-analysis.html"><a href="factor-analysis.html#air-pollution-1"><i class="fa fa-check"></i><b>40.6</b> Air pollution</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="frequency-table-analysis.html"><a href="frequency-table-analysis.html"><i class="fa fa-check"></i><b>41</b> Frequency table analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Problems and Solutions in Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factor-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 40</span> Factor Analysis</h1>
<p>Packages for this chapter:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1"><span class="kw">library</span>(ggbiplot)</a>
<a class="sourceLine" id="cb287-2" title="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="the-interpersonal-circumplex" class="section level2">
<h2><span class="header-section-number">40.1</span> The Interpersonal Circumplex</h2>
<p>The “IPIP Interpersonal Circumplex” (see
<a href="http://ipip.ori.org/newIPIP-IPCSurvey.htm">link</a>) is a personal
behaviour survey, where respondents have to rate how accurately a
number of statements about behaviour apply to them, on a scale from
1 (“very inaccurate”) to 5 (“very accurate”). A survey was done
on 459 people, using a 44-item variant of the above questionnaire,
where the statements were as follows. Put an “I” or an “I am” in
front of each one:</p>
<ul>
<li><p>talkative</p></li>
<li><p>find fault</p></li>
<li><p>do a thorough job</p></li>
<li><p>depressed</p></li>
<li><p>original</p></li>
<li><p>reserved</p></li>
<li><p>helpful</p></li>
<li><p>careless</p></li>
<li><p>relaxed</p></li>
<li><p>curious</p></li>
<li><p>full of energy</p></li>
<li><p>start quarrels</p></li>
<li><p>reliable</p></li>
<li><p>tense</p></li>
<li><p>ingenious</p></li>
<li><p>generate enthusiasm in others</p></li>
<li><p>forgiving</p></li>
<li><p>disorganized</p></li>
<li><p>worry</p></li>
<li><p>imaginative</p></li>
<li><p>quiet</p></li>
<li><p>trusting</p></li>
<li><p>lazy</p></li>
<li><p>emotionally stable</p></li>
<li><p>inventive</p></li>
<li><p>assertive</p></li>
<li><p>cold and aloof</p></li>
<li><p>persevere</p></li>
<li><p>moody</p></li>
<li><p>value artistic experiences</p></li>
<li><p>shy</p></li>
<li><p>considerate</p></li>
<li><p>efficient</p></li>
<li><p>calm in tense situations</p></li>
<li><p>prefer routine work</p></li>
<li><p>outgoing</p></li>
<li><p>sometimes rude</p></li>
<li><p>stick to plans</p></li>
<li><p>nervous</p></li>
<li><p>reflective</p></li>
<li><p>have few artistic interests</p></li>
<li><p>co-operative</p></li>
<li><p>distractible</p></li>
<li><p>sophisticated in art and music</p></li>
</ul>
<p>I don’t know what a “circumplex” is, but I know it’s not one of those “hat” accents that they have in French.
The data are in
<a href="http://ritsokiguess.site/datafiles/personality.txt">link</a>. The
columns <code>PERS01</code> through <code>PERS44</code> represent the above traits.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data and check that you have the right number
of rows and columns.</p></li>
<li><p>There are some missing values among these
responses. Eliminate all the individuals with any missing values
(since <code>princomp</code> can’t handle them).</p></li>
<li><p>Carry out a principal components analysis and obtain a
scree plot.</p></li>
<li><p>How many components/factors should you use? Explain briefly.</p></li>
<li><p><a name="part:score">*</a> Using your preferred number of factors, run a factor
analysis. Obtain “r”-type factor scores, as in class. You don’t need to look at any output yet.</p></li>
<li><p>Obtain the factor loadings. How much of the variability
does your chosen number of factors explain?</p></li>
<li><p>Interpret each of your chosen number of factors. That is,
for each factor, identify the items that load heavily on it (you
can be fairly crude about this, eg. use a cutoff like 0.4 in
absolute value), and translate these items into the statements
given in each item. Then, if you can, name what the items loading
heavily on each factor have in common. Interpret a negative
loading as “not” whatever the item says.</p></li>
<li><p>Find a person who is extreme on each of your first three
factors (one at a time). For each of these people, what kind of
data should they have for the relevant ones of variables
<code>PERS01</code> through <code>PERS44</code>? Do they? Explain
reasonably briefly.</p></li>
<li><p>Check the uniquenesses. Which one(s) seem unusually
high? Check these against the factor loadings. Are these what you
would expect?</p></li>
</ol>
</div>
<div id="a-correlation-matrix" class="section level2">
<h2><span class="header-section-number">40.2</span> A correlation matrix</h2>
<p>Here is a correlation matrix between five variables. This
correlation matrix was based on <span class="math inline">\(n=50\)</span> observations. Save the data
into a file.</p>
<pre><code>
1.00 0.90 -0.40 0.28 -0.05
0.90 1.00 -0.60 0.43 -0.20
-0.40 -0.60 1.00 -0.80 0.40
0.28 0.43 -0.80 1.00 -0.70
-0.05 -0.20 0.40 -0.70 1.00
</code></pre>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data, using <code>col_names=F</code> (why?). Check that you
have five variables with names invented by R.</p></li>
<li><p>Run a principal components analysis from this correlation matrix.</p></li>
<li><p><a name="part:howmany">*</a> Obtain a scree plot. Can you justify
the use of two components (later, factors), bearing in mind that we
have only five variables?</p></li>
<li><p>Take a look at the first two component loadings. Which variables appear
to feature in which component? Do they have a positive or negative effect?</p></li>
<li><p>Create a “covariance list” (for the purposes of
performing a factor analysis on the correlation matrix).</p></li>
<li><p>Carry out a factor analysis with two factors. We’ll
investigate the bits of it in a
moment.</p></li>
<li><p><a name="part:load">*</a> Look at the factor loadings. Describe how the factors are
related to the original variables. Is the interpretation clearer
than for the principal components analysis?</p></li>
<li><p>Look at the uniquenesses. Are there any that are unusually
high? Does that surprise you, given your answer to
(<a href="#part:load">here</a>)? (You will probably have to make a judgement call here.)</p></li>
</ol>
</div>
<div id="air-pollution" class="section level2">
<h2><span class="header-section-number">40.3</span> Air pollution</h2>
<p>The data in
<a href="http://ritsokiguess.site/datafiles/airpollution.csv">link</a> are
measurements of air-pollution variables recorded at 12 noon on 42
different days at a location in Los Angeles. The file is in
<code>.csv</code> format, since it came from a spreadsheet. Specifically,
the variables (in suitable units), in the same order as in the data
file, are:</p>
<ul>
<li><p>wind speed</p></li>
<li><p>solar radiation</p></li>
<li><p>carbon monoxide</p></li>
<li><p>Nitric oxide (also known as nitrogen monoxide)</p></li>
<li><p>Nitrogen dioxide</p></li>
<li><p>Ozone</p></li>
<li><p>Hydrocarbons</p></li>
</ul>
<p>The aim is to describe pollution using fewer than these seven variables.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Read in the data and demonstrate that you have the right
number of rows and columns in your data frame.</p></li>
<li><p><a name="part:fivenum">*</a>
Obtain a five-number summary for each variable. You can do this in
one go for all seven variables.</p></li>
<li><p>Obtain a principal components analysis. Do it on the
correlation matrix, since the variables are measured on different
scales. You don’t need to look at the results yet.</p></li>
<li><p>Obtain a scree plot. How many principal components might be
worth looking at? Explain briefly. (There might be more than one
possibility. If so, discuss them all.)</p></li>
<li><p>Look at the <code>summary</code> of the principal components
object. What light does this shed on the choice of number of
components? Explain briefly.</p></li>
<li><p><a name="part:preferred">*</a> How do each of your preferred number of components depend
on the variables that were measured? Explain briefly.</p></li>
<li><p>Make a data frame that contains (i) the original data, (ii) a column of row numbers, (iii) the principal component scores. Display some of it.</p></li>
<li><p>Display the row of your new data frame for the observation
with the smallest (most negative) score on component 1. Which row is
this? What makes this observation have the most negative score on
component 1?</p></li>
<li><p>Which observation has the lowest (most negative) value on
component 2? Which variables ought to be high or low for this
observation? Are they? Explain briefly.</p></li>
<li><p>Obtain a biplot, with the row numbers labelled, and explain briefly how your conclusions from the previous two parts are consistent with it.</p></li>
<li><p>Run a factor analysis on the same data, obtaining two factors. Look at the factor loadings. Is it clearer which variables belong to which factor, compared to the principal components analysis? Explain briefly.</p></li>
</ol>
<p>My solutions follow:</p>
</div>
<div id="the-interpersonal-circumplex-1" class="section level2">
<h2><span class="header-section-number">40.4</span> The Interpersonal Circumplex</h2>
<p>The “IPIP Interpersonal Circumplex” (see
<a href="http://ipip.ori.org/newIPIP-IPCSurvey.htm">link</a>) is a personal
behaviour survey, where respondents have to rate how accurately a
number of statements about behaviour apply to them, on a scale from
1 (“very inaccurate”) to 5 (“very accurate”). A survey was done
on 459 people, using a 44-item variant of the above questionnaire,
where the statements were as follows. Put an “I” or an “I am” in
front of each one:</p>
<ul>
<li><p>talkative</p></li>
<li><p>find fault</p></li>
<li><p>do a thorough job</p></li>
<li><p>depressed</p></li>
<li><p>original</p></li>
<li><p>reserved</p></li>
<li><p>helpful</p></li>
<li><p>careless</p></li>
<li><p>relaxed</p></li>
<li><p>curious</p></li>
<li><p>full of energy</p></li>
<li><p>start quarrels</p></li>
<li><p>reliable</p></li>
<li><p>tense</p></li>
<li><p>ingenious</p></li>
<li><p>generate enthusiasm in others</p></li>
<li><p>forgiving</p></li>
<li><p>disorganized</p></li>
<li><p>worry</p></li>
<li><p>imaginative</p></li>
<li><p>quiet</p></li>
<li><p>trusting</p></li>
<li><p>lazy</p></li>
<li><p>emotionally stable</p></li>
<li><p>inventive</p></li>
<li><p>assertive</p></li>
<li><p>cold and aloof</p></li>
<li><p>persevere</p></li>
<li><p>moody</p></li>
<li><p>value artistic experiences</p></li>
<li><p>shy</p></li>
<li><p>considerate</p></li>
<li><p>efficient</p></li>
<li><p>calm in tense situations</p></li>
<li><p>prefer routine work</p></li>
<li><p>outgoing</p></li>
<li><p>sometimes rude</p></li>
<li><p>stick to plans</p></li>
<li><p>nervous</p></li>
<li><p>reflective</p></li>
<li><p>have few artistic interests</p></li>
<li><p>co-operative</p></li>
<li><p>distractible</p></li>
<li><p>sophisticated in art and music</p></li>
</ul>
<p>I don’t know what a “circumplex” is, but I know it’s not one of those “hat” accents that they have in French.
The data are in
<a href="http://ritsokiguess.site/datafiles/personality.txt">link</a>. The
columns <code>PERS01</code> through <code>PERS44</code> represent the above traits.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and check that you have the right number
of rows and columns.</li>
</ol>
<p>Solution</p>
<p>Separated by single spaces.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/personality.txt&quot;</span></a>
<a class="sourceLine" id="cb289-2" title="2">pers &lt;-<span class="st"> </span><span class="kw">read_delim</span>(my_url, <span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1">pers</a></code></pre></div>
<pre><code>## # A tibble: 459 x 45
##       id PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17 PERS18 PERS19 PERS20 PERS21 PERS22 PERS23
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1     1      5      4      5      1      4      3      3      1      2      3      2      4      5      4      4      3      5      1      3      4      2      4      2
##  2     2      1      1      5      2      1      2      5      1      5      1      5      3      5      4      1      2      1      3      5      1      5      5      1
##  3     3      4      1      5      3      3      4      5      3      1      4      2      1      5      4      3      2      5      1      5      4      4      4      3
##  4     4      4      2      5      1      4      3      4      4      4      5      4      1      4      5      3      3      4      2      5      4      4      4      3
##  5     5      2      3      5      1      2      4      5      2      3      3      4      2      5      3      3      3      5      1      4      2      5      5      1
##  6     6      1      1      5      4      3      4      4      2      1      4      3      3      5      5      3      2      4      1      5      3      5      4      1
##  7     7      3      2      5      1      2      1      1      2      5      4      4      1      5      1      1      4      5      5      1      3      2      5      1
##  8     8      5      2      4      2      4      1      4      3      3      5      4      1      4      3      2      4      4      4      2      5      2      4      3
##  9     9      5      1      4      3      2      1      4      4      2      3      4      1      4      4      2      5      5      5      4      4      2      5      2
## 10    10      4      1      5      1      4      3      4      1      5      4      5      1      5      3      4      4      4      1      1      5      2      4      1
## # … with 449 more rows, and 21 more variables: PERS24 &lt;dbl&gt;, PERS25 &lt;dbl&gt;,
## #   PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;, PERS30 &lt;dbl&gt;,
## #   PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;, PERS35 &lt;dbl&gt;,
## #   PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;, PERS40 &lt;dbl&gt;,
## #   PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;</code></pre>
<p>Yep, 459 people (in rows), and 44 items (in columns), plus one column
of <code>id</code>s for the people who took the survey.</p>
<p>In case you were wondering about the “I” vs. “I am” thing, the
story seems to be that each behaviour needs to have a verb. If the
behaviour has a verb, “I” is all you need, but if it doesn’t, you
have to add one, ie. “I am”.</p>
<p>Another thing you might be concerned about is whether these data are
“tidy” or not. To some extent, it depends on what you are going to
do with it. You could say that the <code>PERS</code> columns are all
survey-responses, just to different questions, and you might think of
doing something like this:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">pers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="op">-</span>id, <span class="dt">names_to=</span><span class="st">&quot;item&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 20,196 x 3
##       id item   response
##    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1     1 PERS01        5
##  2     1 PERS02        4
##  3     1 PERS03        5
##  4     1 PERS04        1
##  5     1 PERS05        4
##  6     1 PERS06        3
##  7     1 PERS07        3
##  8     1 PERS08        1
##  9     1 PERS09        2
## 10     1 PERS10        3
## # … with 20,186 more rows</code></pre>
<p>to get a <em>really</em> long and skinny data frame. It all depends on
what you are doing with it. Long-and-skinny is ideal if you are going
to summarize the responses by survey item, or draw something like bar
charts of responses facetted by item:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1">pers <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb295-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>id, <span class="dt">names_to=</span><span class="st">&quot;item&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;response&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb295-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> response)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>item)</a></code></pre></div>
<pre><code>## Warning: Removed 371 rows containing non-finite values (stat_count).</code></pre>
<p><img src="pasias_files/figure-html/derhuter-1.png" width="672" /></p>
<p>The first time I did this, item <code>PERS36</code> appeared out of order
at the end, and I was wondering what happened, until I realized it was
actually misspelled as <code>PES36</code>! I corrected it in the data
file, and it should be good now (though I wonder how many years that
error persisted for).</p>
<p>For us, in this problem, though, we need the wide format.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>There are some missing values among these
responses. Eliminate all the individuals with any missing values
(since <code>princomp</code> can’t handle them).</li>
</ol>
<p>Solution</p>
<p>This is actually much easier than it was in the past.
A way of asking “are there any missing values anywhere?” is:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1"><span class="kw">any</span>(<span class="kw">is.na</span>(pers))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>There are.
To remove them, just this:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1">pers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>() -&gt;<span class="st"> </span>pers.ok</a></code></pre></div>
<p>Are there any missings left?</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="kw">any</span>(<span class="kw">is.na</span>(pers.ok))</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Nope.
Extra: you might also have thought of the “tidy, remove, untidy”
strategy here. The trouble with that here is that you want to remove
<em>all</em> the observations for a subject who has <em>any</em> missing
ones. This is unlike the multidimensional scaling one where
we wanted to remove all the distances for two cities <em>that we
knew ahead of time</em>.</p>
<p>That gives me an idea, though.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1">pers <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb302-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>id, <span class="dt">names_to=</span><span class="st">&quot;item&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;rating&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 20,196 x 3
##       id item   rating
##    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1     1 PERS01      5
##  2     1 PERS02      4
##  3     1 PERS03      5
##  4     1 PERS04      1
##  5     1 PERS05      4
##  6     1 PERS06      3
##  7     1 PERS07      3
##  8     1 PERS08      1
##  9     1 PERS09      2
## 10     1 PERS10      3
## # … with 20,186 more rows</code></pre>
<p>To find out which <em>subjects</em> have any missing values, we can do a
<code>group_by</code> and <code>summarize</code> on <em>subjects</em> (that
means, the <code>id</code> column; the <code>PERS</code> in the column I
called <code>item</code> means “personality”, not “person”!). What do
we summarize? Any one of the standard things like <code>mean</code> will
return <code>NA</code> if the thing whose mean you are finding has any NA
values in it anywhere, and a number if it’s “complete”, so this kind
of thing, adding to my pipeline:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1">pers <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb304-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>id, <span class="dt">names_to=</span><span class="st">&quot;item&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;rating&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb304-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">m =</span> <span class="kw">mean</span>(rating)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb304-5" title="5"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(m))</a></code></pre></div>
<pre><code>## # A tibble: 26 x 2
##       id     m
##    &lt;dbl&gt; &lt;dbl&gt;
##  1    12    NA
##  2    40    NA
##  3    45    NA
##  4    49    NA
##  5    52    NA
##  6    58    NA
##  7    79    NA
##  8    84    NA
##  9    96    NA
## 10   159    NA
## # … with 16 more rows</code></pre>
<p>This is different from <code>drop_na</code>, which would remove any rows (of the long data frame) that have a missing response. This, though, is exactly what we <em>don’t</em> want, since we are trying to keep track of the subjects that have missing values.</p>
<p>Most of the subjects had an actual numerical mean here, whose value
we don’t care about; all we care about here is whether the mean is
missing, which implies that one (or more) of the responses was
missing.</p>
<p>So now we define a column <code>has_missing</code> that is true if the
subject has any missing values and false otherwise:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1">pers <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb306-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>id, <span class="dt">names_to=</span><span class="st">&quot;item&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;rating&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb306-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb306-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">m =</span> <span class="kw">mean</span>(rating)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb306-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">has_missing =</span> <span class="kw">is.na</span>(m)) -&gt;<span class="st"> </span>pers.hm</a>
<a class="sourceLine" id="cb306-6" title="6">pers.hm </a></code></pre></div>
<pre><code>## # A tibble: 459 x 3
##       id     m has_missing
##    &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;      
##  1     1  3.41 FALSE      
##  2     2  2.98 FALSE      
##  3     3  3.34 FALSE      
##  4     4  3.55 FALSE      
##  5     5  3.32 FALSE      
##  6     6  3.20 FALSE      
##  7     7  2.84 FALSE      
##  8     8  3.18 FALSE      
##  9     9  3.34 FALSE      
## 10    10  3.18 FALSE      
## # … with 449 more rows</code></pre>
<p>This data frame <code>pers.hm</code> has the same number of rows as the
original data frame <code>pers</code>, one per subject, so we can just
glue it onto the end of that:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1">pers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_cols</span>(pers.hm)</a></code></pre></div>
<pre><code>## New names:
## * id -&gt; id...1
## * id -&gt; id...46</code></pre>
<pre><code>## # A tibble: 459 x 48
##    id...1 PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17 PERS18 PERS19 PERS20 PERS21 PERS22 PERS23
##     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1      1      5      4      5      1      4      3      3      1      2      3      2      4      5      4      4      3      5      1      3      4      2      4      2
##  2      2      1      1      5      2      1      2      5      1      5      1      5      3      5      4      1      2      1      3      5      1      5      5      1
##  3      3      4      1      5      3      3      4      5      3      1      4      2      1      5      4      3      2      5      1      5      4      4      4      3
##  4      4      4      2      5      1      4      3      4      4      4      5      4      1      4      5      3      3      4      2      5      4      4      4      3
##  5      5      2      3      5      1      2      4      5      2      3      3      4      2      5      3      3      3      5      1      4      2      5      5      1
##  6      6      1      1      5      4      3      4      4      2      1      4      3      3      5      5      3      2      4      1      5      3      5      4      1
##  7      7      3      2      5      1      2      1      1      2      5      4      4      1      5      1      1      4      5      5      1      3      2      5      1
##  8      8      5      2      4      2      4      1      4      3      3      5      4      1      4      3      2      4      4      4      2      5      2      4      3
##  9      9      5      1      4      3      2      1      4      4      2      3      4      1      4      4      2      5      5      5      4      4      2      5      2
## 10     10      4      1      5      1      4      3      4      1      5      4      5      1      5      3      4      4      4      1      1      5      2      4      1
## # … with 449 more rows, and 24 more variables: PERS24 &lt;dbl&gt;, PERS25 &lt;dbl&gt;,
## #   PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;, PERS30 &lt;dbl&gt;,
## #   PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;, PERS35 &lt;dbl&gt;,
## #   PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;, PERS40 &lt;dbl&gt;,
## #   PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;, id...46 &lt;dbl&gt;,
## #   m &lt;dbl&gt;, has_missing &lt;lgl&gt;</code></pre>
<p>and then filter out the rows for which <code>has_missing</code> is true.
What we did here is really a way of mimicking <code>complete.cases</code>,
which is the way we used to have to do it, before <code>drop_na</code>
came on the scene.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Carry out a principal components analysis and obtain a
scree plot.</li>
</ol>
<p>Solution</p>
<p>This ought to be straightforward, but we’ve got to remember to
use only the columns with actual data in them: that is,
<code>PERS01</code> through <code>PERS44</code>:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1">pers<span class="fl">.1</span> &lt;-<span class="st"> </span>pers.ok <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;PERS&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-3" title="3"><span class="st">  </span><span class="kw">princomp</span>(<span class="dt">cor =</span> T)</a>
<a class="sourceLine" id="cb311-4" title="4"><span class="kw">ggscreeplot</span>(pers<span class="fl">.1</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/saljhsajd-1.png" width="672" /></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>How many components/factors should you use? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>I think the clearest elbow is at 7, so we should use 6
components/factors. You could make a case that the elbow at 6 is
also part of the scree, and therefore you should use 5
components/factors. Another one of those judgement calls.
Ignore the “backwards elbow” at 5: this is
definitely part of the mountain rather than the scree. Backwards
elbows, as you’ll recall, don’t count as elbows anyway.
When I drew this in R Studio, the elbow at 6 was clearer than
the one at 7, so I went with 5 components/factors below.
The other way to go is to take the number of eigenvalues bigger
than 1:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="kw">summary</span>(pers<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## Importance of components:
##                           Comp.1     Comp.2     Comp.3     Comp.4     Comp.5    Comp.6     Comp.7     Comp.8     Comp.9    Comp.10    Comp.11    Comp.12    Comp.13
## Standard deviation     2.6981084 2.04738207 1.74372011 1.59610543 1.50114586 1.2627066 1.14816136 1.10615404 1.07405521 1.02180353 0.98309198 0.97514006 0.94861102
## Proportion of Variance 0.1654497 0.09526758 0.06910363 0.05789892 0.05121452 0.0362370 0.02996078 0.02780856 0.02621806 0.02372915 0.02196522 0.02161132 0.02045143
## Cumulative Proportion  0.1654497 0.26071732 0.32982096 0.38771988 0.43893440 0.4751714 0.50513218 0.53294074 0.55915880 0.58288795 0.60485317 0.62646449 0.64691592
##                           Comp.14    Comp.15    Comp.16    Comp.17    Comp.18    Comp.19   Comp.20    Comp.21    Comp.22    Comp.23    Comp.24    Comp.25    Comp.26
## Standard deviation     0.90832065 0.90680594 0.86798188 0.85762608 0.84515849 0.82819534 0.8123579 0.80910333 0.80435744 0.76594963 0.75946741 0.75434835 0.74494825
## Proportion of Variance 0.01875105 0.01868857 0.01712256 0.01671642 0.01623393 0.01558881 0.0149983 0.01487837 0.01470434 0.01333361 0.01310888 0.01293276 0.01261245
## Cumulative Proportion  0.66566698 0.68435554 0.70147810 0.71819452 0.73442845 0.75001726 0.7650156 0.77989393 0.79459827 0.80793188 0.82104076 0.83397352 0.84658597
##                           Comp.27   Comp.28    Comp.29    Comp.30    Comp.31     Comp.32     Comp.33     Comp.34     Comp.35     Comp.36     Comp.37     Comp.38
## Standard deviation     0.73105470 0.6956473 0.68327155 0.67765233 0.66847179 0.660473737 0.651473777 0.629487724 0.618765271 0.605892700 0.594231727 0.581419871
## Proportion of Variance 0.01214639 0.0109983 0.01061045 0.01043665 0.01015578 0.009914217 0.009645865 0.009005791 0.008701601 0.008343317 0.008025258 0.007682933
## Cumulative Proportion  0.85873236 0.8697307 0.88034111 0.89077776 0.90093355 0.910847763 0.920493629 0.929499420 0.938201021 0.946544338 0.954569596 0.962252530
##                            Comp.39     Comp.40     Comp.41     Comp.42     Comp.43     Comp.44
## Standard deviation     0.568951666 0.560084703 0.547059522 0.524949694 0.490608152 0.456010047
## Proportion of Variance 0.007356955 0.007129429 0.006801685 0.006263004 0.005470372 0.004726026
## Cumulative Proportion  0.969609484 0.976738913 0.983540598 0.989803602 0.995273974 1.000000000</code></pre>
<p>There are actually 10 of these. But if you look at the scree plot,
there really seems to be no reason to take 10 factors rather than,
say, 11 or 12. There are a lot of eigenvalues (standard deviations)
close to (but just below) 1, and no obvious “bargains” in terms of
variance explained: the “cumulative proportion” just keeps going
gradually up.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li><a name="part:score">*</a> Using your preferred number of factors, run a factor
analysis. Obtain “r”-type factor scores, as in class. You don’t need to look at any output yet.</li>
</ol>
<p>Solution</p>
<p>I’m going to do the 5 factors that I preferred the first time I
looked at this. Don’t forget to grab only the appropriate
columns from <code>pers.ok</code>:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1">pers.ok<span class="fl">.1</span> &lt;-<span class="st"> </span>pers.ok <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb314-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;PERS&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb314-3" title="3"><span class="st">  </span><span class="kw">factanal</span>(<span class="dv">5</span>, <span class="dt">scores =</span> <span class="st">&quot;r&quot;</span>)</a></code></pre></div>
<p>If you think 6 is better, you should feel free to use that here.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Obtain the factor loadings. How much of the variability
does your chosen number of factors explain?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1">pers.ok<span class="fl">.1</span><span class="op">$</span>loadings</a></code></pre></div>
<pre><code>## 
## Loadings:
##        Factor1 Factor2 Factor3 Factor4 Factor5
## PERS01  0.130   0.752           0.279         
## PERS02          0.199   0.202  -0.545         
## PERS03  0.677                   0.160   0.126 
## PERS04 -0.143  -0.239   0.528  -0.195         
## PERS05  0.191   0.258  -0.180   0.159   0.520 
## PERS06  0.104  -0.658   0.185  -0.143         
## PERS07  0.313   0.113           0.533   0.130 
## PERS08 -0.558           0.168  -0.173         
## PERS09                 -0.641           0.136 
## PERS10  0.149   0.169                   0.445 
## PERS11  0.106   0.282  -0.224  -0.107   0.271 
## PERS12 -0.157                  -0.404         
## PERS13  0.577                   0.331   0.126 
## PERS14                  0.685  -0.135         
## PERS15  0.133                           0.480 
## PERS16  0.106   0.481                   0.335 
## PERS17                          0.277   0.102 
## PERS18 -0.641                                 
## PERS19         -0.159   0.596   0.109         
## PERS20          0.215   0.103           0.498 
## PERS21         -0.805   0.121                 
## PERS22  0.153   0.175           0.533         
## PERS23 -0.622           0.121  -0.259         
## PERS24          0.135  -0.582           0.153 
## PERS25          0.176  -0.124           0.517 
## PERS26  0.144   0.515  -0.215  -0.260   0.244 
## PERS27         -0.205   0.136  -0.438         
## PERS28  0.623                   0.245   0.132 
## PERS29                  0.477  -0.231         
## PERS30                                  0.500 
## PERS31         -0.619   0.191                 
## PERS32  0.322                   0.553   0.134 
## PERS33  0.622                                 
## PERS34  0.105          -0.566                 
## PERS35         -0.180                  -0.161 
## PERS36          0.675  -0.146   0.118   0.107 
## PERS37 -0.300   0.134          -0.495         
## PERS38  0.521                           0.169 
## PERS39         -0.333   0.530                 
## PERS40                          0.162   0.585 
## PERS41                         -0.171  -0.326 
## PERS42  0.271   0.179           0.552   0.139 
## PERS43 -0.465           0.236  -0.174         
## PERS44                                  0.449 
## 
##                Factor1 Factor2 Factor3 Factor4 Factor5
## SS loadings      3.810   3.740   3.174   2.939   2.627
## Proportion Var   0.087   0.085   0.072   0.067   0.060
## Cumulative Var   0.087   0.172   0.244   0.311   0.370</code></pre>
<p>The Cumulative Var line at the bottom says that our five factors
together have
explained 37% of the variability. This is not great, but is the kind
of thing we have to live with in this kind of analysis (like the
personality one in class).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Interpret each of your chosen number of factors. That is,
for each factor, identify the items that load heavily on it (you
can be fairly crude about this, eg. use a cutoff like 0.4 in
absolute value), and translate these items into the statements
given in each item. Then, if you can, name what the items loading
heavily on each factor have in common. Interpret a negative
loading as “not” whatever the item says.</li>
</ol>
<p>Solution</p>
<p>This is a lot of work, but I figure you should go through it at
least once! If you have some number of factors other than 5,
your results will be different from mine. Keep going as long as
you reasonably can.
Factor 1: 3, 8 (negatively), 13, 18
(negative), 23 (negative), 28, 33, 38 and maybe 43
(negatively). These are: do a thorough job, not-careless,
reliable, not-disorganized, not-lazy, persevere, efficient,
stick to plans, not-distractible. These have the common theme of
paying attention to detail and getting the job done properly.</p>
<p>Factor 2: 1, not-6, 16, not-21, 26, not-31, 36. Talkative,
not-reserved, generates enthusiasm, not-quiet, assertive,
not-shy, outgoing. “Extravert” seems to capture all of those.
Factor 3: 4, not-9, 14, 19, not-24, 29, not-34, 39. Depressed,
not-relaxed, tense, worried, not emotionally stable, moody,
not-calm-when-tense, nervous. “Not happy” or something like that.</p>
<p>Notice how these seem to be jumping in steps of 5? The
psychology scoring of assessments like this is that a person’s
score on some dimension is found by adding up their scores on
certain of the questions and subtracting their scores on others
(“reverse-coded questions”). I’m guessing that these guys have
5 dimensions they are testing for, corresponding presumably to
my five factors. The questionnaire at
<a href="http://ipip.ori.org/newIPIP-IPCScoringKey.htm">link</a> is
different, but you see the same idea there. (The jumps there seem to
be in steps of 8, since they have 8 dimensions.)</p>
<p>Factor 4: not-2, 7, not-12 (just), 22, not-27, 32, not-37,
42. Doesn’t find fault, helpful, doesn’t start quarrels,
trusting, not-cold-and-aloof, considerate, not-sometimes-rude,
co-operative. “Helps without judgement” or similar.</p>
<p>Factor 5: 5, 10, 15, 20, 25, 30, 40, 44. Original, curious,
ingenious, imaginative, inventive, values artistic experiences,
reflective, sophisticated in art and music. Creative.</p>
<p>I remembered that psychologists like to talk about the “big 5”
personality traits. These are extraversion (factor 2 here),
agreeableness (factor 4), openness (factor 5?),
conscientiousness (factor 1), and neuroticism (factor 3). The
correspondence appears to be pretty good. (I wrote my answers
above last year without thinking about “big 5” at all.)</p>
<p>I wonder whether 6 factors is different?</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1">pers.ok<span class="fl">.2</span> &lt;-<span class="st"> </span>pers.ok <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;PERS&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb317-3" title="3"><span class="st">  </span><span class="kw">factanal</span>(<span class="dv">6</span>, <span class="dt">scores =</span> <span class="st">&quot;r&quot;</span>)</a>
<a class="sourceLine" id="cb317-4" title="4">pers.ok<span class="fl">.2</span><span class="op">$</span>loadings</a></code></pre></div>
<pre><code>## 
## Loadings:
##        Factor1 Factor2 Factor3 Factor4 Factor5 Factor6
## PERS01  0.114  -0.668           0.343           0.290 
## PERS02                  0.204  -0.451           0.354 
## PERS03  0.658                   0.200           0.131 
## PERS04 -0.141   0.215   0.538  -0.196                 
## PERS05  0.212  -0.271  -0.168   0.115   0.571         
## PERS06          0.694   0.171  -0.102                 
## PERS07  0.315  -0.114           0.530   0.138         
## PERS08 -0.602           0.145                   0.180 
## PERS09                 -0.669   0.118           0.106 
## PERS10  0.125                           0.398   0.264 
## PERS11         -0.131  -0.257           0.173   0.445 
## PERS12 -0.178                  -0.348           0.188 
## PERS13  0.572                   0.332   0.129         
## PERS14          0.142   0.675                   0.121 
## PERS15  0.141                           0.495         
## PERS16         -0.322  -0.130   0.114   0.248   0.491 
## PERS17                 -0.111   0.346           0.139 
## PERS18 -0.655                                         
## PERS19          0.139   0.598   0.101   0.104         
## PERS20         -0.165                   0.489   0.166 
## PERS21          0.843                          -0.110 
## PERS22  0.123  -0.105           0.613           0.110 
## PERS23 -0.631           0.115  -0.232                 
## PERS24                 -0.603           0.113   0.143 
## PERS25         -0.135  -0.119           0.513   0.166 
## PERS26  0.113  -0.385  -0.225  -0.163   0.176   0.454 
## PERS27          0.275   0.128  -0.365           0.177 
## PERS28  0.617                   0.253   0.129         
## PERS29                  0.466  -0.161           0.164 
## PERS30                                  0.497         
## PERS31          0.659   0.166                         
## PERS32  0.297                   0.630           0.102 
## PERS33  0.597                                   0.239 
## PERS34                 -0.584                   0.153 
## PERS35          0.221                  -0.210         
## PERS36         -0.562  -0.171   0.214           0.385 
## PERS37 -0.320                  -0.439           0.220 
## PERS38  0.501                   0.123   0.130   0.182 
## PERS39 -0.123   0.410   0.512                   0.118 
## PERS40                          0.146   0.598         
## PERS41                         -0.106  -0.378   0.117 
## PERS42  0.259  -0.139           0.587   0.118         
## PERS43 -0.515           0.210                   0.253 
## PERS44                                  0.454         
## 
##                Factor1 Factor2 Factor3 Factor4 Factor5 Factor6
## SS loadings      3.830   3.284   3.213   2.865   2.527   1.659
## Proportion Var   0.087   0.075   0.073   0.065   0.057   0.038
## Cumulative Var   0.087   0.162   0.235   0.300   0.357   0.395</code></pre>
<p>Much of the same kind of thing seems to be happening, though it’s a
bit fuzzier. I suspect the devisers of this survey were adherents to
the “big 5” theory. The factor 6 here is items 11, 16 and 26, which
would be expected to belong to factor 2 here, given what we found
before. I think these particular items are about generating enthusiasm
in others, rather than (necessarily) about being extraverted oneself.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" style="list-style-type: lower-alpha">
<li>Find a person who is extreme on each of your first three
factors (one at a time). For each of these people, what kind of
data should they have for the relevant ones of variables
<code>PERS01</code> through <code>PERS44</code>? Do they? Explain
reasonably briefly.</li>
</ol>
<p>Solution</p>
<p>For this, we need the factor scores obtained in part
(<a href="#part:score">here</a>).<a href="#fn38" class="footnote-ref" id="fnref38"><sup>38</sup></a>
I’m thinking that I will create a data frame
with the original data (with the missing values removed) and the
factor scores together, and then look in there. This will have a
lot of columns, but we’ll only need to display some each time.
This is based on my 5-factor solution. I’m adding a column
<code>id</code> so that I know which of the individuals (with no
missing data) we are looking at:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" title="1">scores<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(pers.ok<span class="fl">.1</span><span class="op">$</span>scores) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb319-2" title="2"><span class="st">  </span><span class="kw">bind_cols</span>(pers.ok) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb319-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">row_number</span>())</a>
<a class="sourceLine" id="cb319-4" title="4">scores<span class="fl">.1</span></a></code></pre></div>
<pre><code>## # A tibble: 433 x 50
##    Factor1 Factor2 Factor3 Factor4 Factor5    id PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17
##      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  1.11     0.543   0.530  -0.978 -0.528      1      5      4      5      1      4      3      3      1      2      3      2      4      5      4      4      3      5
##  2  0.930   -1.62   -0.823   1.11  -2.49       2      1      1      5      2      1      2      5      1      5      1      5      3      5      4      1      2      1
##  3  0.0405  -0.908   1.01    0.415 -0.169      3      4      1      5      3      3      4      5      3      1      4      2      1      5      4      3      2      5
##  4  0.123   -0.600   0.442   0.753  0.774      4      4      2      5      1      4      3      4      4      4      5      4      1      4      5      3      3      4
##  5  1.28    -1.30   -0.194  -0.170 -1.11       5      2      3      5      1      2      4      5      2      3      3      4      2      5      3      3      3      5
##  6  0.671   -2.10    1.09    0.507 -0.0442     6      1      1      5      4      3      4      4      2      1      4      3      3      5      5      3      2      4
##  7  0.474    0.467  -2.12    0.892 -2.57       7      3      2      5      1      2      1      1      2      5      4      4      1      5      1      1      4      5
##  8 -0.589    0.747  -0.257   1.18  -0.517      8      5      2      4      2      4      1      4      3      3      5      4      1      4      3      2      4      4
##  9 -0.836    1.02    0.620   1.36  -0.705      9      5      1      4      3      2      1      4      4      2      3      4      1      4      4      2      5      5
## 10  0.984    0.298  -1.06    0.681 -0.553     10      4      1      5      1      4      3      4      1      5      4      5      1      5      3      4      4      4
## # … with 423 more rows, and 27 more variables: PERS18 &lt;dbl&gt;, PERS19 &lt;dbl&gt;,
## #   PERS20 &lt;dbl&gt;, PERS21 &lt;dbl&gt;, PERS22 &lt;dbl&gt;, PERS23 &lt;dbl&gt;, PERS24 &lt;dbl&gt;,
## #   PERS25 &lt;dbl&gt;, PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;,
## #   PERS30 &lt;dbl&gt;, PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;,
## #   PERS35 &lt;dbl&gt;, PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;,
## #   PERS40 &lt;dbl&gt;, PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;</code></pre>
<p>I did it this way, rather than using <code>data.frame</code>, so that I
would end up with a <code>tibble</code> that would display nicely rather
than running off the page. This meant turning the matrix of factor
scores into a <code>tibble</code> first and then gluing everything onto
it. (There’s no problem in using <code>data.frame</code> here if you
prefer. You could even begin with <code>data.frame</code> and pipe the
final result into <code>as_tibble</code> to end up with a
<code>tibble</code>.)
Let’s start with factor 1. There are several ways to find the person
who scores highest and/or lowest on that factor:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" title="1">scores<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Factor1 <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(Factor1))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 50
##   Factor1 Factor2 Factor3 Factor4 Factor5    id PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1    1.70   -2.14   0.471  -0.525   0.681   231      1      4      5      4      4      5      5      2      4      4      2      2      5      4      5      4      1
## # … with 27 more variables: PERS18 &lt;dbl&gt;, PERS19 &lt;dbl&gt;, PERS20 &lt;dbl&gt;,
## #   PERS21 &lt;dbl&gt;, PERS22 &lt;dbl&gt;, PERS23 &lt;dbl&gt;, PERS24 &lt;dbl&gt;, PERS25 &lt;dbl&gt;,
## #   PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;, PERS30 &lt;dbl&gt;,
## #   PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;, PERS35 &lt;dbl&gt;,
## #   PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;, PERS40 &lt;dbl&gt;,
## #   PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;</code></pre>
<p>to display the maximum, or</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" title="1">scores<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(Factor1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 50
##   Factor1 Factor2 Factor3 Factor4 Factor5    id PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   -2.82   1.33  -0.548    0.786  0.488    340      5      1      1      2      5      1      3      5      4      5      2      1      3      4      4      5      4
## 2   -2.24  -0.510  0.125   -0.523 -0.0971   128      1      2      2      4      2      2      5      5      2      2      2      2      2      5      5      4      4
## 3   -2.14  -0.841 -0.272   -1.12  -1.18     142      1      2      1      4      2      3      2      3      2      1      3      2      1      4      2      4      3
## 4   -2.12   0.492  0.491   -0.259  0.259    387      5      3      3      4      4      3      4      4      4      3      2      2      2      4      5      3      5
## 5   -2.09  -0.125 -0.0469   0.766 -0.229    396      3      1      2      4      5      3      5      5      2      2      2      1      1      5      3      4      2
## # … with 27 more variables: PERS18 &lt;dbl&gt;, PERS19 &lt;dbl&gt;, PERS20 &lt;dbl&gt;,
## #   PERS21 &lt;dbl&gt;, PERS22 &lt;dbl&gt;, PERS23 &lt;dbl&gt;, PERS24 &lt;dbl&gt;, PERS25 &lt;dbl&gt;,
## #   PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;, PERS30 &lt;dbl&gt;,
## #   PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;, PERS35 &lt;dbl&gt;,
## #   PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;, PERS40 &lt;dbl&gt;,
## #   PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;</code></pre>
<p>to display the minimum (and in this case the five smallest ones), or</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" title="1">scores<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">abs</span>(Factor1) <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">abs</span>(Factor1)))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 50
##   Factor1 Factor2 Factor3 Factor4 Factor5    id PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   -2.82    1.33  -0.548   0.786   0.488   340      5      1      1      2      5      1      3      5      4      5      2      1      3      4      4      5      4
## # … with 27 more variables: PERS18 &lt;dbl&gt;, PERS19 &lt;dbl&gt;, PERS20 &lt;dbl&gt;,
## #   PERS21 &lt;dbl&gt;, PERS22 &lt;dbl&gt;, PERS23 &lt;dbl&gt;, PERS24 &lt;dbl&gt;, PERS25 &lt;dbl&gt;,
## #   PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;, PERS30 &lt;dbl&gt;,
## #   PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;, PERS35 &lt;dbl&gt;,
## #   PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;, PERS40 &lt;dbl&gt;,
## #   PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;</code></pre>
<p>to display the largest one in size, whether positive or negative. The
code is a bit obfuscated because I have to take absolute values
twice. Maybe it would be clearer to create a column with the absolute
values in it and look at that:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1">scores<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb327-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">abso =</span> <span class="kw">abs</span>(Factor1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb327-3" title="3"><span class="st">  </span><span class="kw">filter</span>(abso <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(abso))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 51
##   Factor1 Factor2 Factor3 Factor4 Factor5    id PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   -2.82    1.33  -0.548   0.786   0.488   340      5      1      1      2      5      1      3      5      4      5      2      1      3      4      4      5      4
## # … with 28 more variables: PERS18 &lt;dbl&gt;, PERS19 &lt;dbl&gt;, PERS20 &lt;dbl&gt;,
## #   PERS21 &lt;dbl&gt;, PERS22 &lt;dbl&gt;, PERS23 &lt;dbl&gt;, PERS24 &lt;dbl&gt;, PERS25 &lt;dbl&gt;,
## #   PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;, PERS30 &lt;dbl&gt;,
## #   PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;, PERS35 &lt;dbl&gt;,
## #   PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;, PERS40 &lt;dbl&gt;,
## #   PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;, abso &lt;dbl&gt;</code></pre>
<p>Does
this work too?</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1">scores<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="kw">abs</span>(Factor1))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 50
##   Factor1 Factor2 Factor3 Factor4 Factor5    id PERS01 PERS02 PERS03 PERS04 PERS05 PERS06 PERS07 PERS08 PERS09 PERS10 PERS11 PERS12 PERS13 PERS14 PERS15 PERS16 PERS17
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   -2.82   1.33  -0.548    0.786  0.488    340      5      1      1      2      5      1      3      5      4      5      2      1      3      4      4      5      4
## 2   -2.24  -0.510  0.125   -0.523 -0.0971   128      1      2      2      4      2      2      5      5      2      2      2      2      2      5      5      4      4
## 3   -2.14  -0.841 -0.272   -1.12  -1.18     142      1      2      1      4      2      3      2      3      2      1      3      2      1      4      2      4      3
## 4   -2.12   0.492  0.491   -0.259  0.259    387      5      3      3      4      4      3      4      4      4      3      2      2      2      4      5      3      5
## 5   -2.09  -0.125 -0.0469   0.766 -0.229    396      3      1      2      4      5      3      5      5      2      2      2      1      1      5      3      4      2
## # … with 27 more variables: PERS18 &lt;dbl&gt;, PERS19 &lt;dbl&gt;, PERS20 &lt;dbl&gt;,
## #   PERS21 &lt;dbl&gt;, PERS22 &lt;dbl&gt;, PERS23 &lt;dbl&gt;, PERS24 &lt;dbl&gt;, PERS25 &lt;dbl&gt;,
## #   PERS26 &lt;dbl&gt;, PERS27 &lt;dbl&gt;, PERS28 &lt;dbl&gt;, PERS29 &lt;dbl&gt;, PERS30 &lt;dbl&gt;,
## #   PERS31 &lt;dbl&gt;, PERS32 &lt;dbl&gt;, PERS33 &lt;dbl&gt;, PERS34 &lt;dbl&gt;, PERS35 &lt;dbl&gt;,
## #   PERS36 &lt;dbl&gt;, PERS37 &lt;dbl&gt;, PERS38 &lt;dbl&gt;, PERS39 &lt;dbl&gt;, PERS40 &lt;dbl&gt;,
## #   PERS41 &lt;dbl&gt;, PERS42 &lt;dbl&gt;, PERS43 &lt;dbl&gt;, PERS44 &lt;dbl&gt;</code></pre>
<p>It looks as if it does: “sort the Factor 1 scores in descending order by absolute value, and display the first few”. The most extreme
scores on Factor 1 are all negative: the most positive one (found
above) was only about 1.70.</p>
<p>For you, you don’t have to be this sophisticated. It’s enough to
eyeball the factor scores on factor 1 and find one that’s reasonably
far away from zero. Then you note its row and <code>slice</code> that row,
later.</p>
<p>I think I like the idea of creating a new column with the absolute
values in it and finding the largest of that. Before we pursue that,
though, remember that we don’t need to look at <em>all</em> the
<code>PERS</code> columns, because only some of them load highly on each
factor. These are the ones I defined into <code>f1</code> first; the first
ones have positive loadings and the last three have negative loadings:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" title="1">f1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">13</span>, <span class="dv">28</span>, <span class="dv">33</span>, <span class="dv">38</span>, <span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">43</span>)</a>
<a class="sourceLine" id="cb331-2" title="2">scores<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb331-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">abso =</span> <span class="kw">abs</span>(Factor1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb331-4" title="4"><span class="st">  </span><span class="kw">filter</span>(abso <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(abso)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb331-5" title="5"><span class="st">  </span><span class="kw">select</span>(id, Factor1, <span class="kw">num_range</span>(<span class="st">&quot;PERS&quot;</span>, f1, <span class="dt">width =</span> <span class="dv">2</span>)) </a></code></pre></div>
<pre><code>## # A tibble: 1 x 11
##      id Factor1 PERS03 PERS13 PERS28 PERS33 PERS38 PERS08 PERS18 PERS23 PERS43
##   &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   340   -2.82      1      3      3      1      2      5      5      4      5</code></pre>
<p>I don’t think I’ve used <code>num_range</code> before, like, ever. It is
one of the select-helpers like <code>starts_with</code>. It is used when
you have column names that are some constant text followed by variable
numbers, which is exactly what we have here: we want to select the
<code>PERS</code> columns with numbers that we
specify. <code>num_range</code> requires (at least) two things: the text prefix,
followed by a vector of numbers that are to be glued onto the
prefix. I defined that first so as not to clutter up the
<code>select</code> line. The third thing here is <code>width</code>: all the
<code>PERS</code> columns have a name that ends with two digits, so
<code>PERS03</code> rather than <code>PERS3</code>, and using <code>width</code>
makes sure that the zero gets inserted.</p>
<p>Individual 340 is a low scorer on factor 1, so they should have low
scores on the first five items (the ones with positive loading on
factor 1) and high scores on the last four. This is indeed what
happened: 1s, 2s and 3s on the first five items and 4s and 5s on the
last four.
Having struggled through that, factors 2 and 3 are repeats of
this. The high loaders on factor 2 are the ones shown in <code>f2</code>
below, with the first five loading positively and the last three
negatively.<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb333-1" title="1">f2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">16</span>, <span class="dv">26</span>, <span class="dv">36</span>, <span class="dv">6</span>, <span class="dv">21</span>, <span class="dv">31</span>)</a>
<a class="sourceLine" id="cb333-2" title="2">scores<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb333-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">abso =</span> <span class="kw">abs</span>(Factor2)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb333-4" title="4"><span class="st">  </span><span class="kw">filter</span>(abso <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(abso)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb333-5" title="5"><span class="st">  </span><span class="kw">select</span>(id, Factor2, <span class="kw">num_range</span>(<span class="st">&quot;PERS&quot;</span>, f2, <span class="dt">width =</span> <span class="dv">2</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 10
##      id Factor2 PERS01 PERS11 PERS16 PERS26 PERS36 PERS06 PERS21 PERS31
##   &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1    58   -2.35      1      2      1      2      2      5      5      5</code></pre>
<p>What kind of idiot, I was thinking, named the data frame of scores
<code>scores.1</code> when there are going to be three factors to assess?</p>
<p>The first five scores are lowish, but the last three are definitely
high (three 5s). This idea of a low score on the positive-loading
items and a high score on the negatively-loading ones is entirely
consistent with a negative factor score.</p>
<p>Finally, factor 3, which loads highly on items 4, 9 (neg), 14, 19, 24
(neg), 29, 34 (neg), 39. (Item 44, which you’d expect to be part of
this factor, is actually in factor 5.) First we see which individual
this is:</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" title="1">f3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">29</span>, <span class="dv">39</span>, <span class="dv">9</span>, <span class="dv">24</span>, <span class="dv">34</span>)</a>
<a class="sourceLine" id="cb335-2" title="2">scores<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb335-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">abso =</span> <span class="kw">abs</span>(Factor3)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb335-4" title="4"><span class="st">  </span><span class="kw">filter</span>(abso <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(abso)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb335-5" title="5"><span class="st">  </span><span class="kw">select</span>(id, Factor3, <span class="kw">num_range</span>(<span class="st">&quot;PERS&quot;</span>, f3, <span class="dt">width =</span> <span class="dv">2</span>)) </a></code></pre></div>
<pre><code>## # A tibble: 1 x 10
##      id Factor3 PERS04 PERS14 PERS19 PERS29 PERS39 PERS09 PERS24 PERS34
##   &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   209   -2.27      1      1      4      1      1      5      4      4</code></pre>
<p>The only mysterious one there is item 19, which ought to be low,
because it has a positive loading and the factor score is unusually
negative. But it is 4 on a 5-point scale. The others that are supposed
to be low are 1 and the ones that are supposed to be high are 4 or 5, so
those all match up.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol style="list-style-type: lower-roman">
<li>Check the uniquenesses. Which one(s) seem unusually
high? Check these against the factor loadings. Are these what you
would expect?</li>
</ol>
<p>Solution</p>
<p>Mine are</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb337-1" title="1">pers.ok<span class="fl">.1</span><span class="op">$</span>uniquenesses</a></code></pre></div>
<pre><code>##    PERS01    PERS02    PERS03    PERS04    PERS05    PERS06    PERS07    PERS08    PERS09    PERS10    PERS11    PERS12    PERS13    PERS14    PERS15    PERS16    PERS17 
## 0.3276244 0.6155884 0.4955364 0.6035655 0.5689691 0.4980334 0.5884146 0.6299781 0.5546981 0.7460655 0.7740590 0.8016644 0.5336047 0.5035412 0.7381636 0.6352166 0.8978624 
##    PERS18    PERS19    PERS20    PERS21    PERS22    PERS23    PERS24    PERS25    PERS26    PERS27    PERS28    PERS29    PERS30    PERS31    PERS32    PERS33    PERS34 
## 0.5881834 0.5949740 0.6900378 0.3274366 0.6564542 0.5279346 0.6107080 0.6795545 0.5412962 0.7438329 0.5289192 0.7114735 0.7386601 0.5762901 0.5592906 0.6029914 0.6573411 
##    PERS35    PERS36    PERS37    PERS38    PERS39    PERS40    PERS41    PERS42    PERS43    PERS44 
## 0.9306766 0.4966071 0.6396371 0.6804821 0.5933423 0.6204610 0.8560531 0.5684220 0.6898732 0.7872295</code></pre>
<p>Yours will be different if you used a different number of factors. But
the procedure you follow will be the same as mine.</p>
<p>I think the highest of these is 0.9307, for item 35. Also high is item
17, 0.8979. If you look back at the table of loadings, item 35 has low
loadings on <em>all</em> the factors: the largest in size is only
0.180. The largest loading for item 17 is 0.277, on factor 4. This is
not high either.</p>
<p>Looking down the loadings table, also item 41 has only a loading of
<span class="math inline">\(-0.326\)</span> on factor 5, so its uniqueness ought to be pretty high as
well. At 0.8561, it is.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="a-correlation-matrix-1" class="section level2">
<h2><span class="header-section-number">40.5</span> A correlation matrix</h2>
<p>Here is a correlation matrix between five variables. This
correlation matrix was based on <span class="math inline">\(n=50\)</span> observations. Save the data
into a file.</p>
<pre><code>
1.00 0.90 -0.40 0.28 -0.05
0.90 1.00 -0.60 0.43 -0.20
-0.40 -0.60 1.00 -0.80 0.40
0.28 0.43 -0.80 1.00 -0.70
-0.05 -0.20 0.40 -0.70 1.00
</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Read in the data, using <code>col_names=F</code> (why?). Check that you
have five variables with names invented by R.</li>
</ol>
<p>Solution</p>
<p>I saved my data into <code>cov5.txt</code>,<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a> delimited by single spaces, so:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" title="1">corr &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;cov5.txt&quot;</span>, <span class="st">&quot; &quot;</span>, <span class="dt">col_names =</span> F)</a></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   X1 = col_double(),
##   X2 = col_double(),
##   X3 = col_double(),
##   X4 = col_double(),
##   X5 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" title="1">corr</a></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##      X1    X2    X3    X4    X5
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  1     0.9   -0.4  0.28 -0.05
## 2  0.9   1     -0.6  0.43 -0.2 
## 3 -0.4  -0.6    1   -0.8   0.4 
## 4  0.28  0.43  -0.8  1    -0.7 
## 5 -0.05 -0.2    0.4 -0.7   1</code></pre>
<p>I needed to say that I have no variable names and I want R
to provide some. As you see, it did: <code>X1</code> through
<code>X5</code>. You can also supply your own names in this fashion:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" title="1">my_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;first&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;third&quot;</span>, <span class="st">&quot;fourth&quot;</span>, <span class="st">&quot;fifth&quot;</span>)</a>
<a class="sourceLine" id="cb344-2" title="2">corr2 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;cov5.txt&quot;</span>, <span class="st">&quot; &quot;</span>, <span class="dt">col_names =</span> my_names)</a></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   first = col_double(),
##   second = col_double(),
##   third = col_double(),
##   fourth = col_double(),
##   fifth = col_double()
## )</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1">corr2</a></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   first second third fourth fifth
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1  1      0.9   -0.4   0.28 -0.05
## 2  0.9    1     -0.6   0.43 -0.2 
## 3 -0.4   -0.6    1    -0.8   0.4 
## 4  0.28   0.43  -0.8   1    -0.7 
## 5 -0.05  -0.2    0.4  -0.7   1</code></pre>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Run a principal components analysis from this correlation matrix.</li>
</ol>
<p>Solution</p>
<p>Two lines, these:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1">corr.mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(corr)</a>
<a class="sourceLine" id="cb348-2" title="2">corr<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">princomp</span>(<span class="dt">covmat =</span> corr.mat)</a></code></pre></div>
<p>Or do it in one step as</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb349-1" title="1">corr<span class="fl">.1</span>a &lt;-<span class="st"> </span><span class="kw">princomp</span>(<span class="kw">as.matrix</span>(corr))</a></code></pre></div>
<p>if you like, but I think it’s less clear what’s going on.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li><a name="part:howmany">*</a> Obtain a scree plot. Can you justify
the use of two components (later, factors), bearing in mind that we
have only five variables?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1"><span class="kw">ggscreeplot</span>(corr<span class="fl">.1</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/sdljhljsahja-1.png" width="672" /></p>
<p>There is kind of an elbow at 3, which would suggest two components/factors.<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a></p>
<p>You can also use the eigenvalue-bigger-than-1 thing:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb351-1" title="1"><span class="kw">summary</span>(corr<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## Importance of components:
##                           Comp.1    Comp.2     Comp.3     Comp.4    Comp.5
## Standard deviation     1.7185460 1.1686447 0.70207741 0.36584870 0.2326177
## Proportion of Variance 0.5906801 0.2731461 0.09858254 0.02676905 0.0108222
## Cumulative Proportion  0.5906801 0.8638262 0.96240875 0.98917780 1.0000000</code></pre>
<p>Only the first
<em>two</em> eigenvalues are bigger than 1, and the third is quite a bit
smaller. So this would suggest two factors also. The third eigenvalue
is in that kind of nebulous zone between between being big and being
small, and the percent of variance explained is also ambiguous: is
86% good enough or should I go for 96%? These questions rarely have
good answers. But an issue is that you want to summarize your
variables with a (much) smaller number of factors; with 5 variables,
having two factors rather than more than two seems to be a way of
gaining some insight.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Take a look at the first two component loadings. Which variables appear
to feature in which component? Do they have a positive or negative effect?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" title="1">corr<span class="fl">.1</span><span class="op">$</span>loadings</a></code></pre></div>
<pre><code>## 
## Loadings:
##    Comp.1 Comp.2 Comp.3 Comp.4 Comp.5
## X1  0.404  0.571  0.287  0.363  0.545
## X2  0.482  0.439  0.144 -0.363 -0.650
## X3 -0.501  0.122  0.652  0.412 -0.375
## X4  0.490 -0.390 -0.171  0.689 -0.323
## X5 -0.338  0.561 -0.665  0.304 -0.189
## 
##                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5
## SS loadings       1.0    1.0    1.0    1.0    1.0
## Proportion Var    0.2    0.2    0.2    0.2    0.2
## Cumulative Var    0.2    0.4    0.6    0.8    1.0</code></pre>
<p>This is messy.</p>
<p>In the first component, the loadings are all about the
same in size, but the ones for <code>X3</code> and <code>X5</code> are
negative and the rest are positive. Thus, component 1 is contrasting
<code>X3</code> and <code>X5</code> with the others.</p>
<p>In the second component, the emphasis is on <code>X1</code>, <code>X2</code>
and <code>X5</code>, all with negative loadings, and possibly <code>X4</code>,
with a positive loading.</p>
<p>Note that the first component is basically “size”, since the
component loadings are all almost equal in absolute value. This often
happens in principal components; for example, it also happened with
the running records in class.</p>
<p>I hope the factor analysis, with its rotation, will straighten things
out some.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Create a “covariance list” (for the purposes of
performing a factor analysis on the correlation matrix).</li>
</ol>
<p>Solution</p>
<p>This is about the most direct way:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" title="1">corr.list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">cov =</span> corr.mat, <span class="dt">n.obs =</span> <span class="dv">50</span>)</a></code></pre></div>
<p>recalling that there were 50 observations. The idea is that we feed
this into <code>factanal</code> instead of the correlation matrix, so that
the factor analysis knows how many individuals there were (for testing
and such).</p>
<p>Note that you need the correlation matrix <em>as a <code>matrix</code></em>,
not as a data frame. If you ran the <code>princomp</code> all in one step,
you’ll have to create the correlation matrix again, for example like this:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb356-1" title="1">corr.list2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">cov =</span> <span class="kw">as.matrix</span>(corr), <span class="dt">n.obs =</span> <span class="dv">50</span>)</a></code></pre></div>
<p>The actual list looks like this:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb357-1" title="1">corr.list</a></code></pre></div>
<pre><code>## $cov
##         X1    X2   X3    X4    X5
## [1,]  1.00  0.90 -0.4  0.28 -0.05
## [2,]  0.90  1.00 -0.6  0.43 -0.20
## [3,] -0.40 -0.60  1.0 -0.80  0.40
## [4,]  0.28  0.43 -0.8  1.00 -0.70
## [5,] -0.05 -0.20  0.4 -0.70  1.00
## 
## $n.obs
## [1] 50</code></pre>
<p>An R list is a collection of things <em>not all of the same type</em>,
here a matrix and a number, and is a handy way of keeping a bunch of
connected things together. You use the same dollar-sign notation as
for a data frame to
access the things in a list:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb359-1" title="1">corr.list<span class="op">$</span>n.obs</a></code></pre></div>
<pre><code>## [1] 50</code></pre>
<p>and logically this is because, to R, a data frame <em>is</em> a special
kind of a list, so anything that works for a list also works for a
data frame, plus some extra things besides.<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a></p>
<p>The same idea applies to extracting things from the output of a
regression (with <code>lm</code>) or something like a <code>t.test</code>: the
output from those is also a list. But for those, I like <code>tidy</code>
from <code>broom</code> better.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Carry out a factor analysis with two factors. We’ll
investigate the bits of it in a
moment.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb361-1" title="1">corr<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">factanal</span>(<span class="dt">factors =</span> <span class="dv">2</span>, <span class="dt">covmat =</span> corr.list)</a></code></pre></div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" style="list-style-type: lower-alpha">
<li><a name="part:load">*</a> Look at the factor loadings. Describe how the factors are
related to the original variables. Is the interpretation clearer
than for the principal components analysis?</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" title="1">corr<span class="fl">.2</span><span class="op">$</span>loadings</a></code></pre></div>
<pre><code>## 
## Loadings:
##      Factor1 Factor2
## [1,]          0.905 
## [2,] -0.241   0.968 
## [3,]  0.728  -0.437 
## [4,] -0.977   0.201 
## [5,]  0.709         
## 
##                Factor1 Factor2
## SS loadings      2.056   1.987
## Proportion Var   0.411   0.397
## Cumulative Var   0.411   0.809</code></pre>
<p>Oh yes, this is a lot clearer. Factor 1 is variables 3 and 5
contrasted with variable 4; factor 2 is variables 1 and 2. No
hand-waving required.</p>
<p>Perhaps now is a good time to look back at the correlation matrix and
see why the factor analysis came out this way:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb364-1" title="1">corr</a></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##      X1    X2    X3    X4    X5
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  1     0.9   -0.4  0.28 -0.05
## 2  0.9   1     -0.6  0.43 -0.2 
## 3 -0.4  -0.6    1   -0.8   0.4 
## 4  0.28  0.43  -0.8  1    -0.7 
## 5 -0.05 -0.2    0.4 -0.7   1</code></pre>
<p>Variable <code>X1</code> is highly correlated with <code>X2</code> but not
really any of the others. Likewise variables <code>X3, X4, X5</code> are
more or less highly correlated among themselves but not with the
others (<code>X2</code> and <code>X3</code> being an exception, but the big
picture is as I described). So variables that appear in the same
factor should be highly correlated with each other and not with
variables that are in different factors. But it took the factor
analysis to really show this up.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" style="list-style-type: lower-alpha">
<li>Look at the uniquenesses. Are there any that are unusually
high? Does that surprise you, given your answer to
(<a href="#part:load">here</a>)? (You will probably have to make a judgement call here.)</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb366-1" title="1">corr<span class="fl">.2</span><span class="op">$</span>uniquenesses</a></code></pre></div>
<pre><code>##        X1        X2        X3        X4        X5 
## 0.1715682 0.0050000 0.2789445 0.0050000 0.4961028</code></pre>
<p>The ones for <code>X3</code> and <code>X5</code> are higher than the rest;
this is because their loadings on factor 1 are lower than the
rest. Since those loadings are still high, I wouldn’t be worried about
the uniquenesses.</p>
<p>The point here is that an (excessively) high uniqueness indicates a
variable that doesn’t appear in <em>any</em> factor. The easy link to
make is “all the variables appear in a factor, so there shouldn’t be any very high uniquenesses”. If, say, <code>X3</code> doesn’t have a high
loading on any factor, <code>X3</code> would have a high uniqueness (like
0.9, and none of these values approach that).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="air-pollution-1" class="section level2">
<h2><span class="header-section-number">40.6</span> Air pollution</h2>
<p>The data in
<a href="http://ritsokiguess.site/datafiles/airpollution.csv">link</a> are
measurements of air-pollution variables recorded at 12 noon on 42
different days at a location in Los Angeles. The file is in
<code>.csv</code> format, since it came from a spreadsheet. Specifically,
the variables (in suitable units), in the same order as in the data
file, are:</p>
<ul>
<li><p>wind speed</p></li>
<li><p>solar radiation</p></li>
<li><p>carbon monoxide</p></li>
<li><p>Nitric oxide (also known as nitrogen monoxide)</p></li>
<li><p>Nitrogen dioxide</p></li>
<li><p>Ozone</p></li>
<li><p>Hydrocarbons</p></li>
</ul>
<p>The aim is to describe pollution using fewer than these seven variables.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in the data and demonstrate that you have the right
number of rows and columns in your data frame.</li>
</ol>
<p>Solution</p>
<p>This is a <code>.csv</code> file, so:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb368-1" title="1">my_url &lt;-<span class="st"> &quot;http://ritsokiguess.site/datafiles/airpollution.csv&quot;</span></a>
<a class="sourceLine" id="cb368-2" title="2">air &lt;-<span class="st"> </span><span class="kw">read_csv</span>(my_url)</a></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   wind = col_double(),
##   solar.radiation = col_double(),
##   CO = col_double(),
##   NO = col_double(),
##   NO2 = col_double(),
##   O3 = col_double(),
##   HC = col_double()
## )</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb370-1" title="1">air</a></code></pre></div>
<pre><code>## # A tibble: 42 x 7
##     wind solar.radiation    CO    NO   NO2    O3    HC
##    &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     8              98     7     2    12     8     2
##  2     7             107     4     3     9     5     3
##  3     7             103     4     3     5     6     3
##  4    10              88     5     2     8    15     4
##  5     6              91     4     2     8    10     3
##  6     8              90     5     2    12    12     4
##  7     9              84     7     4    12    15     5
##  8     5              72     6     4    21    14     4
##  9     7              82     5     1    11    11     3
## 10     8              64     5     2    13     9     4
## # … with 32 more rows</code></pre>
<p>There should be 42 rows (for the 42 days), and 7 columns (for the 7
variables), and there are.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li><a name="part:fivenum">*</a>
Obtain a five-number summary for each variable. You can do this in
one go for all seven variables.</li>
</ol>
<p>Solution</p>
<p>Like this (the cleanest):</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb372-1" title="1">air <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb372-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), <span class="op">~</span><span class="kw">quantile</span>(.)))</a></code></pre></div>
<pre><code>## # A tibble: 5 x 7
##    wind solar.radiation    CO    NO   NO2    O3    HC
##   &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  5               30       2     1   5     2       2
## 2  6               68.2     4     1   8     6       3
## 3  8               76.5     4     2   9.5   8.5     3
## 4  8.75            84.8     5     3  12    11       3
## 5 10              107       7     5  21    25       5</code></pre>
<p>I have to figure out how to
identify which number from the five number summary each of these is,
but in this case you can easily figure it out since the min is the
smallest and the max has to be the biggest in each column.</p>
<p>Or, with some more work, this:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb374-1" title="1">air <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(), <span class="dt">names_to=</span><span class="st">&quot;xname&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;x&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb374-3" title="3"><span class="st">  </span><span class="kw">nest_by</span>(xname) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-4" title="4"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb374-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">q =</span> <span class="kw">list</span>(<span class="kw">enframe</span>(<span class="kw">quantile</span>(data<span class="op">$</span>x)))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-6" title="6"><span class="st">  </span><span class="kw">unnest</span>(q) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb374-7" title="7"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from=</span>name, <span class="dt">values_from=</span>value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb374-8" title="8"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>data)</a></code></pre></div>
<pre><code>## # A tibble: 7 x 6
##   xname            `0%` `25%` `50%` `75%` `100%`
##   &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 CO                  2   4     4    5         7
## 2 HC                  2   3     3    3         5
## 3 NO                  1   1     2    3         5
## 4 NO2                 5   8     9.5 12        21
## 5 O3                  2   6     8.5 11        25
## 6 solar.radiation    30  68.2  76.5 84.8     107
## 7 wind                5   6     8    8.75     10</code></pre>
<p>There’s a lot here. Run it one line at a time to see what it does:</p>
<ul>
<li><p>put the names of the variables in one column and the values in a second. This is the same trick as when we want to make plots of all the variables facetted.</p></li>
<li><p>the <code>nest_by</code> says: for each variable (whose names are now in <code>xname</code>), make a dataframe called <code>data</code> of the observations (in <code>x</code>) for that variable</p></li>
<li><p>the rest of the way, work one row at a time</p></li>
<li><p>work out the five-number summary for each variable, using the values <code>x</code> in the data frame <code>data</code> of each row of the list-column, one at a time. This is the base R <code>quantile</code>, working on a vector (the column <code>x</code> of the data frame <code>data</code>), so it gives you back a named vector. If you are not familiar with that, try running <code>quantile(1:10)</code> and see how the output has both the percentiles and, above them, the percents that they go with. The tidyverse doesn’t like names, so my favourite way of keeping them with a named vector is to run it through <code>enframe</code>. This makes a two-column dataframe, with a column called <code>name</code> that is in this case the percents, and a column called <code>value</code> that is the percentiles. This is a dataframe rather than a single number, so it needs a <code>list</code> on the front as well (to make another list-column).
There are rather a lot of brackets to close here; if you are not sure you have enough, type another close bracket, pause, and see what it matches (R Studio will show you). If it matches nothing, you have too many close brackets.</p></li>
<li><p>show the values of the five-number summary for each variable (in long format, but with the percentages attached)</p></li>
<li><p>for human consumption, put the percentiles in columns, one row for each variable</p></li>
<li><p>finally, get rid of the dataframes of original values (that we don’t need any more now that we have summarized them).</p></li>
</ul>
<p>Extra: say you wanted to make facetted histograms of each variable. You would begin the same way, with the <code>pivot_longer</code>, and at the end, <code>facet_wrap</code> with <code>scales = "free"</code> (since the variables are measured on different scales):</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb376-1" title="1">air <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb376-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(), <span class="dt">names_to=</span><span class="st">&quot;xname&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;x&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb376-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb376-4" title="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>xname, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
<p>Extra extra: I originally put a pipe symbol on the end of the line with the <code>geom_histogram</code> on it, and got an impenetrable error. However, googling the error message (often a good plan) gave me a first hit that told me exactly what I had done.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Obtain a principal components analysis. Do it on the
correlation matrix, since the variables are measured on different
scales. You don’t need to look at the results yet.</li>
</ol>
<p>Solution</p>
<p>This too is all rather like the previous question:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" title="1">air<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">princomp</span>(air, <span class="dt">cor =</span> T)</a></code></pre></div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Obtain a scree plot. How many principal components might be
worth looking at? Explain briefly. (There might be more than one
possibility. If so, discuss them all.)</li>
</ol>
<p>Solution</p>
<p><code>ggscreeplot</code> the thing you just obtained, having loaded
package <code>ggbiplot</code>:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb378-1" title="1"><span class="kw">ggscreeplot</span>(air<span class="fl">.1</span>)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-216-1.png" width="672" /></p>
<p>There is a technicality here, which is
that <code>ggbiplot</code>, the package, loads <code>plyr</code>, which
contains a lot of the same things as <code>dplyr</code> (the latter is a
cut-down version of the former). If you load <code>dplyr</code> and
<em>then</em> <code>plyr</code> (that is to say, if you load the
<code>tidyverse</code> first and then <code>ggbiplot</code>), you will end up
with trouble, and probably the wrong version of a lot of functions. To
avoid this, load <code>ggbiplot</code> <em>first</em>, and then you’ll be
OK.</p>
<p>Now, finally, we might diverge from the previous question. There are
actually <em>two</em> elbows on this plot, at 2 and at 4, which means
that we should entertain the idea of either 1 or 3 components. I would
be inclined to say that the elbow at 2 is still “too high up” the
mountain — there is still some more mountain below it.</p>
<p>The points at 3 and 6 components look like elbows too, but they are
<em>pointing the wrong way</em>. What you are looking for when you
search for elbows are points that are the end of the mountain and the
start of the scree. The elbows at 2 (maybe) and 4 (definitely) are
this kind of thing, but the elbows at 3 and at 6 are not.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Look at the <code>summary</code> of the principal components
object. What light does this shed on the choice of number of
components? Explain briefly.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" title="1"><span class="kw">summary</span>(air<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## Importance of components:
##                           Comp.1    Comp.2    Comp.3    Comp.4     Comp.5     Comp.6     Comp.7
## Standard deviation     1.5286539 1.1772853 1.0972994 0.8526937 0.80837896 0.73259047 0.39484041
## Proportion of Variance 0.3338261 0.1980001 0.1720094 0.1038695 0.09335379 0.07666983 0.02227128
## Cumulative Proportion  0.3338261 0.5318262 0.7038356 0.8077051 0.90105889 0.97772872 1.00000000</code></pre>
<p>The first component only explains 33% of the variability, not very
much, but the first <em>three</em> components together explain 70%,
which is much more satisfactory. So I would go with 3 components.</p>
<p>There are two things here: finding an elbow, <em>and</em> explaining a
sensible fraction of the variability. You could explain more of the
variability by taking more components, but if you are not careful you
end up explaining seven variables with, um, seven variables.</p>
<p>If you go back and look at the scree plot, you’ll see that the first
elbow is really rather high up the mountain, and it’s really the
<em>second</em> elbow that is the start of the scree.</p>
<p>If this part doesn’t persuade you that three components is better than
one, you need to pick a number of components to use for the rest of
the question, and stick to it all the way through.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li><a name="part:preferred">*</a> How do each of your preferred number of components depend
on the variables that were measured? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>When this was a hand-in question, there were three marks for it,
which was a bit of a giveaway!
Off we go:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" title="1">air<span class="fl">.1</span><span class="op">$</span>loadings</a></code></pre></div>
<pre><code>## 
## Loadings:
##                 Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7
## wind             0.237  0.278  0.643  0.173  0.561  0.224  0.241
## solar.radiation -0.206 -0.527  0.224  0.778 -0.156              
## CO              -0.551        -0.114         0.573  0.110 -0.585
## NO              -0.378  0.435 -0.407  0.291         0.450  0.461
## NO2             -0.498  0.200  0.197               -0.745  0.338
## O3              -0.325 -0.567  0.160 -0.508         0.331  0.417
## HC              -0.319  0.308  0.541 -0.143 -0.566  0.266 -0.314
## 
##                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7
## SS loadings     1.000  1.000  1.000  1.000  1.000  1.000  1.000
## Proportion Var  0.143  0.143  0.143  0.143  0.143  0.143  0.143
## Cumulative Var  0.143  0.286  0.429  0.571  0.714  0.857  1.000</code></pre>
<p>You’ll have to decide where to draw the line between “zero” and
“nonzero”. It doesn’t matter so much where you put the line, so your
answers can differ from mine and still be correct.</p>
<p>We need to pick the loadings that are “nonzero”, however we define
that, for example:</p>
<ul>
<li><p>component 1 depends (negatively) on carbon monoxide and nitrogen dioxide.</p></li>
<li><p>component 2 depends (negatively) on solar radiation and ozone
and possibly positively on nitric oxide.</p></li>
<li><p>component 3 depends (positively) on wind and hydrocarbons.</p></li>
</ul>
<p>It is a good idea to translate the variable names (which are
abbreviated) back into the long forms.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Make a data frame that contains (i) the original data, (ii) a column of row numbers, (iii) the principal component scores. Display some of it.</li>
</ol>
<p>Solution</p>
<p>All the columns contain numbers, so <code>cbind</code> will do
it. (The component scores are seven columns, so
<code>bind_cols</code> won’t do it unless you are careful.):</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" title="1"><span class="kw">cbind</span>(air, air<span class="fl">.1</span><span class="op">$</span>scores) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb383-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">row =</span> <span class="kw">row_number</span>()) -&gt;<span class="st"> </span>d</a>
<a class="sourceLine" id="cb383-3" title="3"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>##   wind solar.radiation CO NO NO2 O3 HC      Comp.1     Comp.2     Comp.3    Comp.4     Comp.5     Comp.6     Comp.7 row
## 1    8              98  7  2  12  8  2 -0.95292110 -0.9754106 -0.4266696 1.4454463  2.0390917 -0.7280074 -0.5714587   1
## 2    7             107  4  3   9  5  3 -0.04941978 -0.4291403 -0.2925624 2.1070743 -0.7830499  0.1619189  0.1581294   2
## 3    7             103  4  3   5  6  3  0.53767776 -0.6491739 -0.5519781 1.8839424 -0.7923010  1.1153956 -0.1744016   3
## 4   10              88  5  2   8 15  4 -0.37519620 -0.3609587  2.0031533 0.1892788  0.2923780  1.4704360 -0.1020858   4
## 5    6              91  4  2   8 10  3  0.19694099 -1.0955256 -0.4489016 0.5501374 -0.8853554  0.1186414 -0.1581801   5
## 6    8              90  5  2  12 12  4 -1.12344250 -0.2297073  1.3544191 0.2851494 -0.4269438  0.1098276 -0.2316944   6</code></pre>
<p>This is probably the easiest way, but you see that there is a mixture
of base R and Tidyverse. The result is actually a base R <code>data.frame</code>, so displaying it will display <em>all</em> of it, hence my use of <code>head</code>.
If you want to do it the all-Tidyverse
way<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a>
then you need to bear in mind that <code>bind_cols</code> <em>only</em>
accepts vectors or data frames, not matrices, so a bit of care is needed first:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" title="1">air<span class="fl">.1</span><span class="op">$</span>scores <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb385-2" title="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb385-3" title="3"><span class="st">  </span><span class="kw">bind_cols</span>(air) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb385-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">row =</span> <span class="kw">row_number</span>()) -&gt;<span class="st"> </span>dd</a>
<a class="sourceLine" id="cb385-5" title="5">dd</a></code></pre></div>
<pre><code>## # A tibble: 42 x 15
##     Comp.1 Comp.2 Comp.3 Comp.4  Comp.5 Comp.6 Comp.7  wind solar.radiation    CO    NO   NO2    O3    HC   row
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
##  1 -0.953  -0.975 -0.427  1.45   2.04   -0.728 -0.571     8              98     7     2    12     8     2     1
##  2 -0.0494 -0.429 -0.293  2.11  -0.783   0.162  0.158     7             107     4     3     9     5     3     2
##  3  0.538  -0.649 -0.552  1.88  -0.792   1.12  -0.174     7             103     4     3     5     6     3     3
##  4 -0.375  -0.361  2.00   0.189  0.292   1.47  -0.102    10              88     5     2     8    15     4     4
##  5  0.197  -1.10  -0.449  0.550 -0.885   0.119 -0.158     6              91     4     2     8    10     3     5
##  6 -1.12   -0.230  1.35   0.285 -0.427   0.110 -0.232     8              90     5     2    12    12     4     6
##  7 -3.15    1.07   1.62   0.186  0.0374  1.84  -0.415     9              84     7     4    12    15     5     7
##  8 -3.98    0.926 -0.379 -0.619 -0.810  -1.29   0.735     5              72     6     4    21    14     4     8
##  9 -0.152  -0.974  0.337 -0.145  0.139  -0.681 -0.539     7              82     5     1    11    11     3     9
## 10 -0.784   0.939  0.985 -0.632 -0.219  -0.303 -0.375     8              64     5     2    13     9     4    10
## # … with 32 more rows</code></pre>
<p>I think the best way to think about this is to start with what is
farthest from being a data frame or a vector (the matrix of principal
component scores, here), bash that into shape first, and then glue the
rest of the things to it.</p>
<p>Note that we used all Tidyverse stuff here, so the result is a
<code>tibble</code>, and displaying it for me displays the first ten rows as
you’d expect. (This may be different in an R Notebook, since I think
there you get the first ten rows anyway.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" style="list-style-type: lower-alpha">
<li>Display the row of your new data frame for the observation
with the smallest (most negative) score on component 1. Which row is
this? What makes this observation have the most negative score on
component 1?</li>
</ol>
<p>Solution</p>
<p>I think the best strategy is to sort by component 1 score (in the default ascending order), and then display the first row:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb387-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(Comp<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##   wind solar.radiation CO NO NO2 O3 HC    Comp.1    Comp.2     Comp.3     Comp.4     Comp.5    Comp.6    Comp.7 row
## 1    5              72  6  4  21 14  4 -3.981043 0.9262199 -0.3789783 -0.6185173 -0.8095277 -1.290318 0.7352476   8</code></pre>
<p>It’s row 8.</p>
<p>We said earlier that component 1 depends negatively on carbon monoxide
and nitrogen dioxide, so that an observation that is <em>low</em> on
component 1 should be <em>high</em> on these things.<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a></p>
<p>So are these values high or low? That was the reason for having you
make the five-number summary <a href="#part:fivenum">here</a>. For
observation 8, <code>CO</code> is 6 and <code>NO2</code> is 21; looking back
at the five-number summary, the value of <code>CO</code> is above Q3, and
the value of <code>NO2</code> is the highest of all. So this is entirely
what we’d expect.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol style="list-style-type: lower-roman">
<li>Which observation has the lowest (most negative) value on
component 2? Which variables ought to be high or low for this
observation? Are they? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>This is a repeat of the ideas we just saw:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb389-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(Comp<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##   wind solar.radiation CO NO NO2 O3 HC     Comp.1    Comp.2    Comp.3    Comp.4     Comp.5    Comp.6    Comp.7 row
## 1    6              75  4  1  10 24  3 -0.3848472 -2.331649 0.2453131 -1.765714 -0.4522935 0.0884973 0.6669804  34</code></pre>
<p>and for convenience, we’ll grab the quantiles again:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb391-1" title="1">air <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb391-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), <span class="op">~</span><span class="kw">quantile</span>(.)))</a></code></pre></div>
<pre><code>## # A tibble: 5 x 7
##    wind solar.radiation    CO    NO   NO2    O3    HC
##   &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  5               30       2     1   5     2       2
## 2  6               68.2     4     1   8     6       3
## 3  8               76.5     4     2   9.5   8.5     3
## 4  8.75            84.8     5     3  12    11       3
## 5 10              107       7     5  21    25       5</code></pre>
<p>Day 34 (at the end of the line). We said that component 2 depends (negatively) on solar
radiation and ozone and possibly positively on nitric oxide. This
means that day 34 ought to be <em>high</em> on the first two and low on
the last one (since it’s at the low end of component 2). Solar
radiation is, surprisingly, close to the median (75), but ozone, 24,
is very near the highest, and nitric oxide, 1, is one of a large
number of values equal to the lowest. So day 34 is pointing the right
way, even if its variable values are not quite what you’d expect.
This business about figuring out whether values on variables are high
or low is kind of fiddly, since you have to refer back to the
five-number summary to see where the values for a particular
observation come. Another way to approach this is to calculate
<em>percentile ranks</em> for everything. Let’s go back to our original data frame and replace everything with its percent rank:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb393-1" title="1">air <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), <span class="op">~</span><span class="st"> </span><span class="kw">percent_rank</span>(.))) -&gt;<span class="st"> </span>pct_rank</a>
<a class="sourceLine" id="cb393-2" title="2">pct_rank</a></code></pre></div>
<pre><code>## # A tibble: 42 x 7
##     wind solar.radiation    CO    NO   NO2    O3    HC
##    &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.488           0.951 0.902 0.317 0.707 0.439 0    
##  2 0.317           1     0.146 0.683 0.366 0.171 0.171
##  3 0.317           0.976 0.146 0.683 0     0.244 0.171
##  4 0.878           0.829 0.610 0.317 0.244 0.878 0.780
##  5 0.122           0.902 0.146 0.317 0.244 0.561 0.171
##  6 0.488           0.878 0.610 0.317 0.707 0.780 0.780
##  7 0.756           0.707 0.902 0.878 0.707 0.878 1    
##  8 0               0.390 0.829 0.878 1     0.829 0.780
##  9 0.317           0.659 0.610 0     0.610 0.707 0.171
## 10 0.488           0.195 0.610 0.317 0.829 0.512 0.780
## # … with 32 more rows</code></pre>
<p>Observation 34 is row 34 of this:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb395-1" title="1">pct_rank <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">34</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##    wind solar.radiation    CO    NO   NO2    O3    HC
##   &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0.122           0.463 0.146     0 0.512 0.976 0.171</code></pre>
<p>Very high on ozone, (joint) lowest on nitric oxide, but middling on
solar radiation.
The one we looked at before, observation 8, is this:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" title="1">pct_rank <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">8</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##    wind solar.radiation    CO    NO   NO2    O3    HC
##   &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0           0.390 0.829 0.878     1 0.829 0.780</code></pre>
<p>High on carbon monoxide, the highest on nitrogen dioxide.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="10" style="list-style-type: lower-alpha">
<li>Obtain a biplot, with the row numbers labelled, and explain briefly how your conclusions from the previous two parts are consistent with it.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" title="1"><span class="kw">ggbiplot</span>(air<span class="fl">.1</span>, <span class="dt">labels =</span> d<span class="op">$</span>row)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-227-1.png" width="672" /></p>
<p>Day 8 is way over on the left. The things that point in the direction
of observation 8 (<code>NO2, CO</code> and to a lesser extent <code>NO</code>
and <code>HC</code>) are the things that observation 8 is high on. On the
other hand, observation 8 is around the middle of the arrows for
<code>wind</code>, <code>solar.radiation</code> and <code>O3</code>, so that day
is not especially remarkable for those.</p>
<p>Observation 34 is
nearest the bottom, so we’d expect it to be high on ozone (yes), high
on solar radiation (no), low on nitric oxide (since that points the
most upward, yes) and also maybe low on wind, since observation 34 is
at the “back end” of that arrow. Wind is 6, which is at the first
quartile, low indeed.</p>
<p>The other thing that you see from the biplot is that there are four
variables pointing more or less up and to the left, and at right
angles to them, three other variables pointing up-and-right or
down-and-left. You could imagine rotating those arrows so that the
group of 4 point upwards, and the other three point left and
right. This is what factor analysis does, so you might imagine that
this technique might give a clearer picture of which variables belong
in which factor than principal components does. Hence what follows.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="11" style="list-style-type: lower-alpha">
<li>Run a factor analysis on the same data, obtaining two factors. Look at the factor loadings. Is it clearer which variables belong to which factor, compared to the principal components analysis? Explain briefly.</li>
</ol>
<p>Solution</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb400-1" title="1">air<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">factanal</span>(air, <span class="dv">2</span>, <span class="dt">scores =</span> <span class="st">&quot;r&quot;</span>)</a>
<a class="sourceLine" id="cb400-2" title="2">air<span class="fl">.2</span><span class="op">$</span>loadings</a></code></pre></div>
<pre><code>## 
## Loadings:
##                 Factor1 Factor2
## wind            -0.176  -0.249 
## solar.radiation          0.319 
## CO               0.797   0.391 
## NO               0.692  -0.152 
## NO2              0.602   0.152 
## O3                       0.997 
## HC               0.251   0.147 
## 
##                Factor1 Factor2
## SS loadings      1.573   1.379
## Proportion Var   0.225   0.197
## Cumulative Var   0.225   0.422</code></pre>
<p>I got the factor scores since I’m going to look at a biplot
shortly. If you aren’t, you don’t need them.</p>
<p>Factor 1 is rather more clearly carbon monoxide, nitric oxide and
nitrogen dioxide. Factor 2 is mostly ozone, with a bit of solar
radiation and carbon monoxide. I’d say this is clearer than before.</p>
<p>A biplot would tell us whether the variables are better aligned with
the axes now:</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb402-1" title="1"><span class="kw">biplot</span>(air<span class="fl">.2</span><span class="op">$</span>scores, air<span class="fl">.2</span><span class="op">$</span>loadings)</a></code></pre></div>
<p><img src="pasias_files/figure-html/unnamed-chunk-229-1.png" width="672" /></p>
<p>At least somewhat. Ozone points straight up, since it is the dominant part of factor 2 and not part of factor 1 at all. Carbon monoxide and the two oxides of nitrogen point to the right.</p>
<p>Extra:
<code>wind</code>, <code>solar.radiation</code> and <code>HC</code> don’t appear
in either of our factors, which also shows up here:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" title="1">air<span class="fl">.2</span><span class="op">$</span>uniquenesses</a></code></pre></div>
<pre><code>##            wind solar.radiation              CO              NO             NO2              O3              HC 
##       0.9070224       0.8953343       0.2126417       0.4983564       0.6144170       0.0050000       0.9152467</code></pre>
<p>Those variables all have <em>high</em> uniquenesses.</p>
<p>What with the high uniquenesses, and the fact that two factors explain
only 42% of the variability, we
really ought to look at 3 factors, the same way that we said we should look at
3 components:</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" title="1">air<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">factanal</span>(air, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb405-2" title="2">air<span class="fl">.3</span><span class="op">$</span>loadings</a></code></pre></div>
<pre><code>## 
## Loadings:
##                 Factor1 Factor2 Factor3
## wind                    -0.210  -0.334 
## solar.radiation          0.318         
## CO               0.487   0.318   0.507 
## NO               0.238  -0.269   0.931 
## NO2              0.989                 
## O3                       0.987   0.124 
## HC               0.427   0.103   0.172 
## 
##                Factor1 Factor2 Factor3
## SS loadings      1.472   1.312   1.288
## Proportion Var   0.210   0.187   0.184
## Cumulative Var   0.210   0.398   0.582</code></pre>
<p>In case you are wondering, <code>factanal</code> automatically uses the
correlation matrix, and so takes care of variables measured on
different scales without our having to worry about that.</p>
<p>The rotation has only helped somewhat here. Factor 1 is mainly
<code>NO2</code> with some influence of <code>CO</code> and <code>HC</code>;
factor 2 is mainly ozone (with a bit of solar radiation and carbon monoxide),
and factor 3 is mainly <code>NO</code> with a bit of <code>CO</code>.</p>
<p>I think I mentioned most of the variables in there, so the uniquenesses
should not be too bad:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" title="1">air<span class="fl">.3</span><span class="op">$</span>uniquenesses</a></code></pre></div>
<pre><code>##            wind solar.radiation              CO              NO             NO2              O3              HC 
##       0.8404417       0.8905074       0.4046425       0.0050000       0.0050000       0.0050000       0.7776557</code></pre>
<p>Well, not great: <code>wind</code> and <code>solar.radiation</code> still have
high uniquenesses because they are not <em>strongly</em> part of any
factors.</p>
<p>If you wanted to, you could obtain the factor scores for the 3-factor
solution, and plot them on a three-dimensional plot using
<code>rgl</code>, rotating them to see the structure. A three dimensional
“biplot”<a href="#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a>
would also be a cool thing to look at.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="38">
<li id="fn38"><p>There are two types of scores here: a person’s scores on the psychological test, 1 through 5, and their factor scores, which are decimal numbers centred at zero. Try not to get these confused.<a href="factor-analysis.html#fnref38" class="footnote-back">↩</a></p></li>
<li id="fn39"><p>I think the last four items in the entire survey are different; otherwise the total number of items would be a multiple of 5.<a href="factor-analysis.html#fnref39" class="footnote-back">↩</a></p></li>
<li id="fn40"><p>Not to be confused with <em>covfefe</em>, which was current news when I wrote this question.<a href="factor-analysis.html#fnref40" class="footnote-back">↩</a></p></li>
<li id="fn41"><p>There is also kind of an elbow at 4, which would suggest three factors, but that’s really too many with only 5 variables. That wouldn’t be much of a <em>reduction</em> in the number of variables, which is what principal components is trying to achieve.<a href="factor-analysis.html#fnref41" class="footnote-back">↩</a></p></li>
<li id="fn42"><p>In computer science terms, a data frame is said to <strong>inherit</strong> from a list: it is a list plus extra stuff.<a href="factor-analysis.html#fnref42" class="footnote-back">↩</a></p></li>
<li id="fn43"><p>There really ought to be a radio station <em>CTDY: All Tidyverse, All The Time</em>.<a href="factor-analysis.html#fnref43" class="footnote-back">↩</a></p></li>
<li id="fn44"><p>You might have said that component 1 depended on other things as well, in which case you ought to consider whether observation 8 is, as appropriate, high or low on these as well.<a href="factor-analysis.html#fnref44" class="footnote-back">↩</a></p></li>
<li id="fn45"><p>A three-dimensional biplot ought to be called a <em>triplot</em>.<a href="factor-analysis.html#fnref45" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="principal-components.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="frequency-table-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["pasias.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

---
title: "Problems and Solutions in Applied Statistics"
author: "Ken Butler"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: []
biblio-style: apalike
link-citations: yes
github-repo: nxskok/pasias
url: 'http://ritsokiguess.site/pasias'
description: "A set of problems and solutions, in R, on various parts of applied statistics"
output:
  pdf_document:
    toc: true
    toc_depth: 2
---

# Introduction {-}


[This book](http://ritsokiguess.site/pasias/) contains a collection
of problems, and my solutions to them, in applied statistics with
R. These come from my courses STAC32, STAC33, and STAD29 at the University of
Toronto Scarborough. 

The problems were originally written in Sweave (that is, LaTeX with R
code chunks), using the `exam` document class, using data sets stolen
from numerous places (textbooks, websites etc).  I wrote [a Perl
program](https://raw.githubusercontent.com/nxskok/pasias/master/convert.pl)
to strip out the LaTeX and turn each problem into R Markdown for this
book. You will undoubtedly see bits of LaTeX still embedded in the
text. I am trying to update my program to catch them, but I am sure to
miss some. 

You will occasionally
see question parts beginning with a *; this means that other question
parts refer back to this one. (One of my favourite question strategies
is to ask how two different approaches lead to the same answer, or
more generally to demonstrate that there are different ways to see the
same thing.)

Thanks to Dann Sioson for spotting some errors and making some useful suggestions.

If *you* see anything, [file an
issue](https://github.com/nxskok/pasias/issues) on the Github page for
now. Likely
problems include:

- some LaTeX construction that I didn't catch (eg. block quotes)
- disappeared footnotes (that will show up as an apparently missing sentence in the text)
- references to "in class" or a lecture or a course by course number, which need to be eliminated (in favour of wording like "a previous course")
- references to other questions or question parts that are *wrong* (likely caused by *not* being "labels" or "refs" in the original LaTeX)
- my contorted English that is difficult to understand.

As I read through looking for problems like these, I realize that
there ought to be a textbook that reflects my way of doing
things. There isn't one (yet), though there are lecture
notes. Current versions of these are at:

- [the STAC32 website](http://ritsokiguess.site/STAC32/)
- [the STAC33 website](http://ritsokiguess.site/STAC33/)
- [the STAD29 website](http://ritsokiguess.site/STAD29/)

A little background:

STAC32 is an introduction to R as
applied to statistical methods that have (mostly) been learned in
previous courses. This course is designed for students who have a second non-mathematical applied statistics course 
such as
[this](https://utsc.calendar.utoronto.ca/course/stab27h3). The idea is
that students have already seen a little of regression and analysis of
variance (and the things that precede them), and need mainly an
introduction of how to run them in R.

STAC33 is an introduction to R, and applied statistics in general, for students who have a background in mathematical statistics. The way our courses are structured, these students have a strong mathematical background, but not very much experience in applications, which this course is designed to provide. The material covered is similar to STAC32, with a planned addition of some ideas in bootstrap and practical Bayesian statistics. There are some questions on these here.

STAD29 is an overview of a number of advanced statistical methods. I
start from regression and proceed to some regression-like methods
(logistic regression, survival analysis, log-linear frequency table
analysis), then I go a little further with analysis of variance and
proceed with MANOVA and repeated measures. I finish with a look at
classical multivariate methods such as discriminant analysis, cluster
analysis, principal components and factor analysis. I cover a number
of methods in no great depth; my aim is to convey an understanding of
what these methods are for, how to run them and how to interpret the
results. Statistics majors and specialists cannot take this course for
credit (they have separate courses covering this material with the
proper mathematical background). D29 is intended for students in other
disciplines who find themselves wanting to learn more statistics; we
have an [Applied Statistics Minor
program](https://utsc.calendar.utoronto.ca/minor-program-applied-statistics-science)
for which C32 and D29 are two of the last courses.

## Packages used somewhere in this book {-}

The bottom lines are below used with the `conflicted` package: if a function by
the name shown is in two or more packages, prefer the one from the
package shown.

```{r index-1, eval=F}
library(tidyverse)
library(smmr)
library(MASS)
library(nnet)
library(survival)
library(survminer)
library(car)
library(lme4)
library(ggbiplot)
library(ggrepel)
library(broom)
library(rpart)
library(bootstrap)
library(cmdstanr)
library(posterior)
library(bayesplot)
library(tmaptools)
library(leaflet)
library(conflicted)
conflict_prefer("summarize", "dplyr")
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("mutate", "dplyr")
conflict_prefer("count", "dplyr")
conflict_prefer("arrange", "dplyr")
conflict_prefer("rename", "dplyr")
conflict_prefer("id", "dplyr")
```


<!--chapter:end:index.Rmd-->


# Getting used to R and R Studio

My solutions follow the problems. Look ahead if you get stuck. Don't forget `library(tidyverse)` if you need it: 

```{r, child="packages.Rmd"}
```

```{r, child="jupyter.Rmd"}
```

```{r, child="r-signup_qq.Rmd"}
```

```{r, child="r0_qq.Rmd"}
```


```{r, child="r0a_qq.Rmd"}
```

```{r different-ways, child="different-ways_qq.Rmd"}
```

My solutions follow: 

```{r, child="r-signup.Rmd"}
```

```{r, child="r0.Rmd"}
```

```{r, child="r0a.Rmd"}
```

```{r different-ways, child="different-ways.Rmd"}
```




<!--chapter:end:01-getting-used.Rmd-->


# Reading in data

In this chapter, and from here on, the questions are first, and then my answers are in the second appearances of the problems with the same name. 
It is much better for your learning to spend some time thinking about how you would solve these problems, and after *that* you can see how I did it.

```{r 02-reading-in-1, eval=F}
library(tidyverse)
```

```{r 02-reading-in-2, child="packages.Rmd"}
```


```{r 02-reading-in-3, child="oj_qq.Rmd"}
```

```{r 02-reading-in-4, child="soap_qq.Rmd"}
```

```{r 02-reading-in-5, child="global_qq.Rmd"}
```


My solutions follow:

```{r 02-reading-in-6, child="oj.Rmd"}
```

```{r 02-reading-in-7, child="soap.Rmd"}
```

```{r 02-reading-in-8, child="global.Rmd"}
```



<!--chapter:end:02-reading-in.Rmd-->


# Drawing graphs

```{r 32-making-graphs-1, eval=F}
library(tidyverse)
```

```{r 32-making-graphs-2, child="packages.Rmd"}
```


```{r 32-making-graphs-3, child="oj2_qq.Rmd"}
```

```{r 32-making-graphs-4, child="soap2_qq.Rmd"}
```

```{r 32-making-graphs-5, child="global2_qq.Rmd"}
```

```{r 32-making-graphs-6, child="rainfall2_qq.Rmd"}
```


```{r 32-making-graphs-7, child="exercise_qq.Rmd"}
```


My solutions follow:

```{r 32-making-graphs-8, child="oj2.Rmd"}
```

```{r 32-making-graphs-9, child="soap2.Rmd"}
```

```{r 32-making-graphs-10, child="global2.Rmd"}
```

```{r 32-making-graphs-11, child="rainfall2.Rmd"}
```

```{r 32-making-graphs-12, child="exercise.Rmd"}
```


<!--chapter:end:32-making-graphs.Rmd-->

# Data exploration

```{r 03-data-summaries-1, eval=F}
library(tidyverse)
```

```{r 03-data-summaries-2, child="packages.Rmd"}
```


```{r 03-data-summaries-3, child="ncbirths_qq.Rmd"}
```

```{r 03-data-summaries-4, child="ncbirths-extra_qq.Rmd"}
```

```{r 03-data-summaries-5, child="nenana_qq.Rmd"}
```

```{r 03-data-summaries-6, child="compatt_qq.Rmd"}
```

```{r 03-data-summaries-7, child="thomas_qq.Rmd"}
```

```{r 03-data-summaries-8, child="rainfall_qq.Rmd"}
```

```{r 03-data-summaries-9, child="algebra_qq.Rmd"}
```

My solutions follow:

```{r 03-data-summaries-10, child="ncbirths.Rmd"}
```

```{r 03-data-summaries-11, child="ncbirths-extra.Rmd"}
```

```{r 03-data-summaries-12, child="nenana.Rmd"}
```

```{r 03-data-summaries-13, child="compatt.Rmd"}
```

```{r 03-data-summaries-14, child="thomas.Rmd"}
```

```{r 03-data-summaries-15, child="rainfall.Rmd"}
```

```{r 03-data-summaries-16, child="algebra.Rmd"}
```


<!--chapter:end:03-data-summaries.Rmd-->

# Working with dataframes

```{r 31-working-with-dataframes-1, eval=F}
library(tidyverse)
```

```{r 31-working-with-dataframes-2, child="packages.Rmd"}
```

```{r 31-working-with-dataframes-3, child="jays-dplyr_qq.Rmd"}
```

```{r 31-working-with-dataframes-4,child="kencars_qq.Rmd"}
```

```{r 31-working-with-dataframes-5, child="dolphins_qq.Rmd"}
```

My solutions follow:

```{r 31-working-with-dataframes-6, child="jays-dplyr.Rmd"}
```

```{r 31-working-with-dataframes-7,child="kencars.Rmd"}
```

```{r 31-working-with-dataframes-8, child="dolphins.Rmd"}
```




<!--chapter:end:31-working-with-dataframes.Rmd-->

# One-sample inference

```{r 04-one-sample-inference-1, eval=F}
library(tidyverse)
```

```{r 04-one-sample-inference-2, child="packages.Rmd"}
```

```{r 04-one-sample-inference-3, child="hg_qq.Rmd"}
```

```{r 04-one-sample-inference-4, child="boulder_qq.Rmd"}
```

```{r 04-one-sample-inference-5, child="ncbirths-inf_qq.Rmd"}
```

```{r 04-one-sample-inference-6, child="nenana-inf_qq.Rmd"}
```

```{r 04-one-sample-inference-7, child="trees_qq.Rmd"}
```

```{r 04-one-sample-inference-8, child="cholest_qq.Rmd"}
```

\setcounter{chapter}{1}

My solutions follow:

```{r 04-one-sample-inference-9, child="hg.Rmd"}
```

```{r 04-one-sample-inference-10, child="boulder.Rmd"}
```

```{r 04-one-sample-inference-11, child="ncbirths-inf.Rmd"}
```

```{r 04-one-sample-inference-12, child="nenana-inf.Rmd"}
```

```{r 04-one-sample-inference-13, child="trees.Rmd"}
```

```{r 04-one-sample-inference-14, child="cholest.Rmd"}
```


<!--chapter:end:04-one-sample-inference.Rmd-->

# Two-sample inference

```{r 05-two-sample-inference-1, eval=F}
library(tidyverse)
```

```{r 05-two-sample-inference-2, child="packages.Rmd"}
```


```{r 05-two-sample-inference-3, child="devices-r_qq.Rmd"}
```

```{r 05-two-sample-inference-4, child="parking_qq.Rmd"}
```

```{r 05-two-sample-inference-5, child="bellpepper_qq.Rmd"}
```

```{r 05-two-sample-inference-6, child="mousebully_qq.Rmd"}
```

```{r 05-two-sample-inference-7, child="kids-diet_qq.Rmd"}
```

```{r 05-two-sample-inference-8, child="handspan_qq.Rmd"}
```

```{r 05-two-sample-inference-9, child="ozvus_qq.Rmd"}
```

My solutions follow:

```{r 05-two-sample-inference-10, child="devices-r.Rmd"}
```

```{r 05-two-sample-inference-11, child="parking.Rmd"}
```

```{r 05-two-sample-inference-12, child="bellpepper.Rmd"}
```

```{r 05-two-sample-inference-13, child="mousebully.Rmd"}
```

```{r 05-two-sample-inference-14, child="kids-diet.Rmd"}
```

```{r 05-two-sample-inference-15, child="handspan.Rmd"}
```

```{r 05-two-sample-inference-16, child="ozvus.Rmd"}
```


<!--chapter:end:05-two-sample-inference.Rmd-->

# Power and sample size

```{r 06-power-1, eval=F}
library(tidyverse)
```

```{r 06-power-2, child="packages.Rmd"}
```


```{r 06-power-3, child="power-sim_qq.Rmd"}
```

```{r 06-power-4, child="power20_qq.Rmd"}
```

```{r 06-power-5, child="proportion-power-sim_qq.Rmd"}
```

```{r 06-power-6, child="mean_two_qq.Rmd"}
```

```{r 06-power-7, child="pop_power_qq.Rmd"}
```

My solutions follow:

```{r 06-power-8, child="power-sim.Rmd"}
```

```{r 06-power-9, child="power20.Rmd"}
```

```{r 06-power-10, child="proportion-power-sim.Rmd"}
```

```{r 06-power-11, child="mean_two.Rmd"}
```

```{r 06-power-12, child="pop_power.Rmd"}
```


<!--chapter:end:06-power.Rmd-->

# The sign test

```{r 07-sign-1}
library(tidyverse)
library(smmr)
```

```{r 07-sign-2, child="packages.Rmd"}
```


```{r 07-sign-3, child="maze_qq.Rmd"}
```

```{r 07-sign-4, child="cookies-r_qq.Rmd"}
```

```{r 07-sign-5, child="signpower_qq.Rmd"}
```

```{r 07-sign-6, child="roethlisberger_qq.Rmd"}
```

```{r 07-sign-7, child="protein_qq.Rmd"}
```


My solutions follow:

```{r 07-sign-8, child="maze.Rmd"}
```

```{r 07-sign-9, child="cookies-r.Rmd"}
```

```{r 07-sign-10, child="signpower.Rmd"}
```

```{r 07-sign-11, child="roethlisberger.Rmd"}
```

```{r 07-sign-12, child="protein.Rmd"}
```


<!--chapter:end:07-sign.Rmd-->

# Mood median test

```{r 33-mood-median-1}
library(tidyverse)
library(smmr)
```

```{r 33-mood-median-2, child="packages.Rmd"}
```


```{r 33-mood-median-3, child="cerealsugar_qq.Rmd"}
```

```{r 33-mood-median-4, child="mathphobia_qq.Rmd"}
```

```{r 33-mood-median-5, child="forehead_qq.Rmd"}
```

```{r 33-mood-median-6, child="handspan2_qq.Rmd"}
```


My solutions follow:

```{r 33-mood-median-7, child="cerealsugar.Rmd"}
```

```{r 33-mood-median-8, child="mathphobia.Rmd"}
```

```{r 33-mood-median-9, child="forehead.Rmd"}
```

```{r 33-mood-median-10, child="handspan2.Rmd"}
```


<!--chapter:end:33-mood-median.Rmd-->

# Matched pairs t and sign test

```{r 08-matched-pairs-sign-1, eval=F}
library(tidyverse)
library(smmr)
```

```{r 08-matched-pairs-sign-2, child="packages.Rmd"}
```


```{r 08-matched-pairs-sign-3, child="bodyfat_qq.Rmd"}
```

```{r 08-matched-pairs-sign-4, child="baseball-softball-r_qq.Rmd"}
```

```{r 08-matched-pairs-sign-5, child="throw_qq.Rmd"}
```


```{r 08-matched-pairs-sign-6, child="salaryinc_qq.Rmd"}
```

```{r 08-matched-pairs-sign-7, child="bodyfat-sign_qq.Rmd"}
```

```{r 08-matched-pairs-sign-8, child="blood_pressure_paired_qq.Rmd"}
```

```{r 08-matched-pairs-sign-9, child="french_qq.Rmd"}
```

My solutions follow:


```{r 08-matched-pairs-sign-10, child="bodyfat.Rmd"}
```

```{r 08-matched-pairs-sign-11, child="baseball-softball-r.Rmd"}
```

```{r 08-matched-pairs-sign-12, child="throw.Rmd"}
```


```{r 08-matched-pairs-sign-13, child="salaryinc.Rmd"}
```

```{r 08-matched-pairs-sign-14, child="bodyfat-sign.Rmd"}
```

```{r 08-matched-pairs-sign-15, child="blood_pressure_paired.Rmd"}
```

```{r 08-matched-pairs-sign-16, child="french.Rmd"}
```


<!--chapter:end:08-matched-pairs-sign.Rmd-->

# Normal quantile plots

```{r 09-normal-quantile-1, eval=F}
library(tidyverse)
```

```{r 09-normal-quantile-2, child="packages.Rmd"}
```


```{r 09-normal-quantile-3, child="heliconia_qq.Rmd"}
```

```{r 09-normal-quantile-4, child="aus-qq_qq.Rmd"}
```

My solutions follow:

```{r 09-normal-quantile-5, child="heliconia.Rmd"}
```

```{r 09-normal-quantile-6, child="aus-qq.Rmd"}
```

<!--chapter:end:09-normal-quantile.Rmd-->

# Analysis of variance

```{r 10-analysis-of-variance-1, eval=F}
library(tidyverse)
```

```{r 10-analysis-of-variance-2, child="packages.Rmd"}
```


```{r 10-analysis-of-variance-3, child="movies-r_qq.Rmd"}
```

```{r 10-analysis-of-variance-4, child="deer_qq.Rmd"}
```

```{r 10-analysis-of-variance-5, child="movies2_qq.Rmd"}
```

```{r 10-analysis-of-variance-6, child="carbon_qq.Rmd"}
```

```{r 10-analysis-of-variance-7, child="caffeine_qq.Rmd"}
```

```{r 10-analysis-of-variance-8, child="reggae_qq.Rmd"}
```

```{r 10-analysis-of-variance-9, child="gss_tv_qq.Rmd"}
```

```{r 10-analysis-of-variance-10, child="writers_qq.Rmd"}
```

```{r 10-analysis-of-variance-11, child="relig_qq.Rmd"}
```

My solutions follow:

```{r 10-analysis-of-variance-12, child="movies-r.Rmd"}
```

```{r 10-analysis-of-variance-13, child="deer.Rmd"}
```

```{r 10-analysis-of-variance-14, child="movies2.Rmd"}
```

```{r 10-analysis-of-variance-15, child="carbon.Rmd"}
```

```{r 10-analysis-of-variance-16, child="caffeine.Rmd"}
```

```{r 10-analysis-of-variance-17, child="reggae.Rmd"}
```

```{r 10-analysis-of-variance-18, child="gss_tv.Rmd"}
```

```{r 10-analysis-of-variance-19, child="writers.Rmd"}
```

```{r 10-analysis-of-variance-20, child="relig.Rmd"}
```


<!--chapter:end:10-analysis-of-variance.Rmd-->

# Writing reports

```{r 34-reports-1, eval=F}
library(tidyverse)
```

```{r 34-reports-2, child="packages.Rmd"}
```


```{r 34-reports-3, child="carbon_qq.Rmd"}
```

```{r 34-reports-4, child="sparrowhawk_qq.Rmd"}
```

```{r 34-reports-5, child="proggo_qq.Rmd"}
```

```{r 34-reports-6, child="dandruff_qq.Rmd"}
```


My solutions follow. The example reports on coding and treating dandruff are separate chapters.

```{r 34-reports-7, child="carbon.Rmd"}
```

```{r 34-reports-8, child="sparrowhawk.Rmd"}
```


<!--chapter:end:34-reports.Rmd-->

# Learning to code

```{r 61-coding-1, eval=F}
library(tidyverse)
```

```{r 61-coding-2, child="packages.Rmd"}
```

```{r 61-coding-3, child="proggo.Rmd"}
```


<!--chapter:end:61-coding.Rmd-->

# Treating dandruff

```{r 62-dandruff-1, child="packages.Rmd"}
```

```{r 62-dandruff-2, child="dandruff.Rmd"}
```

<!--chapter:end:62-dandruff.Rmd-->

# Tidying data

```{r 11-tidying-data-1, eval=F}
library(tidyverse)
```

```{r 11-tidying-data-2, child="packages.Rmd"}
```


```{r 11-tidying-data-3, child="throw-spaghetti_qq.Rmd"}
```

```{r 11-tidying-data-4, child="ethanol_qq.Rmd"}
```

```{r 11-tidying-data-5, child="tomatoes_qq.Rmd"}
```

```{r 11-tidying-data-6,child="migraine_qq.Rmd"}
```

```{r 11-tidying-data-7,child="plants_qq.Rmd"}
```

```{r 11-tidying-data-8,child="crickets_qq.Rmd"}
```



```{r 11-tidying-data-9, child="billboard_qq.Rmd"}
```

```{r 11-tidying-data-10, child="bikes_qq.Rmd"}
```

```{r 11-tidying-data-11, child="heat-r_qq.Rmd"}
```

```{r 11-tidying-data-12, child="isoflavones_qq.Rmd"}
```

```{r 11-tidying-data-13, child="jocko_qq.Rmd"}
```


```{r 11-tidying-data-14, child="util_temp_qq.Rmd"}
```

```{r 11-tidying-data-15, child="blood_pressure_tidy_qq.Rmd"}
```


My solutions follow:

```{r 11-tidying-data-16, child="throw-spaghetti.Rmd"}
```

```{r 11-tidying-data-17, child="ethanol.Rmd"}
```

```{r 11-tidying-data-18, child="tomatoes.Rmd"}
```

```{r 11-tidying-data-19,child="migraine.Rmd"}
```

```{r 11-tidying-data-20,child="plants.Rmd"}
```

```{r 11-tidying-data-21,child="crickets.Rmd"}
```



```{r 11-tidying-data-22, child="billboard.Rmd"}
```

```{r 11-tidying-data-23, child="bikes.Rmd"}
```

```{r 11-tidying-data-24, child="heat-r.Rmd"}
```

```{r 11-tidying-data-25, child="isoflavones.Rmd"}
```

```{r 11-tidying-data-26, child="jocko.Rmd"}
```

```{r 11-tidying-data-27, child="util_temp.Rmd"}
```

```{r 11-tidying-data-28, child="blood_pressure_tidy.Rmd"}
```


<!--chapter:end:11-tidying-data.Rmd-->

# Simple regression

```{r 12-simple-regression-1, eval=F}
library(tidyverse)
```

```{r 12-simple-regression-2, child="packages.Rmd"}
```


```{r 12-simple-regression-3,child="calirain_qq.Rmd"}
```

```{r 12-simple-regression-4,child="ftccigar_qq.Rmd"}
```


```{r 12-simple-regression-5, child="youngboys_qq.Rmd"}
```



```{r 12-simple-regression-6, child="fbfriends_qq.Rmd"}
```

```{r 12-simple-regression-7, child="carp_qq.Rmd"}
```



```{r 12-simple-regression-8, child="socwork_qq.Rmd"}
```

```{r 12-simple-regression-9, child="pinetrees_qq.Rmd"}
```

```{r 12-simple-regression-10, child="tortoise_qq.Rmd"}
```


```{r 12-simple-regression-11, child="coasters_qq.Rmd"}
```

```{r 12-simple-regression-12, child="diabetic_qq.Rmd"}
```

```{r 12-simple-regression-13, child="pizza_qq.Rmd"}
```

```{r 12-simple-regression-14, child="fire_damage_qq.Rmd"}
```


```{r 12-simple-regression-15, child="braking_qq.Rmd"}
```

```{r 12-simple-regression-16, child="heightfoot_qq.Rmd"}
```


My solutions follow:

```{r 12-simple-regression-17,child="calirain.Rmd"}
```

```{r 12-simple-regression-18,child="ftccigar.Rmd"}
```


```{r 12-simple-regression-19, child="youngboys.Rmd"}
```



```{r 12-simple-regression-20, child="fbfriends.Rmd"}
```

```{r 12-simple-regression-21, child="carp.Rmd"}
```



```{r 12-simple-regression-22, child="socwork.Rmd"}
```

```{r 12-simple-regression-23, child="pinetrees.Rmd"}
```

```{r 12-simple-regression-24, child="tortoise.Rmd"}
```


```{r 12-simple-regression-25, child="coasters.Rmd"}
```

```{r 12-simple-regression-26, child="diabetic.Rmd"}
```

```{r 12-simple-regression-27, child="pizza.Rmd"}
```

```{r 12-simple-regression-28, child="fire_damage.Rmd"}
```

```{r 12-simple-regression-29, child="braking.Rmd"}
```

```{r 12-simple-regression-30, child="heightfoot.Rmd"}
```


<!--chapter:end:12-simple-regression.Rmd-->

# Multiple regression

```{r 35-multiple-regression-1, eval=F}
library(tidyverse)
```

```{r 35-multiple-regression-2, child="packages.Rmd"}
```


```{r 35-multiple-regression-3, child="hospital_qq.Rmd"}
```

```{r 35-multiple-regression-4, child="chemical_qq.Rmd"}
```

```{r 35-multiple-regression-5, child="mathsal_qq.Rmd"}
```

```{r 35-multiple-regression-6, child="gpa_qq.Rmd"}
```

```{r 35-multiple-regression-7, child="mercury_qq.Rmd"}
```


My solutions follow:

```{r 35-multiple-regression-8, child="hospital.Rmd"}
```

```{r 35-multiple-regression-9, child="chemical.Rmd"}
```

```{r 35-multiple-regression-10, child="mathsal.Rmd"}
```

```{r 35-multiple-regression-11, child="gpa.Rmd"}
```

```{r 35-multiple-regression-12, child="mercury.Rmd"}
```


<!--chapter:end:35-multiple-regression.Rmd-->

# Regression with categorical variables

```{r 36-regression-categorical-1, eval=F}
library(tidyverse)
```

```{r 36-regression-categorical-2, child="packages.Rmd"}
```

```{r 36-regression-categorical-3, child="crickets-b_qq.Rmd"}
```

```{r 36-regression-categorical-4, child="pulsemarch_qq.Rmd"}
```

My solutions follow:

```{r 36-regression-categorical-5, child="crickets-b.Rmd"}
```

```{r 36-regression-categorical-6, child="pulsemarch.Rmd"}
```


<!--chapter:end:36-regression-categorical.Rmd-->

# Dates and times

The usual to begin with:

```{r 13-dates-and-times-1, eval=F}
library(tidyverse)
```

```{r 13-dates-and-times-2, child="packages.Rmd"}
```

```{r 13-dates-and-times-3, child="mizuna-r_qq.Rmd"}
```

```{r 13-dates-and-times-4, child="birthtypes_qq.Rmd"}
```

```{r 13-dates-and-times-5, child="denali-r_qq.Rmd"}
```

```{r 13-dates-and-times-6, child="whas_qq.Rmd"}
```

```{r 13-dates-and-times-7, child="sleeping_qq.Rmd"}
```


My solutions follow:

```{r 13-dates-and-times-8, child="mizuna-r.Rmd"}
```

```{r 13-dates-and-times-9, child="birthtypes.Rmd"}
```

```{r 13-dates-and-times-10, child="denali-r.Rmd"}
```

```{r 13-dates-and-times-11, child="whas.Rmd"}
```

```{r 13-dates-and-times-12, child="sleeping.Rmd"}
```


<!--chapter:end:13-dates-and-times.Rmd-->

# Functions

```{r 14-functions-1, eval=F}
library(tidyverse)
```

```{r 14-functions-2, child="packages.Rmd"}
```


```{r 14-functions-3, child="func_qq.Rmd"}
```

```{r 14-functions-4, child="hotpo_qq.Rmd"}
```


```{r 14-functions-5, child="cv_qq.Rmd"}
```

```{r 14-functions-6, child="rescale_qq.Rmd"}
```


My solutions follow:

```{r 14-functions-7, child="func.Rmd"}
```

```{r 14-functions-8, child="hotpo.Rmd"}
```

```{r 14-functions-9, child="cv.Rmd"}
```

```{r 14-functions-10, child="rescale.Rmd"}
```


<!--chapter:end:14-functions.Rmd-->

# Vector and matrix algebra

```{r 51-vector-matrix-1, eval=F}
library(tidyverse)
```

```{r 51-vector-matrix-2, child="packages.Rmd"}
```

```{r 51-vector-matrix-3, child="reg_qq.Rmd"}
```


My solutions follow:

```{r 51-vector-matrix-4, child="reg.Rmd"}
```


<!--chapter:end:51-vector-matrix.Rmd-->

# The Bootstrap

Packages for this chapter:

```{r 26-bootstrap-1, eval=F}
library(tidyverse)
library(bootstrap)
```

```{r 26-bootstrap-2, child="packages.Rmd", warning=F}
```

```{r 26-bootstrap-3, child="bootstrap_qq.Rmd"}
```

```{r 26-bootstrap-4, child="bootstrap_median_qq.Rmd"}
```

```{r 26-bootstrap-5, child="eyesight_qq.Rmd"}
```

```{r 26-bootstrap-6, child="boot-irs_qq.Rmd"}
```

My solutions follow:

```{r 26-bootstrap-7, child="bootstrap.Rmd"}
```

```{r 26-bootstrap-8, child="bootstrap_median.Rmd"}
```

```{r 26-bootstrap-9, child="eyesight.Rmd"}
```

```{r 26-bootstrap-10, child="boot-irs.Rmd"}
```


<!--chapter:end:26-bootstrap.Rmd-->

# Bayesian Statistics with Stan

Packages for this chapter:

```{r 27-stan-1, eval = FALSE}
library(tidyverse)
library(cmdstanr)
library(posterior)
library(bayesplot)
```

```{r 27-stan-2, child="packages.Rmd", warning=F}
```


```{r 27-stan-3, child="binomial_stan_qq.Rmd"}
```

```{r 27-stan-4, child="regression_stan_qq.Rmd"}
```

```{r 27-stan-5, child="bayesp_qq.Rmd"}
```

My solutions follow:

```{r 27-stan-6, child="binomial_stan.Rmd"}
```

```{r 27-stan-7, child="regression_stan.Rmd"}
```

```{r 27-stan-8, child="bayesp.Rmd"}
```


<!--chapter:end:27-stan.Rmd-->

# Logistic regression

```{r 15-logistic-regression-1, eval=F}
library(tidyverse)
```

```{r 15-logistic-regression-2, child="packages.Rmd"}
```


```{r 15-logistic-regression-3, wolfspider,child="wolfspider_qq.Rmd"}
```

```{r 15-logistic-regression-4, aphids, child="aphids_qq.Rmd"}
```

```{r 15-logistic-regression-5, doseresponse, child="doseresponse_qq.Rmd"}
```

```{r 15-logistic-regression-6, parasite, child="parasite_qq.Rmd"}
```

```{r 15-logistic-regression-7, ethics, child="ethics_qq.Rmd"}
```

```{r 15-logistic-regression-8, heart,  child="heart_qq.Rmd"}
```

```{r 15-logistic-regression-9, breastfeed, child="breastfeed_qq.Rmd"}
```

```{r 15-logistic-regression-10, donner, child="donner_qq.Rmd"}
```

```{r 15-logistic-regression-11, apache, child="apache_qq.Rmd"}
```

```{r 15-logistic-regression-12, ha2, child="ha2_qq.Rmd"}
```

My solutions follow:

```{r 15-logistic-regression-13, wolfspider,child="wolfspider.Rmd"}
```

```{r 15-logistic-regression-14, aphids, child="aphids.Rmd"}
```

```{r 15-logistic-regression-15, doseresponse, child="doseresponse.Rmd"}
```

```{r 15-logistic-regression-16, parasite, child="parasite.Rmd"}
```

```{r 15-logistic-regression-17, ethics, child="ethics.Rmd"}
```

```{r 15-logistic-regression-18, heart,  child="heart.Rmd"}
```

```{r 15-logistic-regression-19, breastfeed, child="breastfeed.Rmd"}
```

```{r 15-logistic-regression-20, donner, child="donner.Rmd"}
```

```{r 15-logistic-regression-21, apache, child="apache.Rmd"}
```

```{r 15-logistic-regression-22, ha2, child="ha2.Rmd"}
```


<!--chapter:end:15-logistic-regression.Rmd-->

# Logistic regression with ordinal response

```{r 16-ordinal-response-1, eval=F}
library(MASS)
library(tidyverse)
```
```{r 16-ordinal-response-2, child="packages.Rmd"}
```

```{r 16-ordinal-response-3, child="mobile_qq.Rmd"}
```


```{r 16-ordinal-response-4, child="nonmissing_qq.Rmd"}
```



```{r 16-ordinal-response-5, child="hsb_qq.Rmd"}
```


```{r 16-ordinal-response-6, child="steak_qq.Rmd"}
```

```{r 16-ordinal-response-7, child="steak-data_qq.Rmd"}
```

My solutions follow:

```{r 16-ordinal-response-8, child="mobile.Rmd"}
```


```{r 16-ordinal-response-9, child="nonmissing.Rmd"}
```



```{r 16-ordinal-response-10, child="hsb.Rmd"}
```


```{r 16-ordinal-response-11, child="steak.Rmd"}
```

```{r 16-ordinal-response-12, child="steak-data.Rmd"}
```

<!--chapter:end:16-ordinal-response.Rmd-->

# Logistic regression with nominal response

```{r 37-nominal-response-1, eval=F}
library(nnet)
library(tidyverse)
```
```{r 37-nominal-response-2, child="packages.Rmd"}
```

```{r 37-nominal-response-3, child="nonmissing_qq.Rmd"}
```

```{r 37-nominal-response-4, child="ess_qq.Rmd"}
```

```{r 37-nominal-response-5, child="alligator_qq.Rmd"}
```

```{r 37-nominal-response-6, child="sfcrime_qq.Rmd"}
```

```{r 37-nominal-response-7, child="sfcrime-data_qq.Rmd"}
```

```{r 37-nominal-response-8, child="oz-multi_qq.Rmd"}
```

My solutions follow:

```{r 37-nominal-response-9, child="nonmissing.Rmd"}
```

```{r 37-nominal-response-10, child="ess.Rmd"}
```

```{r 37-nominal-response-11, child="alligator.Rmd"}
```

```{r 37-nominal-response-12, child="sfcrime.Rmd"}
```

```{r 37-nominal-response-13, child="sfcrime-data.Rmd"}
```

```{r 37-nominal-response-14, child="oz-multi.Rmd"}
```


<!--chapter:end:37-nominal-response.Rmd-->

# Survival analysis

```{r 17-survival-analysis-1, eval=F}
library(survival)
library(tidyverse)
library(survminer)
```

```{r 17-survival-analysis-2, child="packages.Rmd"}
```

```{r 17-survival-analysis-3, child="worcester_qq.Rmd"}
```

```{r 17-survival-analysis-4, child="drug-treatment_qq.Rmd"}
```

```{r 17-survival-analysis-5, child="myeloma_qq.Rmd"}
```

```{r 17-survival-analysis-6, child="ovarian_qq.Rmd"}
```

My solutions follow:

```{r 17-survival-analysis-7, child="worcester.Rmd"}
```

```{r 17-survival-analysis-8, child="drug-treatment.Rmd"}
```

```{r 17-survival-analysis-9, child="myeloma.Rmd"}
```

```{r 17-survival-analysis-10, child="ovarian.Rmd"}
```


<!--chapter:end:17-survival-analysis.Rmd-->

# Analysis of variance revisited

Packages for this chapter:

```{r 18-anova-revisited-1, eval=F}
library(MASS)
library(car)
library(tidyverse)
```

```{r 18-anova-revisited-2, child="packages.Rmd"}
```


```{r 18-anova-revisited-3, child="acidrain_qq.Rmd"}
```

```{r 18-anova-revisited-4, child="hayfever_qq.Rmd"}
```

```{r 18-anova-revisited-5,child="caffeine-contrast_qq.Rmd"}
```

```{r 18-anova-revisited-6, child="studyhours_qq.Rmd"}
```

```{r 18-anova-revisited-7,child="mental-context_qq.Rmd"}
```

```{r 18-anova-revisited-8, child="shirts_qq.Rmd"}
```



My solutions follow:

```{r 18-anova-revisited-9, child="acidrain.Rmd"}
```

```{r 18-anova-revisited-10, child="hayfever.Rmd"}
```

```{r 18-anova-revisited-11,child="caffeine-contrast.Rmd"}
```

```{r 18-anova-revisited-12, child="studyhours.Rmd"}
```

```{r 18-anova-revisited-13,child="mental-context.Rmd"}
```

```{r 18-anova-revisited-14, child="shirts.Rmd"}
```





<!--chapter:end:18-anova-revisited.Rmd-->

# Analysis of covariance

Packages for this chapter:

```{r 38-ancova-1, eval=F}
library(MASS)
library(car)
library(tidyverse)
```

```{r 38-ancova-2, child="packages.Rmd"}
```



```{r 38-ancova-3, child="productivity_qq.Rmd"}
```

```{r 38-ancova-4, child="leprosy_qq.Rmd" }
```


My solutions follow:

```{r 38-ancova-5, child="productivity.Rmd"}
```

```{r 38-ancova-6, child="leprosy.Rmd" }
```




<!--chapter:end:38-ancova.Rmd-->

# Multivariate analysis of variance

Packages for this chapter:

```{r 19-manova-1, eval=F}
library(car)
library(tidyverse)
```

```{r 19-manova-2, child="packages.Rmd"}
```


```{r 19-manova-3,child="manova1_qq.Rmd"}
``` 

```{r 19-manova-4,child="urine_qq.Rmd"}
```   

```{r 19-manova-5, child="athletes-manova_qq.Rmd"}
```

My solutions follow:

```{r 19-manova-6,child="manova1.Rmd"}
``` 

```{r 19-manova-7,child="urine.Rmd"}
```   

```{r 19-manova-8, child="athletes-manova.Rmd"}
```


<!--chapter:end:19-manova.Rmd-->

# Repeated measures

Packages for this chapter:

```{r 20-repeated-measures-1, eval=F}
library(car)
library(lme4)
library(tidyverse)
```

```{r 20-repeated-measures-2, child="packages.Rmd"}
```


```{r 20-repeated-measures-3, child="ratweight_qq.Rmd"}
```


```{r 20-repeated-measures-4,child="geriatrics_qq.Rmd"}
``` 

```{r 20-repeated-measures-5, child="airport_qq.Rmd"}
``` 

```{r 20-repeated-measures-6, child="bodyfat2_qq.Rmd"}
``` 

```{r 20-repeated-measures-7, child="king_qq.Rmd"}
``` 

```{r 20-repeated-measures-8, child="rm_qq.Rmd"}
``` 

My solutions follow:

```{r 20-repeated-measures-9, child="ratweight.Rmd"}
```


```{r 20-repeated-measures-10,child="geriatrics.Rmd"}
``` 

```{r 20-repeated-measures-11, child="airport.Rmd"}
``` 

```{r 20-repeated-measures-12, child="bodyfat2.Rmd"}
``` 

```{r 20-repeated-measures-13, child="king.Rmd"}
``` 

```{r 20-repeated-measures-14, child="rm.Rmd"}
``` 

<!--chapter:end:20-repeated-measures.Rmd-->

# Discriminant analysis

Packages for this chapter:

```{r 21-discriminant-analysis-1, eval=F}
library(ggbiplot)
library(MASS)
library(tidyverse)
library(car)
```

(Note: `ggbiplot` loads `plyr`, which overlaps a lot with `dplyr`
(`filter`, `select` etc.). We want the `dplyr` stuff elsewhere, so we
load `ggbiplot` *first*, and the things in `plyr` get hidden, as shown
in the Conflicts. This, despite appearances, is what we want.)

```{r 21-discriminant-analysis-2, child="packages.Rmd"}
```


```{r 21-discriminant-analysis-3,child="swiss-money_qq.Rmd"}
``` 

```{r 21-discriminant-analysis-4,child="urine2_qq.Rmd"}
``` 

```{r 21-discriminant-analysis-5,child="manova1a_qq.Rmd"}
``` 
  
```{r 21-discriminant-analysis-6, child="jobs_qq.Rmd"}
```

```{r 21-discriminant-analysis-7, child="adhd_qq.Rmd"}
```

```{r 21-discriminant-analysis-8, child="cornseed_qq.Rmd"}
``` 

```{r 21-discriminant-analysis-9, child="athletes-d_qq.Rmd"}
``` 

My solutions follow:

```{r 21-discriminant-analysis-10,child="swiss-money.Rmd"}
``` 

```{r 21-discriminant-analysis-11,child="urine2.Rmd"}
``` 

```{r 21-discriminant-analysis-12,child="manova1a.Rmd"}
``` 
  
```{r 21-discriminant-analysis-13, child="jobs.Rmd"}
```

```{r 21-discriminant-analysis-14, child="adhd.Rmd"}
```

```{r 21-discriminant-analysis-15, child="cornseed.Rmd"}
``` 

```{r 21-discriminant-analysis-16, child="athletes-d.Rmd"}
``` 

<!--chapter:end:21-discriminant-analysis.Rmd-->

# Hierarchical cluster analysis

Packages for this chapter:

```{r 22-cluster-1, eval=F}
library(MASS)
library(ggbiplot)
library(tidyverse)
```

```{r 22-cluster-2, child="packages.Rmd"}
```


```{r 22-cluster-3, child="seabed_qq.Rmd"}
```


```{r 22-cluster-4,child="fruits_qq.Rmd"}
``` 

```{r 22-cluster-5,child="species_qq.Rmd"}
```


```{r 22-cluster-6, child="pittsburgh_qq.Rmd"}
``` 

My solutions follow:

```{r 22-cluster-7, child="seabed.Rmd"}
```


```{r 22-cluster-8,child="fruits.Rmd"}
``` 

```{r 22-cluster-9,child="species.Rmd"}
```


```{r 22-cluster-10, child="pittsburgh.Rmd"}
``` 


<!--chapter:end:22-cluster.Rmd-->

# K-means cluster analysis

Packages for this chapter:

```{r 39-kmeans-cluster-1, eval=F}
library(MASS)
library(ggbiplot)
library(tidyverse)
```

```{r 39-kmeans-cluster-2, child="packages.Rmd"}
```


```{r 39-kmeans-cluster-3, child="ais-km_qq.Rmd"}
```

```{r 39-kmeans-cluster-4, child="decathlon_qq.Rmd"}
``` 

```{r 39-kmeans-cluster-5, child="swiss-cluster_qq.Rmd"}
```


```{r 39-kmeans-cluster-6, child="carc_qq.Rmd"}
```

```{r 39-kmeans-cluster-7,child="beer_qq.Rmd"}
``` 

My solutions follow:

```{r 39-kmeans-cluster-8, child="ais-km.Rmd"}
```

```{r 39-kmeans-cluster-9, child="decathlon.Rmd"}
``` 

```{r 39-kmeans-cluster-10, child="swiss-cluster.Rmd"}
```


```{r 39-kmeans-cluster-11, child="carc.Rmd"}
```

```{r 39-kmeans-cluster-12,child="beer.Rmd"}
``` 

<!--chapter:end:39-kmeans-cluster.Rmd-->

# Drawing maps with Leaflet

Packages for this chapter:

```{r 41-maps-1, eval=F}
library(ggbiplot)
library(tidyverse)
library(ggrepel)
```

```{r 41-maps-2, child="packages.Rmd"}
```

```{r 41-maps-3, child="catbrain_qq.Rmd"}
```


```{r 41-maps-4, child="wisconsin2_qq.Rmd"}
``` 

```{r 41-maps-5, child="cross-city_qq.Rmd"}
```

My solutions follow:

```{r 41-maps-6, child="catbrain.Rmd"}
```


```{r 41-maps-7, child="wisconsin2.Rmd"}
``` 

```{r 41-maps-8, child="cross-city.Rmd"}
```

<!--chapter:end:41-maps.Rmd-->

# Multidimensional Scaling

Packages for this chapter:

```{r 23-mds-1, eval=F}
library(ggbiplot)
library(tidyverse)
library(ggrepel)
```

```{r 23-mds-2, child="packages.Rmd"}
```


```{r 23-mds-3, child="wisconsin_qq.Rmd"}
``` 


```{r 23-mds-4, child="stimuli_qq.Rmd"}
```
  
```{r 23-mds-5, child="letterrec_qq.Rmd"}
``` 


```{r 23-mds-6, child="beermds_qq.Rmd"}
```   

```{r 23-mds-7, child="stimuli2_qq.Rmd"}
```

My solutions follow:

```{r 23-mds-8, child="wisconsin.Rmd"}
``` 


```{r 23-mds-9, child="stimuli.Rmd"}
```
  
```{r 23-mds-10, child="letterrec.Rmd"}
``` 


```{r 23-mds-11, child="beermds.Rmd"}
```   

```{r 23-mds-12, child="stimuli2.Rmd"}
```


<!--chapter:end:23-mds.Rmd-->

# Principal Components

Packages for this chapter:

```{r 24-pc-1, eval=F}
library(ggbiplot)
library(tidyverse)
```

```{r 24-pc-2, child="packages.Rmd"}
```

```{r 24-pc-3, child="weather_2014_qq.Rmd"}
``` 


My solutions follow:

```{r 24-pc-4, child="weather_2014.Rmd"}
``` 


	


<!--chapter:end:24-pc.Rmd-->

# Factor Analysis

Packages for this chapter:

```{r 42-fa-1, eval=F}
library(ggbiplot)
library(tidyverse)
```

```{r 42-fa-2, child="packages.Rmd"}
```

```{r 42-fa-3, child="ipip_qq.Rmd"}
``` 

```{r 42-fa-4, child="corrmat_qq.Rmd"}
```   

```{r 42-fa-5, child="airpollution_qq.Rmd"}
```

My solutions follow:

```{r 42-fa-6, child="ipip.Rmd"}
``` 

```{r 42-fa-7, child="corrmat.Rmd"}
```   

```{r 42-fa-8, child="airpollution.Rmd"}
```



<!--chapter:end:42-fa.Rmd-->

# Frequency table analysis

Packages for this chapter:

```{r 25-loglin-1, eval=F}
library(tidyverse)
```
```{r 25-loglin-2, child="packages.Rmd"}
```

```{r 25-loglin-3, child="college-plans_qq.Rmd"}
```

```{r 25-loglin-4, child="vote_qq.Rmd"}
```

```{r 25-loglin-5, child="brand_m_qq.Rmd"}
```

My solutions follow:

```{r 25-loglin-6, child="college-plans.Rmd"}
```

```{r 25-loglin-7, child="vote.Rmd"}
```

```{r 25-loglin-8, child="brand_m.Rmd"}
```


<!--chapter:end:25-loglin.Rmd-->


---
title: "Problems and Solutions in Applied Statistics"
author: "Ken Butler"
date: "2019-01-07"
site: bookdown::bookdown_site
documentclass: book
bibliography: []
biblio-style: apalike
link-citations: yes
github-repo: nxskok/pasias
url: 'http://ritsokiguess.site/pasias'
description: "A set of problems and solutions, in R, on various parts of applied statistics"
output:
  pdf_document:
    toc: true
    toc_depth: 2
---

# Introduction


[This book](http://ritsokiguess.site/pasias/) contains a collection
of problems, and my solutions to them, in applied statistics with
R. These come from my courses STAC32, STAC33, and STAD29 at the University of
Toronto Scarborough. 

The problems were originally written in Sweave (that is, LaTeX with R
code chunks), using the `exam` document class, using data sets stolen
from numerous places (textbooks, websites etc).  I wrote [a Perl
program](https://raw.githubusercontent.com/nxskok/pasias/master/convert.pl)
to strip out the LaTeX and turn each problem into R Markdown for this
book. You will undoubtedly see bits of LaTeX still embedded in the
text. I am trying to update my program to catch them, but I am sure to
miss some. 

You will occasionally
see question parts beginning with a *; this means that other question
parts refer back to this one. (One of my favourite question strategies
is to ask how two different approaches lead to the same answer, or
more generally to demonstrate that there are different ways to see the
same thing.)

Thanks to Dann Sioson for spotting some errors and making some useful suggestions.

If *you* see anything, [file an
issue](https://github.com/nxskok/pasias/issues) on the Github page for
now. Likely
problems include:

- some LaTeX construction that I didn't catch (eg. block quotes)
- disappeared footnotes (that will show up as an apparently missing sentence in the text)
- references to "in class" or a lecture or a course by course number, which need to be eliminated (in favour of wording like "a previous course")
- references to other questions or question parts that are *wrong* (likely caused by *not* being "labels" or "refs" in the original LaTeX)
- my contorted English that is difficult to understand.

As I read through looking for problems like these, I realize that
there ought to be a textbook that reflects my way of doing
things. There isn't one (yet), though there are lecture
notes. Current versions of these are at:

- [the STAC32 website](http://ritsokiguess.site/STAC32/)
- [the STAC33 website](http://ritsokiguess.site/STAC33/)
- [the STAD29 website](http://ritsokiguess.site/STAD29/)

A little background:

STAC32 is an introduction to R as
applied to statistical methods that have (mostly) been learned in
previous courses. This course is designed for students who have a second non-mathematical applied statistics course 
such as
[this](https://utsc.calendar.utoronto.ca/course/stab27h3). The idea is
that students have already seen a little of regression and analysis of
variance (and the things that precede them), and need mainly an
introduction of how to run them in R.

STAC33 is an introduction to R, and applied statistics in general, for students who have a background in mathematical statistics. The way our courses are structured, these students have a strong mathematical background, but not very much experience in applications, which this course is designed to provide. The material covered is similar to STAC32, with a planned addition of some ideas in bootstrap and practical Bayesian statistics. There are some questions on these here.

STAD29 is an overview of a number of advanced statistical methods. I
start from regression and proceed to some regression-like methods
(logistic regression, survival analysis, log-linear frequency table
analysis), then I go a little further with analysis of variance and
proceed with MANOVA and repeated measures. I finish with a look at
classical multivariate methods such as discriminant analysis, cluster
analysis, principal components and factor analysis. I cover a number
of methods in no great depth; my aim is to convey an understanding of
what these methods are for, how to run them and how to interpret the
results. Statistics majors and specialists cannot take this course for
credit (they have separate courses covering this material with the
proper mathematical background). D29 is intended for students in other
disciplines who find themselves wanting to learn more statistics; we
have an [Applied Statistics Minor
program](https://utsc.calendar.utoronto.ca/minor-program-applied-statistics-science)
for which C32 and D29 are two of the last courses.

## Packages used somewhere in this book

The bottom lines are below used with the `conflicted` package: if a function by
the name shown is in two or more packages, prefer the one from the
package shown.

```{r, eval=F}
library(tidyverse)
library(smmr)
library(MASS)
library(nnet)
library(survival)
library(survminer)
library(car)
library(lme4)
library(ggbiplot)
library(ggrepel)
library(broom)
library(rpart)
library(bootstrap)
library(cmdstanr)
library(posterior)
library(bayesplot)
library(conflicted)
conflict_prefer("summarize", "dplyr")
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("mutate", "dplyr")
conflict_prefer("count", "dplyr")
conflict_prefer("arrange", "dplyr")
conflict_prefer("rename", "dplyr")
conflict_prefer("id", "dplyr")
```


<!--chapter:end:index.Rmd-->

# Logistic regression redux

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```



```{r, ethics, child="ethics.Rmd"}
```


<!--chapter:end:99-logistic-regression.Rmd-->


# Getting used to R and R Studio

We begin with this:

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```

and so to the problems:

```{r, child="r-signup.Rmd"}
```

```{r, child="r0.Rmd"}
```

```{r, child="r0a.Rmd"}
```

```{r different-ways, child="different-ways.Rmd"}
```

<!--chapter:end:01-getting-used.Rmd-->


# Reading in data

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r, child="oj.Rmd"}
```

```{r, child="soap.Rmd"}
```

```{r, child="global.Rmd"}
```



<!--chapter:end:02-reading-in.Rmd-->


# Drawing graphs

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r, child="oj2.Rmd"}
```

```{r, child="soap2.Rmd"}
```

```{r, child="global2.Rmd"}
```



<!--chapter:end:32-making-graphs.Rmd-->

# Data exploration

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r, child="ncbirths.Rmd"}
```

```{r, child="ncbirths-extra.Rmd"}
```

```{r, child="nenana.Rmd"}
```

```{r, child="compatt.Rmd"}
```

```{r, child="thomas.Rmd"}
```

<!--chapter:end:03-data-summaries.Rmd-->

## Working with dataframes

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```

```{r jays-dplyr, child="jays-dplyr.Rmd"}
```

```{r kencars,child="kencars.Rmd"}
```

<!--chapter:end:31-working-with-dataframes.Rmd-->

# One-sample inference

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```

```{r, child="hg.Rmd"}
```

```{r, child="boulder.Rmd"}
```

```{r, child="ncbirths-inf.Rmd"}
```

```{r, child="nenana-inf.Rmd"}
```


<!--chapter:end:04-one-sample-inference.Rmd-->

# Two-sample inference

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r devices-r, child="devices-r.Rmd"}
```

```{r parking, child="parking.Rmd"}
```

```{r bellpepper, child="bellpepper.Rmd"}
```

```{r mousebully, child="mousebully.Rmd"}
```

```{r kids-diet, child="kids-diet.Rmd"}
```

<!--chapter:end:05-two-sample-inference.Rmd-->

# Power and sample size

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r power-sim, child="power-sim.Rmd"}
```

```{r power20, child="power20.Rmd"}
```

```{r, proportion-power-sim, child="proportion-power-sim.Rmd"}
```


<!--chapter:end:06-power.Rmd-->

# The sign test and Mood's median test

```{r}
library(tidyverse)
library(smmr)
```

```{r, child="packages.Rmd"}
```


```{r maze, child="maze.Rmd"}
```

```{r cookies-r, child="cookies-r.Rmd"}
```

```{r signpower, child="signpower.Rmd"}
```

```{r cerealsugar, child="cerealsugar.Rmd"}
```

```{r mathphobia, child="mathphobia.Rmd"}
```

```{r forehead, child="forehead.Rmd"}
```

<!--chapter:end:07-sign-mood-median.Rmd-->

# Matched pairs t and sign test

```{r, eval=F}
library(tidyverse)
library(smmr)
```

```{r, child="packages.Rmd"}
```


```{r bodyfat, child="bodyfat.Rmd"}
```

```{r baseball-softball-r, child="baseball-softball-r.Rmd"}
```

```{r throw, child="throw.Rmd"}
```


```{r salaryinc, child="salaryinc.Rmd"}
```

```{r bodyfat-sign, child="bodyfat-sign.Rmd"}
```


<!--chapter:end:08-matched-pairs-sign.Rmd-->

# Normal quantile plots

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r heliconia, child="heliconia.Rmd"}
```

```{r aus-qq, child="aus-qq.Rmd"}
```

<!--chapter:end:09-normal-quantile.Rmd-->

# Analysis of variance

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r movies-r, child="movies-r.Rmd"}
```

```{r deer, child="deer.Rmd"}
```

```{r movies2, child="movies2.Rmd"}
```

```{r carbon, child="carbon.Rmd"}
```

```{r caffeine, child="caffeine.Rmd"}
```


<!--chapter:end:10-analysis-of-variance.Rmd-->

# Tidying data

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r throw-spaghetti, child="throw-spaghetti.Rmd"}
```

```{r ethanol, child="ethanol.Rmd"}
```

```{r tomatoes, child="tomatoes.Rmd"}
```

```{r migraine,child="migraine.Rmd"}
```

```{r plants,child="plants.Rmd"}
```

```{r crickets,child="crickets.Rmd"}
```



```{r billboard, child="billboard.Rmd"}
```

```{r bikes, child="bikes.Rmd"}
```

```{r heat-r, child="heat-r.Rmd"}
```

<!--chapter:end:11-tidying-data.Rmd-->

# Regression

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```

These problems are about simple regression (just one $x$-variable):



```{r calirain,child="calirain.Rmd"}
```

```{r ftccigar,child="ftccigar.Rmd"}
```


```{r boys, child="youngboys.Rmd"}
```



```{r fbfriends, child="fbfriends.Rmd"}
```

```{r carp, child="carp.Rmd"}
```

```{r sparrowhawk, child="sparrowhawk.Rmd"}
```


```{r socwork, child="socwork.Rmd"}
```

```{r pinetrees, child="pinetrees.Rmd"}
```

```{r tortoise, child="tortoise.Rmd"}
```

```{r crickets-b, child="crickets-b.Rmd"}
```

```{r coasters, child="coasters.Rmd"}
```

```{r diabetic, child="diabetic.Rmd"}
```

```{r pizza, child="pizza.Rmd"}
```

```{r fire_damage, child="fire_damage.Rmd"}
```

These problems are about multiple regression (more than one $x$-variable):


```{r hospital, child="hospital.Rmd"}
```

```{r chemical, child="chemical.Rmd"}
```

```{r mathsal, child="mathsal.Rmd"}
```

```{r gpa, child="gpa.Rmd"}
```

<!--chapter:end:12-regression.Rmd-->

# Dates and times

The usual to begin with:

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```

```{r whas, child="whas.Rmd"}
```

```{r mizuna-r, child="mizuna-r.Rmd"}
```

```{r birthtypes, child="birthtypes.Rmd"}
```

```{r denali, child="denali-r.Rmd"}
```

<!--chapter:end:13-dates-and-times.Rmd-->

# Functions

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r func, child="func.Rmd"}
```

```{r hotpo, child="hotpo.Rmd"}
```

<!--chapter:end:14-functions.Rmd-->

# The Bootstrap

Packages for this chapter:

```{r, eval=F}
library(tidyverse)
library(bootstrap)
```

```{r, child="packages.Rmd", warning=F}
```

```{r boot_one, child="bootstrap.Rmd"}
```

```{r boot_two, child="bootstrap_median.Rmd"}
```

<!--chapter:end:26-bootstrap.Rmd-->

# Bayesian Statistics with Stan

Packages for this chapter:

```{r eval = FALSE}
library(tidyverse)
library(cmdstanr)
library(posterior)
library(bayesplot)
```

```{r, child="packages.Rmd", warning=F}
```


```{r, child="binomial_stan.Rmd"}
```

```{r, child="regression_stan.Rmd"}
```

<!--chapter:end:27-stan.Rmd-->

# Logistic regression

```{r, eval=F}
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r, wolfspider,child="wolfspider.Rmd"}
```

```{r, aphids, child="aphids.Rmd"}
```

```{r, doseresponse, child="doseresponse.Rmd"}
```

```{r, parasite, child="parasite.Rmd"}
```

```{r, ethics, child="ethics.Rmd"}
```

```{r, heart,  child="heart.Rmd"}
```

```{r, breastfeed, child="breastfeed.Rmd"}
```

```{r, donner, child="donner.Rmd"}
```

```{r, apache, child="apache.Rmd"}
```

```{r, ha2, child="ha2.Rmd"}
```

<!--chapter:end:15-logistic-regression.Rmd-->

# Logistic regression with ordinal or nominal response

```{r, eval=F}
library(MASS)
library(nnet)
library(tidyverse)
```
```{r, child="packages.Rmd"}
```

```{r mobile, child="mobile.Rmd"}
```

```{r abortion, child="abortion.Rmd"}
```

```{r nonmissing, child="nonmissing.Rmd"}
```

```{r ess, child="ess.Rmd"}
```

```{r alligator, child="alligator.Rmd"}
```

```{r steak-data, child="steak-data.Rmd"}
```

```{r sfcrime-data, child="sfcrime-data.Rmd"}
```

```{r steak, child="steak.Rmd"}
```

```{r sfcrime, child="sfcrime.Rmd"}
```

```{r hsb, child="hsb.Rmd"}
```

```{r oz-multi, child="oz-multi.Rmd"}
```


<!--chapter:end:16-ordinal-nominal-response.Rmd-->

# Survival analysis

```{r, eval=F}
library(survival)
library(tidyverse)
library(survminer)
```

```{r, child="packages.Rmd"}
```

```{r worcester, child="worcester.Rmd"}
```

```{r drug-treatment, child="drug-treatment.Rmd"}
```

```{r myeloma, child="myeloma.Rmd"}
```

```{r ovarian, child="ovarian.Rmd"}
```


<!--chapter:end:17-survival-analysis.Rmd-->

# Analysis of variance revisited

Packages for this chapter:

```{r, eval=F}
library(MASS)
library(car)
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r acidrain, child="acidrain.Rmd"}
```

```{r hayfever, child="hayfever.Rmd"}
```

```{r q2,child="caffeine-contrast.Rmd"}
```

```{r studyhours, child="studyhours.Rmd"}
```

```{r q3,child="mental-context.Rmd"}
```

```{r shirts, child="shirts.Rmd"}
```


```{r productivity, child="productivity.Rmd"}
```

```{r lepro, child="leprosy.Rmd"} 
```





<!--chapter:end:18-anova-revisited.Rmd-->

# Multivariate analysis of variance

Packages for this chapter:

```{r, eval=F}
library(car)
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r q7,child="manova1.Rmd"}
``` 

```{r urine,child="urine.Rmd"}
```   

```{r athletes-manova, child="athletes-manova.Rmd"}
```


<!--chapter:end:19-manova.Rmd-->

# Repeated measures

Packages for this chapter:

```{r, eval=F}
library(car)
library(lme4)
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r ratweight, child="ratweight.Rmd"}
```


```{r oldies,child="geriatrics.Rmd"}
``` 

```{r airport, child="airport.Rmd"}
``` 

```{r bodyfat2, child="bodyfat2.Rmd"}
``` 

```{r king, child="king.Rmd"}
``` 

```{r rm, child="rm.Rmd"}
``` 

<!--chapter:end:20-repeated-measures.Rmd-->

# Discriminant analysis

Packages for this chapter:

```{r, eval=F}
library(ggbiplot)
library(MASS)
library(tidyverse)
library(car)
```

(Note: `ggbiplot` loads `plyr`, which overlaps a lot with `dplyr`
(`filter`, `select` etc.). We want the `dplyr` stuff elsewhere, so we
load `ggbiplot` *first*, and the things in `plyr` get hidden, as shown
in the Conflicts. This, despite appearances, is what we want.)

```{r, child="packages.Rmd"}
```


```{r sw1,child="swiss-money.Rmd"}
``` 

```{r ur2,child="urine2.Rmd"}
``` 

```{r man1a,child="manova1a.Rmd"}
``` 
  
```{r jobs, child="jobs.Rmd"}
```

```{r adhd, child="adhd.Rmd"}
```

```{r cornseed, child="cornseed.Rmd"}
``` 

```{r athletes-d, child="athletes-d.Rmd"}
``` 

<!--chapter:end:21-discriminant-analysis.Rmd-->

# Cluster analysis

Packages for this chapter:

```{r, eval=F}
library(MASS)
library(ggbiplot)
library(tidyverse)
```

```{r, child="packages.Rmd"}
```


```{r seabed, child="seabed.Rmd"}
```


```{r fruit,child="fruits.Rmd"}
``` 

```{r species,child="species.Rmd"}
```


```{r beer,child="beer.Rmd"}
``` 



```{r swiss-cluster, child="swiss-cluster.Rmd"}
```

```{r car-cluster, child="carc.Rmd"}
```

```{r decathlon, child="decathlon.Rmd"}
``` 

```{r pittsburgh, child="pittsburgh.Rmd"}
``` 

```{r athletes-km, child="ais-km.Rmd"}
```

<!--chapter:end:22-thingy.Rmd-->

# Multidimensional Scaling

Packages for this chapter:

```{r, eval=F}
library(ggbiplot)
library(tidyverse)
library(ggrepel)
```

```{r, child="packages.Rmd"}
```


```{r wisc, child="wisconsin.Rmd"}
``` 


```{r stimuli, child="stimuli.Rmd"}
```
  
```{r letters, child="letterrec.Rmd"}
``` 


```{r beermds, child="beermds.Rmd"}
```   

```{r stimuli, child="stimuli2.Rmd"}
```


<!--chapter:end:23-mds.Rmd-->

# Principal Components and Factor Analysis

Packages for this chapter:

```{r, eval=F}
library(ggbiplot)
library(tidyverse)
```

```{r, child="packages.Rmd"}
```

```{r weather, child="weather_2014.Rmd"}
``` 

```{r pollution, child="airpollution.Rmd"}
```

	
```{r corrmat, child="corrmat.Rmd"}
```   

```{r ipip, child="ipip.Rmd"}
``` 

<!--chapter:end:24-pcfa.Rmd-->

# Frequency table analysis

Packages for this chapter:

```{r, eval=F}
library(tidyverse)
```
```{r, child="packages.Rmd"}
```


```{r college, child="college-plans.Rmd"}
```

```{r vote, child="vote.Rmd"}
```

<!--chapter:end:25-loglin.Rmd-->


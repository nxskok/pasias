
```{r}
alcohol <- tribble(
  ~seat, ~`0`, ~`1`, ~`2`, ~`3`, ~`4`, ~`5`, ~`6`, ~`7`, ~`8`, ~`9`, ~`10`,
  "front", 45,  16,   10,    7,    5,    1,    1,    0,     1,    0,      0,    
  "middle", 50, 65,   32,   22,   20,   11,    7,    0,    0,    0,     0,
  "back",   10,  15,   6,    3,    1,    6,    15,    9,    8,    6,     0
)
alcohol
```

tidy

```{r}
alcohol %>% 
  pivot_longer(-seat, names_to = "drinks", values_to = "frequency") %>% 
  uncount(frequency) %>% 
  mutate(drinks=as.integer(drinks)) -> alc
```


```{r}
median_test(alc, drinks, seat)
```

```{r}
alc %>% summarise(med=median(drinks))
alc %>% group_by(seat) %>% summarise(med=median(drinks))
```

```{r}
with(alc, kruskal.test(drinks, seat))
```

```{r}
alc %>% mutate(rk=rank(drinks)) %>% 
  group_by(seat) %>% 
  summarize(mean_rank=mean(rk))
```

```{r}
pairwise_median_test(alc, drinks, seat)
```

